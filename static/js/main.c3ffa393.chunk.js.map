{"version":3,"sources":["webcam.js","VEControls.js","demo/em/EarthMoon3D.js","demo/go/sqMath.js","util-ui.js","demo/go/sqAnimation.js","demo/go/SQGeo.js","demo/go/sqMapProjections.js","Layers.js","DropArea.js","VideoEditor.js","BottomAppBar.js","LeftDrawer.js","App.js","serviceWorker.js","index.js"],"names":["Webcam","React","forwardRef","props","ref","console","log","rTitle","useRef","constraints","audio","echoCancellation","exact","video","width","height","facingMode","useEffect","navigator","mediaDevices","alert","videoStream","Object","asyncToGenerator","regenerator_default","a","mark","_callee","stream","videoTracks","wrap","_context","prev","next","getUserMedia","sent","getVideoTracks","current","textContent","label","onremovetrack","window","srcObject","pause","t0","name","error","stop","getTracks","forEach","tr","react_default","createElement","className","id","autoPlay","muted","playsInline","controls","onPlay","onPause","useStyles","makeStyles","theme","container","display","textField","button","marginTop","spacing","marginBottom","padding","avatar","marginRight","switch","slider","marginLeft","zIndex","close","ChromaKeyToolbox","dispatch","cls","_React$useState","useState","_React$useState2","slicedToArray","on","setOn","_React$useState3","_React$useState4","mode","setMode","_React$useState5","_React$useState6","snack","setSnack","dispatchNewMode","newMode","type","payload","handleSnackbarClose","ev","reason","Fragment","Tooltip","title","Switch","checked","onChange","target","value","inputProps","aria-label","IconButton","disabled","onClick","Colorize_default","Camera_default","Delete_default","InvertColorsOff_default","Slider","defaultValue","valueLabelDisplay","step","marks","min","max","newVal","ZoomIn_default","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","ContentProps","aria-describedby","message","action","key","color","Close_default","RandomAvatar","_React$useState7","_React$useState8","rUser","setRUser","generateRandomUser","Math","random","floor","Avatar","alt","src","VEControls","VEControls_RandomAvatar","TextField","margin","variant","fullWidth","multiline","rowsMax","VEControls_ChromaKeyToolbox","EarthMoon3D","rMount","rControls","rCamDir","_useState","_useState2","isAnimating","setAnimating","img","fn","frameId","mount","clientWidth","clientHeight","earthVec","THREE","scene","camera","position","z","light","add","set","loader","geometry","material","map","load","bumpMap","bumpScale","specularMap","specular","earthMesh","rotation","x","cloudsMesh","side","opacity","transparent","depthWrite","moonMesh","starsMesh","renderer","antialias","setClearColor","setSize","renderScene","render","handleResize","aspect","updateProjectionMatrix","animate","camDir","camPos","y","lookAt","requestAnimationFrame","start","cancelAnimationFrame","appendChild","domElement","addEventListener","removeEventListener","removeChild","remove","dispose","style","τ","PI","π","π_2","degrees","radians","abs","sin","cos","tan","sign","sqrt","pow","zero","v","epsilon","EventMove","others","objectWithoutProperties","_useState7","_useState8","mousedown","setMouseDown","_useState9","_useState10","mouse","setMouse","_moveStart","p","touches","pageX","pageY","clientX","clientY","_move","_moveEnd","assign","onMouseUp","onMouseMove","onMouseDown","onTouchStart","preventDefault","stopPropagation","onTouchMove","nativeEvent","stopImmediatePropagation","onTouchEnd","children","useAnimationFrame","callback","delay","savedCallback","lastTs","tick","ts","useAnimationTimer","duration","arguments","length","undefined","elapsed","setTime","animationFrame","timerStop","onFrame","Date","now","loop","timerDelay","setTimeout","clearTimeout","pjt","sqMapProjections","_this","this","classCallCheck","projection","pt","equirectangular","get_culling","cull","set_culling","get_num_projections","pjt_list","normalize_pt","lg","ctr","lgM","is_orthographic","orthographic","get_orthographic_radius","get_range","get_border","get_projection_object","find","el","set_tween","projection_last","prj","mercator","tween_pjt","end_tween","set_projection","obj","get_projection_name","set_location","lt","pjt1","pjt2","p1","p2","lerp_p","i","frac","interpolate_frac","r2","_this$normalize_pt","_this$normalize_pt2","φ","equal_earth","_this$normalize_pt3","_this$normalize_pt4","θ","asin","θ_2","θ_6","nicolosi_globular","_this$normalize_pt5","_this$normalize_pt6","λ","π_2λ","sinφ","cosφ","b","c","d","sgnλ","b2","d2","b2_d2a1","d2_b2a1","M","N","n","kavrayskiy_VII","_this$normalize_pt7","_this$normalize_pt8","_this$normalize_pt9","_this$normalize_pt10","Δλ","φ0","cosφ0","sinφ0","cosΔλ","bbox2viewBox","bbox","vF","toFixed","concat","svg_line","s","Number","isInteger","parseFloat","dx","dy","Topo2svg","mp","bCountries","other","scale","transform","tranz","translate","keyName","color_num","fColor","lns","k","stitch_arcs","l","bClosed","n_pts","d_p","p_last","ac_id","bRemoveLast","bReverse","pts","arc","pos","slice","decode_arc","arcs","reverse","splice","arc2pts","line_string2path","ls","push","fill","polygon2path","pg","lr","geometry2svg","geometries","gm","hasOwnProperty","objects","MapBorder","cx","cy","r","B","move_pt","sgn","svg_latitude","x1","x2","Graticule","y_offset","Tropics","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","lat","Symbol","iterator","done","err","return","SvgMain","viewBox","world","in","stdDeviation","result","slope","colorInterpolationFilters","filter","SQGeo_MapBorder","SQGeo_Graticule","SQGeo_Topo2svg","strokeWidth","SQGeo_Tropics","GeoAniDemo","aniFrac","easingName","easing","linear","t","quadratic","cubic","elastic","inQuad","outQuad","inOutQuad","inCubic","outCubic","inOutCubic","inExpo","outExpo","useAnimation","SQGeo_SvgMain","GeoTest","count","setCount","_useState3","_useState4","toggleCountries","_useState5","_useState6","bCull","toggleCull","bAni","toggleAni","setHeight","_useState11","_useState12","loc","setLoc","_useState13","_useState14","setTranz","normalize","util_ui_EventMove","onDoubleClick","trunc","handleDoubleClick","SQGeo_GeoAniDemo","EmbedYouTube","vID","frameBorder","allow","allowFullScreen","Layers","appId","SQGeo_GeoTest","EarthMoon3D_EarthMoon3D","lZ","toString","DropArea","state","setState","refDA","rFilelist","evName","document","body","dragDropCommon","entering","classList","toggle","handleDragStart","file","dataTransfer","dropEffect","setData","JSON","stringify","handleDropFileInfo","fInfo","onDropFileInfo","RenderUpdates","onDrop","toConsumableArray","updateFilelist","fl","redundantFilename","size","url","URL","createObjectURL","RenderImg","draggable","onDragStart","RenderVideo","data-title","onLoadedMetadata","tg","ds","parentElement","dataset","sec","hstr","h","m","sec2hms","videoWidth","videoHeight","HandleFile","startsWith","onDragEnter","onDragOver","onDragLeave","dt","countAdded","_loop","it","items","kind","match","getAsString","parse","getData","html","uri","includes","replace","split","getAsFile","onDragEnd","form","multiple","accept","files","handleFiles","htmlFor","noUi","help","role","list","DropArea_ListViewFiles","filelist","ListViewFiles","fold","setFold","f","href","rel","sz","VE_SZ","rgb","g","VideoEditor","rCvs","refVid","initState","cKMode","cKA","cKFrame","cKThr","fps","curUrl","curApp","curtube","rTxt","newState","hasCK","switchVideoInput","getElementById","isChromaColor","objectSpread","reducer","isRunning","paused","colorDist","cK","rm","clr","data","j","cvs","ctx","getContext","drawImage","frame","getImageData","putImageData","vEl","play","msg","setInterval","clearInterval","Layers_Layers","backgroundImage","curTube","Layers_EmbedYouTube","DropArea_DropArea","CKMode","offsetLeft","offsetTop","VEControls_VEControls","len","n_lines","RGBstr","CKColor","_ref","text","subheader","backgroundColor","palette","background","paper","appBar","top","bottom","grow","flexGrow","fabButton","FabToggleVideocam","classes","setVideo","handleVideocam","onVideo","Fab","VideocamOff_default","Videocam_default","BottomAppBar","CssBaseline","AppBar","Toolbar","edge","onStart","Menu_default","BottomAppBar_FabToggleVideocam","VolumeMute_default","PlayArrow_default","Search_default","MoreVert_default","fullList","LeftDrawer","show","dlgTitle","setDlgTitle","toggleDrawer","event","handleClick","innerText","LeftDrawer_MsgDialog","SwipeableDrawer","onOpen","onKeyDown","List","index","ListItem","ListItemIcon","MoveToInbox_default","Mail_default","ListItemText","primary","Divider","MsgDialog","Dialog","aria-labelledby","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","autoFocus","root","canvas","layers","appsList","fab","extendedIcon","appSlider","paddingBottom","gridList","icon","LayersHeader","Layers_default","Add_default","getElementsByClassName","AppsList","tileData","sub","GridList","cellHeight","GridListTile","cols","setAttribute","tile","GridListTileBar","subtitle","actionIcon","Info_default","App","refCam","refCvs","refLD","createRef","Grid","item","xs","Paper","clsx","App_LayersHeader","App_AppsList","border","minHeight","cam","handleVideo","click","Boolean","location","hostname","ReactDOM","src_App","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.c3ffa393.chunk.js","sourcesContent":["import React, { useRef, useEffect } from 'react';\n// https://webrtc.github.io/adapter/adapter-latest.js\nimport 'webrtc-adapter'; // include adapter for srcObject shim\nimport './App.scss';\n\nexport const Webcam = React.forwardRef((props, ref) => {\n  console.log(\"Webcam::render\");\n  const rTitle = useRef(null);\n  const constraints = {\n    audio: { echoCancellation: {exact: false} },\n    video: { width: 1280, height: 720, facingMode: 'user' } // 'user' or 'environment'\n  };\n\n  useEffect(() => {\n    if (!('mediaDevices' in navigator &&\n          'getUserMedia' in navigator.mediaDevices)) {\n      alert(\"mediaDevices not supported!\");\n    }\n    let videoStream = null;\n    (async function() {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        const videoTracks = stream.getVideoTracks();\n        rTitle.current.textContent = videoTracks[0].label;\n        console.log('Using video device: ' + videoTracks[0].label); // FaceTime HD Camera (Built-in)\n        stream.onremovetrack = function() {\n          console.log('Stream ended');\n        }\n        window.stream         = stream;\n        ref.current.srcObject = stream;\n        videoStream           = stream;\n        ref.current.pause();  // pause at the start\n      } catch (e) {\n        console.log(e.name);\n        if (typeof e !== 'undefined')\n          console.error(e);\n      }\n    })();\n\n    return () => {  // unsure this part is needed ... \n      if (videoStream) {\n        const tracks = videoStream.getTracks();\n        tracks.forEach(tr => tr.stop());\n        videoStream = null;\n      }\n    }\n  }, [ref, constraints])  // when constraints change, video should be reset\n  // <video ref={ref} autoPlay muted playsInline controls onPlay={()=>handlePlay()} className=\"vid-fw\" />\n  // <video onPlay> can be used as the trigger of the streaming: How can I pass this event to <VideoEditor>?\n  return (\n    <div className=\"vid-cont\">\n      <video ref={ref} id=\"v-cam\"\n        autoPlay muted playsInline controls\n        onPlay={props.onPlay && props.onPlay}\n        onPause={props.onPause && props.onPause}\n        />\n      <br/>\n      <label ref={rTitle}></label>\n    </div>\n  );\n});\n","import React from 'react';\n\nimport { makeStyles }  from '@material-ui/core/styles';\nimport TextField       from '@material-ui/core/TextField';\nimport IconButton      from '@material-ui/core/IconButton';\nimport CKClearIcon     from '@material-ui/icons/Delete';\nimport ZoomInIcon      from '@material-ui/icons/ZoomIn';\nimport CKPickIcon      from '@material-ui/icons/Colorize';\nimport CKDropIcon      from '@material-ui/icons/InvertColorsOff';\nimport CKShotIcon      from '@material-ui/icons/Camera';\nimport Avatar          from '@material-ui/core/Avatar';\nimport Tooltip         from '@material-ui/core/Tooltip';\nimport Switch          from '@material-ui/core/Switch';\nimport Slider          from '@material-ui/core/Slider';\nimport Snackbar        from '@material-ui/core/Snackbar';\nimport CloseIcon       from '@material-ui/icons/Close';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n  },\n  textField: {\n    //marginTop: theme.spacing(2),\n    //marginLeft : theme.spacing(1),\n    //marginRight: theme.spacing(1),\n  },\n  button: {\n    height: 40,\n    marginTop    : theme.spacing(1),\n    marginBottom : theme.spacing(1),\n    padding      : theme.spacing(1),\n  },\n  avatar: {\n    marginTop   : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n    marginRight : theme.spacing(1),\n  },\n  switch: {\n    marginTop   : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  slider: {\n    width: 200,\n    marginTop   : theme.spacing(2),\n    marginLeft  : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n    zIndex      : 100000,\n  },\n  close: {\n    padding: theme.spacing(.5),\n  },\n}));\n\nconst ChromaKeyToolbox = props => {\n  console.log(\"ChromaKeyToolbox::render\");\n  const { dispatch } = props;\n  const cls = useStyles();\n  const [on,    setOn]    = React.useState(true);  // switch on\n  const [mode,  setMode]  = React.useState(1);     // 1: Pick Color 2: Snapshot\n  const [snack, setSnack] = React.useState(null);  // Snackbar message\n\n  const dispatchNewMode = newMode => {\n    dispatch({type: 'setCKMode', payload: newMode});\n  }\n  const handleSwitch   = ev => {\n    setOn(ev.target.checked);\n    dispatchNewMode(ev.target.checked ? mode : 0);\n  }\n  const handlePickMode = () => {\n    const newMode = mode === 1 ? 2 : 1;\n    if (newMode === 2) {\n      setSnack(\"Click Work Area to capture the frame\");\n    }\n    setMode(newMode);\n    dispatchNewMode(newMode);\n  }\n  const handleCKClear  = () => { setSnack(\"Chroma Keys cleared\");      dispatch({type: 'clearCK'}); }\n  const handleCKDrop   = () => { setSnack(\"Removed last Chroma Key\");  dispatch({type: 'dropCK'}); }\n  const handleCKThr    = (ev, newVal) => { dispatch({type: 'setCKThr', payload: newVal}); }\n  const handleZoomIn   = () => { setSnack(\"Under construction\"); }\n  const handleSnackbarClose = (ev, reason) => setSnack(null);\n\n  return (\n    <>\n    <Tooltip title=\"Chroma Key On/Off\">\n      <Switch\n        checked={on}\n        onChange={handleSwitch}\n        className={cls.switch}\n        value=\"switchCK\"\n        inputProps={{ 'aria-label': 'secondary checkbox' }}\n      />\n    </Tooltip>\n    <Tooltip title=\"Pick Color / Snapshot\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Toggle Pick Mode\"\n        onClick={handlePickMode}\n      >\n        {mode === 1 ?\n          <CKPickIcon /> : \n          <CKShotIcon />}\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Clear Chroma Keys\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Clear\" onClick={handleCKClear}>\n        <CKClearIcon />\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Undo Chroma Key\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Color Off\"\n        onClick={handleCKDrop}>\n        <CKDropIcon />\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Color Distance Threshold\">\n      <Slider\n        className={cls.slider}\n        disabled={!on}\n        defaultValue={70}\n        valueLabelDisplay=\"auto\"\n        step={10}\n        marks\n        min={10}\n        max={150}\n        onChange={handleCKThr}\n      />\n    </Tooltip>\n    <Tooltip title=\"Zoom In\">\n      <IconButton\n        className={cls.button}\n        aria-label=\"ZoomIn\"\n        onClick={handleZoomIn}>\n        <ZoomInIcon />\n      </IconButton>\n    </Tooltip>\n    <Snackbar\n      className={cls.snack}\n      anchorOrigin={{vertical: 'bottom', horizontal: 'right'}}\n      open={snack !== null}\n      autoHideDuration={5000}\n      onClose={handleSnackbarClose}\n      ContentProps={{'aria-describedby': 'msg-id'}}\n      message={<span id=\"msg-id\">{snack}</span>}\n      action={[<IconButton\n        key=\"close\"\n        aria-label=\"Close\"\n        color=\"inherit\"\n        className={cls.close}\n        onClick={handleSnackbarClose}\n        >\n          <CloseIcon />\n        </IconButton>\n      ]}\n    />\n    </>\n  );\n}\n\nconst RandomAvatar = props => {\n  console.log(\"RandomAvatar::render\");\n  const cls = useStyles();\n  const [rUser, setRUser] = React.useState(null);\n  // document.getElementById(\"outlined-text-input\").value = '';  // to clear TextField\n\n  const generateRandomUser = () => \"https://randomuser.me/api/portraits/\" +\n              (Math.random() <= .5 ? 'wo' : '') + 'men/' + \n               Math.floor( Math.random() * Math.floor(99) ) + \".jpg\";\n\n  React.useEffect(() => {  // so that the random user avatar does not change for each render\n    setRUser(generateRandomUser());\n  }, []);\n\n  const handleClick = () => {\n    props.onClick && props.onClick();\n    setRUser(generateRandomUser());\n  }\n\n  return (\n    <Tooltip title=\"Webcam On\">\n      <Avatar\n        alt=\"avatar\"\n        src={rUser}\n        className={cls.avatar}\n        onClick={()=>handleClick()}\n      />\n    </Tooltip>\n  );\n}\n\nexport const VEControls = props => {\n  console.log(\"VEControls::render\");\n  const { dispatch } = props;\n  const cls = useStyles();\n\n  const handleAvatarClick = () => {\n    console.log(\"handleAvatarClick\");\n    dispatch({type: 'setCam'});\n  }\n\n  return (\n    <div className={cls.container}>\n      <RandomAvatar onClick={handleAvatarClick} />\n      <TextField\n        id=\"outlined-text-input\"\n        label=\"Type in Text\"\n        className={cls.textField}\n        margin=\"dense\"\n        variant=\"outlined\"\n        fullWidth\n        multiline\n        rowsMax=\"4\"\n        onChange={props.onChange}\n      />\n      <ChromaKeyToolbox dispatch={dispatch} />\n    </div>\n  );\n}\n","// requirement: yarn add three (^0.101.1)\n// copy resources from ../public/img/\nimport React, {useRef, useEffect, useState} from 'react';\nimport * as THREE from 'three';\n\nexport const EarthMoon3D = props => {\n  const rMount    = useRef(null);  // THREE mount <div>\n  const rControls = useRef(null);  // to save animation start/stop function\n  const rCamDir   = useRef(1);     // to save camera direction\n  const [isAnimating, setAnimating] = useState(true);\n  const img = fn => 'img/demo/em/' + fn;\n\n  const init_camera_z = 1.15;\n\n  useEffect(() => { // componentDidMount()\n    let mount  = rMount.current;\n    let width  = mount.clientWidth;\n    let height = mount.clientHeight;\n    let frameId;\n    const earthVec  = new THREE.Vector3(-.5,.2,0);\n\n    const scene     = new THREE.Scene();\n    const camera    = new THREE.PerspectiveCamera(40, width/height, .01, 1000);\n    camera.position.z = init_camera_z;\n\n    let   light     = new THREE.AmbientLight(0x888888);\n    scene.add(light);\n\n    light = new THREE.DirectionalLight(0xffffff, .4);\n    light.position.set(5,5,5);\n    scene.add(light);\n    /*\n    light.castShadow = true;\n    light.shadowCameraNear = .01;\n    light.shadowCameraFar  = 15;\n    light.shadowCameraFov  = 45;\n    light.shadowMapWidth  = 1024;\n    light.shadowMapHeight = 1024;\n*/\n    const loader    = new THREE.TextureLoader();\n    const geometry  = new THREE.SphereBufferGeometry(.5, 32, 32);\n    const material  = new THREE.MeshPhongMaterial({\n        map         : loader.load(img('earthmap1k.jpg')),\n        bumpMap     : loader.load(img('earthbump1k.jpg')),\n        bumpScale   : .05,\n        specularMap : loader.load(img('earthspec1k.jpg')),\n        specular    : new THREE.Color('grey')\n      });\n    const earthMesh = new THREE.Mesh(geometry, material);\n    earthMesh.rotation.x += .4;\n    scene.add(earthMesh);\n\n    const cloudsMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(.5 + .008, 32, 32),\n      new THREE.MeshPhongMaterial({\n        map         : loader.load(img('fair_clouds_4k.png')),\n        side        : THREE.DoubleSide,\n        opacity     : .8,\n        transparent : true,\n        depthWrite  : false\n      })\n    );\n    scene.add(cloudsMesh);\n    cloudsMesh.rotation.x += .6;\n\n    const moonMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(.08, 16, 16),\n      new THREE.MeshPhongMaterial({\n        map       : loader.load(img('moonmap1k.jpg')),\n        bumpMap   : loader.load(img('moonbump1k.jpg')),\n        bumpScale : .01\n      })\n    );\n    //moonMesh.position.set(.25, .8, 2);\n    moonMesh.position.set(0, .12, 1.1);\n    scene.add(moonMesh);\n    \n    const starsMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(90, 32, 32),\n      new THREE.MeshBasicMaterial({\n        map  : loader.load(img('galaxy_starfield.png')),\n        side : THREE.BackSide\n      })\n    );\n    scene.add(starsMesh);\n\n    const renderer  = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setClearColor('#000000');\n    renderer.setSize(width, height);\n\n    const renderScene = () => {\n      renderer.render(scene, camera);\n    }\n\n    const handleResize = () => {\n      width  = mount.clientWidth;\n      height = mount.clientHeight;\n      renderer.setSize(width, height);\n      camera.aspect = width / height;\n      camera.updateProjectionMatrix();\n      renderScene();\n    }\n\n    const animate = () => {\n      const changeCamDirection = () => rCamDir.current *= -1;\n      const camDir = rCamDir.current;\n      let camPos = camera.position;\n//      earthMesh.rotation.x += .002;\n      earthMesh.rotation.y  += .002;\n      cloudsMesh.rotation.y += .0025;\n      moonMesh.rotation.y   += .001;\n      camPos.x += .0005*camDir;\n      camPos.y += .0001*camDir;\n      camPos.z += .0001*camDir;\n      if (camPos.z > 1.45 ||\n          camPos.z < init_camera_z) {\n        changeCamDirection();\n        //camera.position.set(0,0,init_camera_z);\n      }\n\n      camera.lookAt(earthVec);\n\n      renderScene();\n      frameId = window.requestAnimationFrame(animate);\n    }\n\n    const start = () => {\n      if (!frameId) {\n        frameId = requestAnimationFrame(animate);\n      }\n    }\n\n    const stop = () => {\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    mount.appendChild(renderer.domElement);\n    window.addEventListener('resize', handleResize);\n    start();\n\n    rControls.current = { start, stop };\n\n    return () => { // componetWillUnmount()\n      stop();\n      window.removeEventListener('resize', handleResize);\n      mount.removeChild(renderer.domElement);\n\n      scene.remove(earthMesh);\n      geometry.dispose();\n      material.dispose();\n    }\n  }, []);  // With the second parameter, the useEffect will run only once.\n\n  useEffect(() => {\n    if (isAnimating) { rControls.current.start(); }\n    else             { rControls.current.stop();  }\n  }, [isAnimating]);\n\n  return <div ref={rMount}\n              style={{width: props.width, height: props.height, margin: 'auto'}}\n              onClick={() => setAnimating(!isAnimating)} />\n}\n","// Math definitions: Just for readability\n// https://github.com/d3/d3-geo/blob/master/src/math.js\n\n// consider degeneracy and robustness\n\nexport const τ    = Math.PI*2;\nexport const π    = Math.PI;\nexport const π_2  = Math.PI/2;\nexport const π_4  = Math.PI/4;\nexport const ε    = 1e-6;      // a small threshold value for the floating point computation\nexport const ε2   = 1e-12;\n\nexport const degrees = 180 / π;\nexport const radians = π / 180;\nexport const π_2xdegrees = 90;  // π/2 x degrees\nexport const abs   = Math.abs;\nexport const sin   = Math.sin;\nexport const cos   = Math.cos;\nexport const tan   = Math.tan;\nexport const sign  = Math.sign;\nexport const sqrt  = Math.sqrt;\nexport const pow   = Math.pow;\nexport const log   = Math.log;\n\nexport const min   = Math.min;\nexport const max   = Math.max;\n\nexport const zero    = v => abs(v) < ε;        // is virtually zero?\nexport const epsilon = v => zero(v) ? 0 : v;   // reduce an infinitesimal number to zero\n\n// to avoid NaN for the invalid domain ranges\nexport const asin = x => x > 1 ? π/2 : x < -1  ? -π/2 : Math.asin(x);\nexport const acos = x => x > 1 ? 0   : x < -1  ? π    : Math.acos(x);\n\nexport const haversin = x => (x = sin(x/2))*x;\nexport const range = (x, r1, r2) => min(max(x, r1), r2);  // let r1 ≦ x ≦ r2\n","// util-ui.js\nimport React, { useState, useEffect, useRef } from 'react';\n\nexport const copyright = (title) => {\n// ASCII ART: http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20\n  console.log(\"╔═╗┌─┐┌─┐┌─┐┌─┐┌┬┐┬┌┬┐┌─┐╔═╗  \" + title + \" - contact: dev.spacetimeq@gmail.com\");\n  console.log(\"╚═╗├─┘├─┤│  ├┤  │ ││││├┤ ║═╬╗\", Date());\n  console.log(\"╚═╝┴  ┴ ┴└─┘└─┘ ┴ ┴┴ ┴└─┘╚═╝╚ (C)2019 SpacetimeQ Inc, CA 94583\");\n};\n\n// reacts only to the width change\nexport const useWindowWidth = () => {\n  const RESIZE = 'resize';\n  const [winWidth, setWinWidth] = useState(window.innerWidth);\n  const handleWindowResize = () => setWinWidth(window.innerWidth);\n\n  useEffect(() => {\n    window.addEventListener(RESIZE, handleWindowResize);\n    return () => window.removeEventListener(RESIZE, handleWindowResize);\n  }, []);\n\n  return winWidth;\n}\n\n// reacts to both width and height changes\n// aspect ration = w / h; Portrait (asp <= 1) Landscape (asp > 1)\nexport const useWindowSize = () => {\n  const RESIZE = 'resize';\n  const getWs = () => ({\n    w: window.innerWidth,\n    h: window.innerHeight\n  });\n  const [winSize, setWinSize] = useState(getWs());\n  const handleWindowResize = () => setWinSize(getWs());\n\n  useEffect(() => {\n    window.addEventListener(RESIZE, handleWindowResize);\n    return () => window.removeEventListener(RESIZE, handleWindowResize);\n    // eslint-disable-next-line\n  }, []);\n\n  return winSize;\n}\n/*\n// Usage\nfunction App() {\n  // Call our hook for each key that we'd like to monitor\n  const happyPress = useKeyPress('h');\n  const sadPress = useKeyPress('s');\n  const robotPress = useKeyPress('r');\n  const foxPress = useKeyPress('f');\n\n  return (\n    <div>\n      <div>h, s, r, f</div>\n      <div>\n        {happyPress && '😊'}\n        {sadPress && '😢'}\n        {robotPress && '🤖'}\n        {foxPress && '🦊'}\n      </div>\n    </div>\n  );\n}\n*/\n\n// Hook\n// left, up, right, down = 37, 38, 39, 40\nexport function useKeyPress(targetKey) {\n  // State for keeping track of whether key is pressed\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  // If pressed key is our target key then set to true\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  // If released key is our target key then set to false\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  // Add event listeners\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // Empty array ensures that effect is only run on mount and unmount\n\n  return keyPressed;\n}\n\n// Mouse / TrackPad Event Handlers Wrapper\n// props.render should be provided, that handles changed x, y position\nexport const EventMove = props => {\n  const { render, ...others } = props;\n  const [mousedown,  setMouseDown] = useState(false);\n  const [mouse,      setMouse]     = useState({x: 0, y: 0});\n\n  const _moveStart = ev => {\n    const p = (ev.type === 'touchstart') ?\n      {x: ev.touches[0].pageX,\n       y: ev.touches[0].pageY} :\n      {x: ev.clientX,\n       y: ev.clientY};\n    setMouseDown(true);\n    setMouse(p);\n  }\n\n  const _move = ev => {\n    if (mousedown) {\n      const p = (ev.type === 'touchmove') ?\n        {x: ev.touches[0].pageX,\n         y: ev.touches[0].pageY} :\n        {x: ev.clientX,\n         y: ev.clientY};\n      props.render(p.x - mouse.x, p.y - mouse.y);  // Render Props\n      setMouse(p);\n    }\n  }\n\n  const _moveEnd = () => { setMouseDown(false); }\n    \n  const handleMouseDown = ev => { _moveStart(ev); }\n  const handleMouseMove = ev => { _move(ev); }\n  const handleMouseUp   = ev => { _moveEnd(); }\n\n  const handleTouchStart = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    _moveStart(ev);\n  }\n\n  const handleTouchMove = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();  // seems not working\n    ev.nativeEvent.stopImmediatePropagation();\n    _move(ev);\n  }\n  const handleTouchEnd = () => {\n    _moveEnd();\n  }\n\n  return (\n    <div\n      onMouseUp    = {handleMouseUp}\n      onMouseMove  = {handleMouseMove}\n      onMouseDown  = {handleMouseDown}\n      onTouchStart = {handleTouchStart}\n      onTouchMove  = {handleTouchMove}\n      onTouchEnd   = {handleTouchEnd}\n      {...others}\n    >\n      {props.children}\n    </div>\n  );\n}\n\n// https://overreacted.io/making-setinterval-declarative-with-react-hooks/\nexport function useInterval(callback, delay) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\n// 05/10/2019 by Soomin\n// Idle time CPU usage: 2% WTH?\nexport function useAnimationFrame(callback, delay) {\n  const savedCallback = useRef();\n  // const [lastTs, setLastTs] = useState(0);  // lastTs remained 0 in the tick loop even though setLastTs(ts) called.\n  const lastTs = useRef(0);  // returned object will persist for the full lifetime of the component\n\n  // Remember the latest callback\n  useEffect(() => {\n    //console.log(callback);\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval\n  useEffect(() => {\n    let frameId;\n\n    const tick = ts => {  // loop called repeatedly by rAF\n      if (ts - lastTs.current >= delay) {\n        //console.log(ts, lastTs.current, ts - lastTs.current);\n        lastTs.current = ts;\n        savedCallback.current();\n      }\n      frameId = requestAnimationFrame(tick);\n    }\n    tick(0);  // called once at the start\n    return () => cancelAnimationFrame(frameId);\n  }, [delay]);\n}\n","import { useState, useEffect } from 'react';\n//\n// https://usehooks.com\nexport const useAnimation = (easingName='linear', duration=500, delay=0) => {\n  // Some easing functions copied from:\n  // https://github.com/streamich/ts-easing/blob/master/src/index.ts\n  // Hardcode here or pull in a dependency\n  const easing = {\n    linear     : t => t,\n    quadratic  : t => t * (((-t + 4) * t - 6) * t + 4),\n    cubic      : t => t * ((4 * t - 9) * t + 6),\n    elastic    : t => t * ((((33 * t - 106) * t + 126) * t - 67) * t + 15),\n    inQuad     : t => t * t,\n    outQuad    : t => t * (2 - t),\n    inOutQuad  : t => t <.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n    inCubic    : t => t * t * t,\n    outCubic   : t => (--t) * t * t + 1,\n    inOutCubic : t => t <.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n    inExpo     : t => 2 ** (10*(t-1)),\n    outExpo    : t => -(2 ** (-10*t)) + 1,\n  };\n  // The useAnimationTimer hook calls useState every animation frame ...\n  // ... giving us elapased time and causing a rerender as frequently ...\n  // ... as possible for a smooth animation.\n  const elapsed = useAnimationTimer(duration, delay);\n  // Amount of specified duration elapsed on a scale from 0~1\n  const n = Math.min(1, elapsed/duration);\n  // Return altered value based on our specified easing function\n  return easing[easingName](n);  // property accessors\n}\n\nconst useAnimationTimer = (duration=1000, delay=0) => {\n  const [elapsed, setTime] = useState(0);\n\n  useEffect(() => {\n    let animationFrame, timerStop, start;\n\n    // Function to be executed on each animation frame\n    const onFrame = () => {\n      setTime(Date.now() - start);\n      loop();\n    }\n\n    // Call onFrame() on next animation frame\n    const loop = () => {\n      animationFrame = requestAnimationFrame(onFrame);\n    }\n\n    const onStart = () => {\n      // Set a timeout to stop things when duration time elapses\n      timerStop = setTimeout(() => {\n        cancelAnimationFrame(animationFrame);\n        setTime(Date.now() - start);\n      }, duration);\n\n      // Start the loop\n      start = Date.now();\n      loop();\n    }\n\n    // Start after specified delay (defaults to 0)\n    const timerDelay = setTimeout(onStart, delay);\n\n    // Clean things up\n    return () => {\n      clearTimeout(timerStop);\n      clearTimeout(timerDelay);\n      cancelAnimationFrame(animationFrame);\n    };\n  }, [duration, delay]);  // Only re-run effect if duration or delay changes\n\n  return elapsed;\n}\n","import React, { useState }   from 'react';\nimport sqMapProjections      from './sqMapProjections';\nimport { zero }              from './sqMath';\nimport { EventMove,\n         useAnimationFrame } from '../../util-ui';\nimport { useAnimation }      from './sqAnimation';\nimport world                 from './map/110mS2.json';  // 110m.json, 50m.json\n//import timez    from './map/tz.topo.json';\nimport './SQGeo.scss';\n\n//const pt2λφ = (pt) => [radians * pt[0], radians * pt[1]];\n\n/*\nconst rotate_π = (p) => {\n  let p2 = p - 160;\n  if (p2 < -180)\n    p2 += 360;\n  return p2;\n}\n*/\n\nconst pjt = new sqMapProjections();\n\nconst map_size = bbox => bbox ?\n  Math.min(bbox[2] - bbox[0],\n           bbox[3] - bbox[1]) : 360;\n//const get_bbox = bbox => bbox ? bbox : [-180, -90, 180, 90];\n\nconst bbox2viewBox = bbox => {\n  if (!bbox)\n    return '-180 -90 360 180';\n  const vF = v => v.toFixed(2);\n  return `${vF(bbox[0])} ${vF(bbox[1])} ${vF(bbox[2] - bbox[0])} ${vF(bbox[3] - bbox[1])}`;\n}\n\n// Compact svg generator that checks if horizontal or vertical lines and uses relative coordinates\n// returns '' when no change in positions\nconst svg_line = (p1, p2) => {\n  const s = v => Number.isInteger(v) ? v : Number.parseFloat(v.toFixed(3));  // short number\n  if (p1 === null)\n    return 'M' + s(p2[0]) + ',' + s(p2[1]);  // starting point\n  const dx = p2[0] - p1[0];\n  const dy = p2[1] - p1[1];\n  if (zero(dx))  return (zero(dy)) ? '' : 'v' + s(dy);\n  if (zero(dy))  return (zero(dx)) ? '' : 'h' + s(dx);\n  return 'l' + s(dx) + ',' + s(dy);  // delta encode\n}\n\nconst Topo2svg = props => {\n  const {mp, bCountries, ...other} = props;  // extract mp (map) only, and pass the other props for SVG\n\n  if (mp.type !== 'Topology') {\n    console.log('Invalid map: should be a topojson file.');\n    return null;\n  }\n  //const t0 = performance.now();\n\n  // initialize per map\n  const scale = mp.transform ? mp.transform.scale     : [1, 1];\n  const tranz = mp.transform ? mp.transform.translate : [0, 0];\n  const keyName = bCountries ? \"countries\" : \"land\";\n  let color_num = 0;\n  let fColor = ['Cornsilk', 'BlanchedAlmond', 'Bisque', 'NavajoWhite', 'Wheat', 'Burlywood', 'Tan', 'RosyBrown',\n                'SandyBrown', 'Goldenrod', 'DarkGoldenrod', 'Peru', 'Chocolate',\n                'SaddleBrown', 'Sienna', 'Brown', 'Maroon'];\n  let lns = [];\n  let k = 0;\n  //let countAll=0;  // debug\n  //let countOpt=0;\n  //let maxΔφ = 0;\n\n  // stitch multiple arcs\n  const stitch_arcs = (l, bClosed=true) => {\n    // arc to an array of points\n    const arc2pts = (ac_id, bRemoveLast=true) => {\n      // https://github.com/topojson/topojson-specification\n      const decode_arc = arc => {\n        let p = [0, 0];\n        return arc.map(pos => {\n          pos = pos.slice();\n          pos[0] = (p[0] += pos[0]) * scale[0] + tranz[0];  // rotate_π( \n          pos[1] = (p[1] += pos[1]) * scale[1] + tranz[1];\n          return pos;\n        });\n      }\n      const bReverse = (ac_id < 0);\n      const pts = decode_arc(mp.arcs[bReverse ? ~ac_id : ac_id]);\n      if (bReverse)\n        pts.reverse();\n     // countAll += pts.length;\n      if (bRemoveLast)  // remove redundancy\n        pts.splice(-1, 1);\n      return pts;\n    }\n\n    let n_pts = 0;\n    let d_p = '';\n    let p_last = null;\n    l.forEach(i =>\n      arc2pts(i).forEach(pt => {\n        const p = pjt.projection(pt);\n        if (!p[2]) {\n          d_p += svg_line(p_last, p);\n          p_last = p;\n          n_pts++;\n        }\n      })\n    );\n    if (n_pts < 2) {\n      return null;  // culled or invalid polygons\n    }\n    //countOpt += n_pts;\n    if (bClosed && (n_pts > 2)) {\n      d_p += 'Z';  // close\n    }\n    return d_p;\n  }\n\n  const line_string2path = ls => {\n    const d_p = stitch_arcs(ls, false);  // open path\n    if (d_p)\n      lns.push(<path key={k++} d={d_p} fill=\"none\" />);\n  }\n\n  // use a closed <path> instead of <polygon>\n  // inner polygons (counter-clockwise winding) follow after the first polygon\n  // Outer & Inner loop drawings: http://bl.ocks.org/mapsam/c76ed3ac3a79d9736dd7\n  // Most of data end with a single polygon.\n  const polygon2path = pg => {\n    let d_p = '';  // empty string\n    pg.forEach(lr => {    // for each LinearRing\n      const d = stitch_arcs(lr);\n      if (d)\n        d_p += d;\n    });\n    if (d_p) {  // need to set fill color only for bCountries\n      if (bCountries)\n        lns.push(<path key={k++} d={d_p} fill={fColor[color_num % fColor.length]} />);\n      else\n        lns.push(<path key={k++} d={d_p} />);  // set fill color in css\n    }\n  }\n\n  const geometry2svg = obj => {\n    if (!obj)\n      return;\n    switch (obj.type) {\n      case 'Point'             :\n      case 'MultiPoint'        :\n      case 'LineString'        : line_string2path(obj.arcs);                      break;\n      case 'MultiLineString'   : obj.arcs.forEach(ls => line_string2path(ls));    break;\n      case 'Polygon'           : polygon2path(obj.arcs);                          break;\n      case 'MultiPolygon'      : obj.arcs.forEach(pg => polygon2path(pg));        break;\n      case 'GeometryCollection': obj.geometries.forEach(gm => geometry2svg(gm));  break;\n      default:\n    }\n  /*\n    if (geom.hasOwnProperty(\"properties\") &&\n        geom.properties.hasOwnProperty(\"SOV_A3\") &&\n        geom.properties.SOV_A3 === 'JPN')\n      console.log(geom.properties);\n  */\n\n    // ISO 3166 country codes (249 countries)\n    if (obj.hasOwnProperty(\"id\")) {\n      color_num = obj.id % fColor.length;\n    }\n  }\n\n  // topo2svg\n  for (let key in mp.objects) {  // to access the unknown key\n    //if (mp.objects.hasOwnProperty(key)) {\n      //console.log(mp.objects[key]);\n      //console.log(mp.objects[key].type);\n    if (key === keyName) {  // 'countries' or 'land'\n      geometry2svg(mp.objects[key]);\n    }\n  }\n\n  //console.log(\"Total points:\", countAll, \"Optimized:\", countOpt,\n  //  \"Reduced:\", `${((countAll-countOpt)/countAll).toFixed(2)}%`);\n  // console.log(\"maxΔφ=\", maxΔφ);\n  //const t1 = performance.now();\n  //console.log('topo2svg:', (t1-t0).toFixed(2), 'ms');\n\n  return <g className={keyName} {...other}>{lns}</g>;\n}\n\nconst MapBorder = props => {\n  if (pjt.is_orthographic()) {\n    return <circle className=\"map_border\" cx={0} cy={0} r={pjt.get_orthographic_radius()} />;\n  }\n  const B = pjt.get_border();\n  let pt = [B[0], B[1]];\n  let p_last = null;\n  let d_p = '';\n\n  const move_pt = (i, sgn) => {\n    let p = pjt.projection(pt);\n    d_p += svg_line(p_last, p);\n    p_last = p;  // use .slice() to clone the array\n    pt[i] += sgn * props.step;      // should be a divisor of 90, otherwise out of range trouble can happen\n  }\n\n  while (pt[0] < B[2]) move_pt(0,  1);\n  while (pt[1] < B[3]) move_pt(1,  1);\n  while (pt[0] > B[0]) move_pt(0, -1);\n  while (pt[1] > B[1]) move_pt(1, -1);\n  d_p += 'Z';\n  //console.log(d_p.length);\n\n  return <path className=\"map_border\" d={d_p} />;\n}\n\n/*\nconst GraticuleRect = (props) => {\n  const B = props.map.bbox;  // [-180, -90, 180, 90];\n  const W = B[2] - B[0];\n  const H = B[3] - B[1];\n  let d_p = ''; //\"M-180,0h360M0,-90v180M-180,-90h360M-180,-75h360\";\n  for (let x = B[0]; x <= B[2]; x += props.step)\n    d_p += `M${x},${B[1]}v${H}`;\n  for (let y = B[1]; y <= B[3]; y += props.step)\n    d_p += `M${B[0]},${y}h${W}`;\n  return <path stroke={props.stroke} strokeWidth={props.strokeWidth} fill='none' opacity=\".5\" d={d_p} />;\n}\n*/\n\nconst svg_latitude = (y, step, x1, x2) => {\n  let p_last = null;\n  let d_p = '';\n  for (let x = x1; x <= x2; x += step) {\n    let p = pjt.projection([x, y]);\n    if (!p[2]) {\n      d_p += svg_line(p_last, p);\n      p_last = p;\n    } else {\n      p_last = null;\n    }\n  }\n  return d_p;\n}\n\nconst Graticule = props => {\n  //const t0 = performance.now();\n  const B = pjt.get_range();\n  let d_p = '';\n  // Optimization needed: Build the mesh first and then convert to the svg data\n  // Longitude\n  for (let x = B[0]; x < B[2]; x += props.step) {\n    const y_offset = (x % 45) ? 15 : 0;  // insert offset except for each 45° of the latitude\n    let p_last = null;\n    for (let y = B[1]+y_offset; y <= B[3]-y_offset; y += props.step) {\n      let p = pjt.projection([x, y]);\n      if (!p[2]) {\n        d_p += svg_line(p_last, p);\n        p_last = p;\n      } else {\n        p_last = null;\n      }\n    }\n  }\n  // Latitude\n  for (let y = B[1] + props.step; y < B[3]; y += props.step)\n    d_p += svg_latitude(y, props.step, B[0], B[2]);\n  //const t1 = performance.now();\n  //console.log('Graticule:', (t1-t0).toFixed(2), 'ms');\n\n  return <path className=\"graticule\" d={d_p} />;\n}\n\n// Tropic of Cancer, Tropic of Capricorn: ±23.4368° of the equator\nconst Tropics = props => {\n  const B = pjt.get_range();\n  let d_p = '';\n  for (let y of props.lat)\n    d_p += svg_latitude(y, props.step, B[0], B[2]);\n  return <path className={props.className} d={d_p} />;\n}\n\nconst SvgMain = props =>\n  <svg width={props.width} height={props.height} viewBox={bbox2viewBox(world.bbox)} >\n    <defs>\n      <filter id='dropshadow' height=\"130%\">\n        <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" />\n        <feOffset dx=\"1\" dy=\"1\" result=\"offsetblur\" />\n        <feComponentTransfer>\n          <feFuncA type=\"linear\" slope=\"0.5\" />\n        </feComponentTransfer>\n        <feMerge>\n          <feMergeNode />\n          <feMergeNode in=\"SourceGraphic\" />\n        </feMerge>\n      </filter>\n      <filter id=\"glow\"\n        x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\"\n        colorInterpolationFilters=\"sRGB\"\n      >\n        <feGaussianBlur result=\"coloredBlur\" stdDeviation=\"4\" />\n        <feMerge>\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"SourceGraphic\" />\n        </feMerge>\n      </filter>\n    </defs>\n    <g filter=\"url(#glow)\">\n      <MapBorder step={5} />\n      <Graticule step={15} />\n      <Topo2svg mp={world} bCountries={props.bCountries}\n        strokeWidth={(map_size(world.bbox)/1000)}\n      />\n      <Tropics className=\"tropics\" lat={[-23.4368, 23.4368]} step={5} />\n      <Tropics className=\"tropic0\" lat={[0]} step={5} />\n    </g>\n  </svg>;\n\nconst GeoAniDemo = props => {\n  const aniFrac = useAnimation('inOutCubic', 5000, 0);  // easing: linear, inQuad, inCubic, elastic, inExpo, ...\n\n  pjt.set_tween();\n  //pjt.set_culling(true);\n  pjt.interpolate_frac(aniFrac);\n  if (aniFrac === 1) {\n    pjt.end_tween();\n  }\n\n  return (\n    <div>\n      <SvgMain bCountries={props.bCountries} width={props.width} height={props.height} />\n    </div>\n  );\n}\n\nexport const GeoTest = props => {\n  // Declare a new state variable, which we'll call \"count\"\n  const [count,      setCount]        = useState(1);\n  const [bCountries, toggleCountries] = useState(false);\n  const [bCull,      toggleCull]      = useState(false);  // transparent\n  const [bAni,       toggleAni]       = useState(false);\n  const [height,     setHeight]       = useState(props.height ? props.height : 480);    // height\n  //lg:139.6917+30, lt:35.6895   // Tokyo longitude, latitude of the projection center\n  //lg:-118.4912-40, lt:34.0195  // Santa Monica, CA\n  const [loc,        setLoc]          = useState({lg: 139.6917, lt: 35.6895}); \n  const [tranz,      setTranz]        = useState({dx: 0, dy: 0});\n  const width = height; //Math.trunc(height * 800/480);\n  const normalize = a => {  // let the |degree| be contained within 360°\n    const s = v => Number.isInteger(v) ? v : Number.parseFloat(v.toFixed(3));  // short number\n    const aM = 360;\n    return s( (a < -aM) ? a + aM : ( (a > aM) ? a - aM : a ) );\n  }\n\n  const move_loc = (dx, dy) => {\n    setLoc({\n      lg: normalize(loc.lg - dx*.4),\n      lt: normalize(loc.lt + dy*.4)\n    });\n  };\n\n  pjt.set_location(loc.lg, loc.lt);\n  pjt.set_projection(count);\n  //pjt.set_location(loc.lg, loc.lt);\n  pjt.set_culling(bCull);\n  //pjt.set_location(loc.lg + aniFrac*(139.6917+30), loc.lt + aniFrac*35.6895);\n/*\n  useEffect(() => {  // run after every render!\n    // Update the document title using the browser API\n    document.title = pjt.get_projection_name();\n  }, [count]);  // Only re-run the effect if count changes\n  // <p className=\"report\" >{pjt.get_projection_name()}: {loc.lg}°, {loc.lt}°</p>\n*/\n\n  const aniFrame = () => {\n    if (bAni)\n      return;\n    setLoc({\n      lg: normalize(loc.lg - 1.2),\n      lt: loc.lt\n    });\n  }\n\n  useAnimationFrame(aniFrame, 1000/8);\n\n  const handleDoubleClick = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    const x = Math.trunc(width/2);\n    const y = Math.trunc(height/2);\n    setTranz({dx: ev.clientX - x, dy: ev.clientY - y});\n  }\n\n  return (\n    <EventMove\n      render={move_loc}\n      onDoubleClick={ev => handleDoubleClick(ev)}\n    >\n      <div className=\"geoTop\"\n        style={{transform: `translateX(${tranz.dx}px) translateY(${tranz.dy}px)`}}\n      >\n        {bAni ? <GeoAniDemo bCountries={bCountries} width={width} height={height} /> :\n                <SvgMain    bCountries={bCountries} width={width} height={height} />}\n      </div>\n      <div className=\"btnCont\">\n        {!bAni && <button className=\"btnDemo\" onClick={() => setCount(count + 1)}>switch projection</button>}\n        <button className=\"btnDemo\" onClick={() => toggleCountries(!bCountries)}>{bCountries ? 'Land'        : 'Countries'}</button>\n        <button className=\"btnDemo\" onClick={() => toggleCull(!bCull)}>          {bCull      ? 'Transparent' : 'Opaque'}</button>\n        <button className=\"btnDemo\" onClick={() => toggleAni(!bAni)}>            {bAni       ? 'Map'         : 'Animation'}</button>\n        <button className=\"btnDemo\" onClick={() => setHeight(height > 100 ? height-80 : height)}> {'-'}</button>\n        <button className=\"btnDemo\" onClick={() => setHeight(height+80)}>                {'+'}</button>\n      </div>\n    </EventMove>\n  );\n}\n// https://stackoverflow.com/questions/48248512/svg-transform-rotate180-does-not-work-in-safari-11\n// SVG 1.1 <svg> elements did not support transform attributes. SVG 2 supports it but Safari does not yet do so. \n/*\n  const [bAni,      toggleAni]    = useState(true);\n  const aniFrac = useAnimation('inOutCubic', 3000, 0);  // easing: linear, inQuad, inCubic, elastic, inExpo, ...\n\n  if (bAni) {\n    pjt.interpolate_frac(aniFrac);\n  } else {\n    //pjt.set_location(loc.lg + aniFrac*(139.6917+30), loc.lt + aniFrac*35.6895);\n    pjt.set_location(loc.lg + aniFrac*(360-118.4912), loc.lt + aniFrac*(34.0195-50));\n  }\n\n      <button onClick={() => toggleAni(!bAni)}>{bAni ? 'Stop Animate' : 'Animate'}</button>\n\n  const [bShowTZ,    toggleTZ]        = useState(false);\n      <button onClick={() => toggleTZ(!bShowTZ)}>          {bShowTZ    ? 'Hide Time Zone' : 'Show Time Zone'}</button>\n        {bShowTZ &&\n        <Topo2svg mp={timez}\n          strokeWidth={.3} fill=\"none\" stroke=\"green\" opacity=\".3\"\n        />}\n*/\n","// Map Projections\nimport {\n  π, π_2, τ, π_2xdegrees,\n  degrees, radians,\n  abs, sign, zero, epsilon,\n  sin, cos, tan, asin,\n  log, sqrt,\n  range\n} from './sqMath';\n// https://github.com/d3/d3-geo\n\nexport default class sqMapProjections {\n  constructor() {\n    this.frac = 0;   // fraction 0..1 to interpolate between projections\n    this.pjt_list = [\n      {name: 'Equirectangular',              fn: this.equirectangular},\n      {name: 'Orthographic',                 fn: this.orthographic},\n      {name: 'Nicolosi Globular Projection', fn: this.nicolosi_globular},\n      {name: 'Kavrayskiy VII Projection',    fn: this.kavrayskiy_VII},\n      {name: 'Mercator Projection',          fn: this.mercator},\n      {name: 'Equal Earth Projection',       fn: this.equal_earth},\n    ];\n    this.ctr  = [0, 0];\n    this.cull = true;   // backface culling on by default\n  }\n\n  projection = pt => this.equirectangular(pt);\n\n  get_culling = () => this.cull;\n  set_culling = (cull) => this.cull = cull;\n\n  get_num_projections = () => this.pjt_list.length;\n\n  normalize_pt = pt => {\n    let lg = pt[0] - this.ctr[0];\n    let lt = -pt[1];// + this.ctr[1];\n    const lgM = 180;\n    if      (lg < -lgM) lg += lgM*2;\n    else if (lg >  lgM) lg -= lgM*2;\n    /*\n    if      (lg < -lgM) lg = -lgM;\n    else if (lg >  lgM) lg =  lgM;\n    */\n    return [lg, lt];\n  }\n\n  is_orthographic = () => (this.projection === this.orthographic); \n\n  get_orthographic_radius = () => π_2xdegrees;\n\n  get_range = () => [-180, -90, 180, 90];\n\n  get_border = () => [-180+this.ctr[0], -90, 180+this.ctr[0], 90];\n\n  get_projection_object = (id=null) => {\n    let fn = (id !== null) ? this.pjt_list[id % this.pjt_list.length].fn : this.projection;\n    return this.pjt_list.find(el => el.fn === fn);\n  }\n  \n  set_tween = () => {\n    this.projection_last = this.projection;\n    const prj = (this.projection === this.orthographic) ?  this.mercator : this.projection;\n    this.projection = pt => this.tween_pjt(prj, this.orthographic)(pt);\n    /*\n    this.projection = (this.projection_last === this.orthographic) ?\n       pt => this.tween_pjt(this.orthographic, this.mercator) :\n       pt => this.tween_pjt(this.projection_last, this.orthographic);\n    */\n  }\n\n  end_tween = () => {\n    this.projection = this.projection_last;\n  }\n\n  set_projection = id => {\n    let obj = this.get_projection_object(id);\n    if (obj) {\n      this.projection = obj.fn;         // set a new projection function\n    }\n  }\n\n  get_projection_name = id => {\n    let obj = this.get_projection_object(id);\n    return obj ? obj.name : \"N/A\";\n  }\n\n  set_location = (lg, lt) => { this.ctr = [lg, lt]; }\n  \n  // interpolate between two projections\n  tween_pjt = (pjt1, pjt2) => pt => {\n    const p1 = pjt1(pt);\n    const p2 = pjt2(pt);\n    const lerp_p = i => zero(p1[i]-p2[i]) ? p1[i] : (1 - this.frac) * p1[i] + this.frac * p2[i];\n    const cull = (this.frac >= .99) ? p2[2] : null;\n    return [lerp_p(0), lerp_p(1), cull];\n  }\n\n  interpolate_frac = frac => {\n    this.frac = frac;\n  }\n\n  // ## Equirectangular projection\n  equirectangular = pt => this.normalize_pt(pt);\n\n  // map projection  https://en.wikipedia.org/wiki/List_of_map_projections\n  // ## Mercator cylindrical, conformal projection\n  // x = R(λ - λ0), y = R ln[tan(π/4 + φ/2)]\n  mercator = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const threshold = 85; // 85.051129;\n    const φ = range(lt, -threshold, threshold) * radians;\n    return [ lg, log(tan(π/4 + φ/2)) * degrees ];\n  }\n\n  // ## The Equal Earth pseudocylindrical (equal-area) map projection\n  // ## by Bojan Šavrič, Bernhard Jenny, and Tom Patterson (2018) inspired by Robinson projection.\n  // ## https://www.researchgate.net/publication/326879978_The_Equal_Earth_map_projection\n  equal_earth = pt => {  // longitude(λ), latitude\n    const [lg, lt] = this.normalize_pt(pt); // keep degree unit since the result will be converted back to degree\n    const φ   = lt * radians;\n    const A1  = 1.340264;\n    const A2  = -.081106;\n    const A3  = .000893;\n    const A4  = .003796;\n    const θ   = asin( (sqrt(3) / 2) * sin(φ) );\n    const θ_2 = θ * θ;\n    const θ_6 = θ_2 ** 3;\n\n    return [ 2 * sqrt(3)*lg*cos(θ) / (3*(A1 + 3*A2*θ_2 + θ_6*(7*A3 + 9*A4*θ_2))),\n             θ*( A1 + A2*θ_2 + θ_6*(A3 + A4*θ_2) ) * degrees];\n  }\n\n  // ## Nicolosi globular projection, polyconic\n  nicolosi_globular = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const λ = lg * radians;\n    const φ = lt * radians;\n    const π_2λ  = π/(2*λ);\n    const sinφ = sin(φ);\n    const cosφ = cos(φ);\n\n    // https://beta.observablehq.com/@toja/nicolosi-globular-projection\n    if (λ === 0 || abs(φ) === π_2) return [0, φ * degrees];\n    else if (φ === 0)              return [λ * degrees, 0];\n    else if (abs(λ) === π_2)       return [λ*cosφ * degrees, sinφ * π_2xdegrees];\n\n    const b       = π_2λ - (1/π_2λ);\n    const c       = 2*φ/π;\n    const d       = (1 - c*c) / (sinφ - c);\n    const sgnλ    = sign(λ);\n    const b2      = b*b;\n    const d2      = d*d;\n    const b2_d2   = b2/d2;\n    const d2_b2   = d2/b2;\n    const b2_d2a1 = b2_d2 + 1;\n    const d2_b2a1 = d2_b2 + 1;\n    const M = (b *sinφ/d  - b/2) / b2_d2a1;\n    const N = (d2*sinφ/b2 + d/2) / d2_b2a1;\n    const n = N*N - (d2*sinφ*sinφ/b2 + d*sinφ - 1)/d2_b2a1;\n\n    return [ (M + sqrt( M*M + cosφ*cosφ/b2_d2a1 )  * sgnλ) * π_2xdegrees,\n             (N + sqrt( n < 0 ? 0 : n ) * sign(-φ*b) * sgnλ) * π_2xdegrees ];\n  }\n\n  // Kavrayskiy VII pseudocylindrical, compromise projection\n  kavrayskiy_VII = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const λ = lg * radians;\n    const φ = lt * radians;\n\n    return [ 3*λ/τ * sqrt(π*π/3 - φ*φ) * degrees, lt ];\n  }\n\n  // https://en.wikipedia.org/wiki/Orthographic_projection_in_cartography\n  orthographic = pt => {\n    //const outer = (p >= -180 && p < -90) || (p > 90 && p <= 180);\n    //const outer = (p < -90) || (p > 90);\n    const [lg, lt] = this.normalize_pt(pt);\n    const Δλ = lg * radians;\n    const φ  = lt * radians;\n    const φ0 = -this.ctr[1] * radians;\n    const cosφ  = cos(φ);\n    const cosφ0 = cos(φ0);\n    const sinφ  = sin(φ);\n    const sinφ0 = sin(φ0);\n    const cosΔλ = cos(Δλ);\n    // dot product with the normal (to the screen) =\n    // (cosφ0cosλ0, cosφ0sinλ0, sinφ0)・(cosφcosλ, cosφsinλ, sinφ)\n    // sinφ0 * sinφ + cosφ0 * cosφ * cosΔλ\n    const cull = this.cull ? ( (sinφ0 * sinφ + cosφ0 * cosφ * cosΔλ < 0) ? true : null ) : null;\n    return [ epsilon(  cosφ  * sin(Δλ) * π_2xdegrees ),\n             epsilon( (cosφ0 * sinφ - sinφ0 * cosφ * cosΔλ) * π_2xdegrees ), cull];\n  }\n}  // class sqMapProjections\n\n/*\n// Stab-Werner Pseudoconical, Equal-area, Equidistant\nexport const pjt_stab-werner = (pt) => {\n  \n}\n\n// Mollweide (elliptical, Babinet, homolographic) Pseudocylindrical, Equal-area projection\nexport const pjt_Mollweide = (pt) => {\n  const λ = pt[0] * radians;\n  const φ = pt[1] * radians;\n  const sqrt2 = sqrt(2);\n  const θ = asin()\n\n  return [ (2*sqrt2/π) * λ*Math.cos(θ) * degrees,\n           (sqrt2 * Math.sin(θ)) * degrees];\n}\n*/\n","// used in './VideoEditor'\nimport React            from 'react';\nimport { EarthMoon3D }  from './demo/em/EarthMoon3D';\nimport { GeoTest }      from './demo/go/SQGeo';\nimport './App.scss';\n\nexport const EmbedYouTube = props =>\n  <iframe\n    title       = \"YouTube\"\n    width       = {props.width}\n    height      = {props.height}\n    src         = {`https://www.youtube.com/embed/${props.vID}?autoplay=1&mute=1&enablejsapi=1`}\n    frameBorder = \"0\"\n    allow       = \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n    allowFullScreen\n  />;\n\nexport const Layers = props => {\n  // La Vie en Rose: -NK9zdPj-os\n  // Cafe de Flore: w02agoYJ_H8\n  // New York Bar: lzQ3IS1Xq2s\n  // Fly Me To The Moon w0ZnimhDDhs\n  const { width, height, appId } = props;\n  console.log(\"Layers::\", appId);\n  const AppCompo = () => {\n    switch (appId) {\n      case 'app01': return <GeoTest height={Math.trunc(height * 3/4)} />;\n      case 'app02': return <EarthMoon3D width={width} height={height} />;\n      default     : return null;\n    }\n  }\n\n  return (\n    <div className=\"ve-cont\">\n      {props.children}\n      <div className=\"ve-l1\">\n        <AppCompo />\n      </div>\n    </div>\n  );\n}\n\n// <img src=\"img/missioncontrol.jpg\" alt=\"placeholder\" />\n  /*\n      <div className=\"ve-l2\">\n        <EmbedYouTube width={width} height={height} vID='w02agoYJ_H8'  />\n        <EarthMoon3D width={width} height={height} />\n      </div>\n*/\n","// https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications#Example_Using_\n// https://developers.google.com/web/updates/2012/07/Drag-and-drop-a-folder-onto-Chrome-now-available\nimport React from 'react';\nimport './DropArea.scss';\n\nconst CLASS_DROP       = \"drop-area\";\nconst CLASS_DROP_UNDER = \"drop-gallery\"\n\nconst lZ = n => (n < 10) ? '0' + n : n.toString();\nconst sec2hms = sec => {\n  if (sec < 60) {\n    return sec.toFixed(1) + 's';\n  }\n  let hstr = '';\n  let s = Math.trunc(sec);\n  const h = Math.trunc(s/3600);\n  if (h > 0) {\n    s -= h*3600;\n    hstr = h + ':';\n  }\n  const m = Math.trunc(s/60);\n  s -= m*60;\n  return hstr + lZ(m) + ':' + lZ(s);\n}\n\nexport const DropArea = props => {\n  console.log(\"DropArea::render\");\n  const [state, setState] = React.useState([]);  // array of DOM elements <img> or <div>\n  const refDA     = React.useRef(null); // DropArea\n  const rFilelist = React.useRef([]);\n\n  React.useEffect(() => {  // Prevent background <body> reacting to drop actions\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(\n      evName => document.body.addEventListener(evName, ev => ev.preventDefault(), false));\n  }, []);\n\n  const redundantFilename = fn => {\n    const fl = rFilelist.current;\n    for (let i=0; i < fl.length; i++) {\n      if (fl[i].name === fn)\n        return true;\n    }\n    return false;\n  }\n\n  // This event happens repeatedly!\n  const dragDropCommon = (ev, entering) => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    //setState({ ...state, hilight: entering ? 'hilight' : null});\n    refDA.current.classList.toggle('hilight', entering); // or .className = entering ? 'hilight' : '';\n  }\n\n  const handleDragStart = (ev, file) => {\n    ev.dataTransfer.dropEffect = 'copy';\n    ev.dataTransfer.setData(\"text/json\", JSON.stringify(file));  // cannot pass object directly\n  }\n\n  const handleDragOver  = ev => {\n    dragDropCommon(ev, true);\n    ev.dataTransfer.dropEffect = 'copy';\n  }\n\n  const handleDragEnd   = ev => { dragDropCommon(ev, false); }\n  const handleDragEnter = ev => { dragDropCommon(ev, true); }\n  const handleDragLeave = ev => { dragDropCommon(ev, false); }\n  // https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\n  const handleDrop = ev => {\n    dragDropCommon(ev, false);\n    /*\n    const len = ev.dataTransfer.items.length;\n    for (let i=0; i < len; i++) {\n      let entry = ev.dataTransfer.items[i].webkitGetAsEntry();\n      if (entry.isFile) {\n        console.log(entry, \"file\");\n      } else if (entry.isDirectory) {\n        console.log(entry, \"directory\");\n      }\n    }\n    */\n    const dt = ev.dataTransfer;\n    let countAdded = 0;\n    for (let i=0; i < dt.items.length; i++) {\n      const it = dt.items[i];\n      if (it.kind === 'string') {\n        //console.log(it, dt.getData(it.type));\n        if (it.type.match('^text/plain')) {            // it is the target node\n          it.getAsString(s => console.log(it.type, s));\n        } else if (it.type.match('^text/json')) {      // application defined user data\n          handleDropFileInfo( JSON.parse(dt.getData(it.type)) );  // get the string set by dt.setData()\n        } else if (it.type.match('^text/html')) {      // it is HTML\n          const html = dt.getData(it.type);\n          console.log(html);\n        } else if (it.type.match('^text/uri-list')) {  // it is URI\n          it.getAsString(s => console.log(it.type, s));\n          const uri = dt.getData(it.type);\n          if (uri.includes('app')) {\n            // ignore unnecessary escape character: \\/\n            // eslint-disable-next-line\n            let id = uri.replace(/^.*[\\\\\\/]/, '').split('.')[0];  // extract filename only\n            if (id && id.match('^app')) {\n              handleDropFileInfo({\n                type : 'app',\n                url  : uri,\n                id   : id,\n              });\n            }\n          } else if (uri.includes('youtube.com')) {\n            let id = uri.split('=')[1];\n            if (id && id.length === 11) {\n              handleDropFileInfo({\n                type : 'youtube',\n                url  : uri,\n                id   : id,\n              });\n            }\n          }\n        }\n      } else if (it.kind === 'file') {\n        //console.log(it);\n        if (it.type.match('^image/')) {\n          countAdded += RenderImg(it.getAsFile());\n        } else if (it.type.match('^video/')) {\n          countAdded += RenderVideo(it.getAsFile());\n        } else if (it.kind === '') {\n        } else {\n          console.log(it.kind, \"not supported yet!\");\n        }\n      }\n    }\n    if (countAdded > 0)\n      RenderUpdates();\n  }\n\n  const handleDropFileInfo = fInfo => props.onDropFileInfo && props.onDropFileInfo(fInfo);\n\n  const RenderUpdates = () => {\n    props.onDrop && props.onDrop(rFilelist.current);\n    setState([...state]);  // state should be an array, not an object; setState(state) will not re-render\n  }\n\n  const handleFiles = files => {  // called by input change event directly\n    if (!files.length) {\n      console.log(\"No files selected!\");\n      return;\n    }\n\n    let countAdded = 0;\n    for (let i = 0; i < files.length; i++) {  // files is an object, cannot apply forEach\n      countAdded += HandleFile(files[i]);\n    }\n    if (countAdded > 0)\n      RenderUpdates();\n  }\n\n  const updateFilelist = file => {\n    if (redundantFilename(file.name)) {\n      console.log(file.name, \"already exists.\");\n      return -1;\n    }\n    const fl = rFilelist.current;\n    fl.push({\n      type : file.type,\n      name : file.name,\n      size : file.size,\n      //date : file.lastModifiedDate,\n      url  : window.URL.createObjectURL(file),  // save to release later\n      id   : file.type.slice(0,2) + fl.length,  // 'vi' or 'im' plus index (starts from 0)\n    });\n    return fl.length - 1;\n  }\n\n  const RenderImg = file => {\n    const id = updateFilelist(file);\n    if (id < 0)\n      return 0;\n    const fInfo = rFilelist.current[id];\n    state.push(<img key={id} id={fInfo.id} src={fInfo.url} alt={fInfo.name}\n                 draggable onDragStart={ev => handleDragStart(ev, fInfo)}/>);\n    return 1;\n  }\n\n  const RenderVideo = file => {\n    const id = updateFilelist(file);\n    if (id < 0)\n      return 0;\n    const fInfo = rFilelist.current[id];\n    const handleLoadedMetadata = ev => {\n      const tg = ev.target;\n      const ds = tg.parentElement.dataset;  // parent div.dataset\n      ds.duration  = sec2hms(tg.duration);\n      ds.width     = tg.videoWidth;\n      ds.height    = tg.videoHeight;\n    }\n    // Media Fragments URI (url + \"#t=10\") or video.currentTime = 10;\n    // example, blob:http://localhost:3000/50c82a58-b01c-4450-b161-da006d44a152#t=10\n    // Videos that are not seekable should not be set currentTime (fast-forwarded)!\n    //video.currentTime = 5;\n    //video.playbackRate = 2;  // autoPlay\n    state.push(<div key={id} data-title={fInfo.name}\n                draggable onDragStart={ev => handleDragStart(ev, fInfo)}>\n        <video id={fInfo.id}\n          loop controls playsInline\n          onLoadedMetadata={handleLoadedMetadata}\n        >\n          <source src={fInfo.url} type={fInfo.type} />\n        </video>\n      </div>);\n    return 1;\n  }\n\n  const HandleFile = file => {  // FileList returned by the files property of <input> element\n    // https://cloudinary.com/documentation/upload_images#uploading_with_a_direct_call_to_the_api\n    // PW: 536Forest!@#\n    if (file.type.startsWith('image/')) {\n      return RenderImg(file);\n    } else if (file.type.startsWith('video/')) {\n      return RenderVideo(file);\n    } else {\n      console.log(file.name, file.type, \"not supported yet!\");\n      return 0;\n    }\n    /* Upload files\n    const url = 'https://api.cloudinary.com/v1_1/dicvu5udo/image/upload';\n    const formData = new FormData();\n    formData.append('upload_preset', 'hkbexlp4');\n    formData.append('file', file);\n    fetch(url, { method: 'POST', body: formData })\n      .then(() => console.log(\"Data uploaded\"))\n      .catch(() => console.log(\"Upload error!\"));\n    */\n    /*\n    const xhr = new XMLHttpRequest();\n    xhr.open('POST', url, true);\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n    xhr.addEventListener('readystatechange', function(ev) {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200)\n          updateProgress(i, 100);\n        // Error. inform the user\n      }\n    });\n    xhr.send(formData);\n    */\n  }\n\n  const handleClearClick = () => {\n    console.log(rFilelist.current.length, \"files\");\n    setState([]);\n    rFilelist.current = [];\n    /*\n    const gal = refGl.current;\n    while (gal.firstChild) {  // NEVER use gal.innerHTML = \"\"\n      const node = gal.firstChild;\n      if (node.url) {\n        console.log(\"revokeObjectURL\", node.url);\n        window.URL.revokeObjectURL(node.url);\n      }\n      gal.removeChild(node);\n    }\n    */\n  }\n\n  const DropForm = () =>\n    <form className=\"da-form\">\n      <input\n        id=\"df-file\"\n        type=\"file\"\n        multiple accept=\"image/*,video/*,audio/*,.pdf\"\n        onChange={ev => handleFiles(ev.target.files)}\n        className=\"vis-hid\"\n      />\n      <label className=\"df-label\" htmlFor=\"df-file\">Select or Drop Files</label>\n    </form>;\n\n  // onchange attribute of <input>\n  // ev.target:        <input ...>\n  // ev.target.value : filename\n  // ev.target.files : files\n  // Using a label element to trigger a hidden file input element\n  return (\n    <div\n      className  ={CLASS_DROP}\n      ref        ={refDA}\n      onDragEnter={handleDragEnter}\n      onDragOver ={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onDrop     ={handleDrop}\n      //onDragStart={handleDragStart}\n      onDragEnd  ={handleDragEnd}\n      style      ={props.style}\n    >\n      {props.children}\n      {props.form && <DropForm />}\n      {!props.noUi &&\n        <div className={CLASS_DROP_UNDER}>\n          {(props.help && state.length === 0) &&\n            <p className=\"drop-help\">{props.help}</p>}\n          <button type=\"button\" className=\"btn-clear\" onClick={handleClearClick}>\n            <span role=\"img\" aria-label=\"clear\">❌</span>\n          </button>\n          {state}\n        </div>}\n      {props.list && <ListViewFiles filelist={rFilelist.current} />}\n    </div>\n  );\n}\n\nconst ListViewFiles = props => {  // props.list is an array of file info\n  const { filelist } = props;\n  const [fold, setFold] = React.useState(false);  // true: fold, false: expanded\n  if (filelist.length === 0)\n    return null;\n  let i=0;\n\n  const fmtFilesize = sz => {\n    if (sz < 1024*1024) {\n      return (sz/1024).toFixed(1) + 'KB';\n    }\n    return (sz/(1024*1024)).toFixed(1) + 'MB';\n  }\n\n  return (\n    <div>\n      <button className=\"drop-list-btn\" type=\"button\"\n        onClick={()=>setFold(!fold)}\n      >Fileslist</button>\n      {!fold &&\n      <ul className=\"drop-list\">\n        {filelist.map(f =>\n          <li key={i++}>\n            <span>{`[${f.type}] `}</span>\n            <a href={f.url} target=\"_blank\" rel=\"noopener noreferrer\">{f.name}</a>\n            <span>{`(${fmtFilesize(f.size)})`}</span>\n          </li>\n        )}\n      </ul>}\n    </div>\n  );\n}\n/*\n    // Using FileReader -- much slower than ObjectURL\n    const previewFile = (file, i) => {\n      //console.log(file.name, `${(file.size/1024).toFixed(1)}KB`, file.type, file.lastModifiedDate);\n      if (!file.type.startsWith('image/')) {\n        alert(file.name + \" Not an image file!\");\n        return;\n      }\n      const reader = new FileReader();\n      reader.readAsDataURL(file);  // data:~/~;base64\n      //reader.readAsArrayBuffer(blob);\n      reader.onload = function() {  // or onloadend\n        //lns.push(<img key={file.name} src={reader.result} alt=\"dropped\" />);\n        //setData([...data, ...lns]);\n        const gal = refGl.current;\n        const img = document.createElement('img');  // Not allowed to load local resource\n        img.src = reader.result;\n        img.alt = \"dropped\";\n        img.draggable = \"true\";\n        gal.appendChild(img);\n      }\n    }\n    files = [...files];  // spread object elements to get an array\n    files.forEach(uploadFile);\n*/\n","import React            from 'react';\nimport { VEControls }   from './VEControls';\nimport { Layers,\n         EmbedYouTube } from './Layers';\nimport { DropArea }     from './DropArea';\nimport { useAnimationFrame }  from './util-ui';\nimport Tooltip          from '@material-ui/core/Tooltip';\n// https://webrtc.github.io/adapter/adapter-latest.js\nimport 'webrtc-adapter'; // include adapter for srcObject shim\nimport './App.scss';\n\nconst VE_SZ = {w: 800, h: 450};  // Video Editor Size\n\nconst rgb = (r, g, b) => ({r:r, g:g, b:b});\n\nexport const VideoEditor = React.forwardRef((props, rCvs) => {\n  console.log(\"VideoEditor::render\");\n  let { refVid } = props;  // ref to the video input\n  const initState = {\n    cKMode    : 1,      // Chroma Key selection mode 0: no , 1: Color Pick, 2: Back Frame\n    cKA       : [rgb(45,120,100)],  // chroma key color\n    cKFrame   : null,\n    cKThr     : 70*70,\n    fps       : 15,\n    curUrl    : null,    // current Backdrop file URL\n    curApp    : null,    // current active app id\n    curtube   : null,    // current YouTube video id\n  };\n  const [state, setState] = React.useState(initState);\n  const rTxt = React.useRef(null);  // ref to the text input element\n\n  const dispatch = action => {\n    const reducer = () => {  // return null for no state change\n      const hasCK = state.cKA.length > 0;\n      switch (action.type) {\n        case 'setCam':\n          switchVideoInput( document.getElementById('v-cam') );\n          return null;\n        case 'setCKMode':\n          //console.log('cKMode:', action.payload);\n          //return { ...state, cKMode: action.payload };\n          state.cKMode = action.payload;\n          return state;\n        case 'addCK':  // add a chroma key or a whole frame\n          if (state.cKMode === 1) {\n            if (!isChromaColor(action.payload)) {\n              state.cKA.push(action.payload);\n            }\n          } else if (state.cKMode === 2) {\n            state.cKFrame = action.payload;\n          }\n          return { ...state };\n        case 'clearCK':  // purge chroma keys\n          if (state.cKMode === 1) {\n            if (hasCK) {\n              state.cKA = [];\n              return { ...state };\n            }\n          } else if (state.cKMode === 2) {\n            if (state.cKFrame) {\n              state.cKFrame = null;\n              return { ...state };\n            }\n          }\n          return null;\n        case 'dropCK':  // remove the most recently added chroma key\n          if (hasCK) {\n            state.cKA.splice(-1,1);\n            return { ...state };\n          }\n          return null;\n        case 'setCKThr':  // set chroma key threshould\n          //return { ...state, cKThr: action.payload**2};\n          state.cKThr = action.payload**2;\n          return null;  // no need to re-render\n        default:  // throw new Error('Unknown action type!');\n          console.error('dispatch error!');\n      }\n    }\n    const newState = reducer(action);\n    if (newState) {  // check if we have to rerender\n      setState(newState);\n    }\n  }\n\n  const isRunning = () => refVid.current &&\n                         !refVid.current.paused;\n  \n  // https://en.wikipedia.org/wiki/Color_difference\n  // Color Metric - low-cost approximation: https://www.compuphase.com/cmetric.htm\n  const isChromaColor = (c, i=0) => {  // c: rgb object\n    //const ck = {r: 60, g: 139, b: 116};\n    const colorDist = cK => {\n      const rm = (c.r + cK.r) / 3;  // red mean\n      return  (2 + rm/256)*(c.r - cK.r)**2 +\n                         4*(c.g - cK.g)**2 +\n        (2 + (255-rm)/256)*(c.b - cK.b)**2;\n    }\n    if (state.cKMode === 2 && state.cKFrame) {\n      const clr = state.cKFrame.data;\n      if (colorDist(rgb(clr[i], clr[i+1], clr[i+2])) < state.cKThr)\n        return true;\n    }\n    // Need to introduce pre-sorted and binary search for performance\n    for(let j=0; j < state.cKA.length; j++) {\n      if (colorDist(state.cKA[j]) < state.cKThr)\n        return true;\n    }\n    return false;\n    //const w  = {r: 2,  g: 4,   b: 3};  // for weighted Euclidean distance in RGB\n    //return ( w.r*(r - cK.r)**2 + w.g*(g - cK.g)**2 + w.b*(b - cK.b)**2 ) < 5000; // threshould\n    //return (g > 90 && r < 150 && b < 180); //if (g > 120 && r > 120 && b > 120)\n  }\n    /*\n  const drawOnCanvas = ctx => {\n    ctx.beginPath();\n    ctx.strokeStyle = \"Blue\";\n    ctx.arc(80, 80, 50, 0, Math.PI * 2, true);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.strokeStyle = \"Red\";\n    ctx.rect(20, 20, 200, 100);\n    ctx.stroke();\n  }\n  */\n  /*  not working\n  useEffect(() => {\n    const asp = refVid.current.videoWidth / refVid.current.videoHight;\n    if (asp) {\n      const width = 800;\n      rCvs.current.width  = width;\n      rCvs.current.height = Math.trunc(width / asp);\n    }\n  }, [rCvs, refVid]);\n  */\n\n  useAnimationFrame(() => {\n    if (isRunning()) {  // will change; also, check if the video paused or ended\n      const cvs = rCvs.current;\n      const ctx = cvs.getContext('2d');\n      ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n      //ctx.filter = 'brightness(2)';\n      const frame = ctx.getImageData(0, 0, cvs.width, cvs.height);\n      const c = frame.data; // Uint8ClampedArray, color byte\n      for (let i=0; i < c.length; i+=4) {\n        if ( state.cKMode > 0 && isChromaColor(rgb(c[i],c[i+1],c[i+2]), i) )\n          c[i+3] = 0;  // transparency: opacity 0..255\n      }\n      ctx.putImageData(frame, 0, 0);\n    }\n  }, 1000/state.fps);\n\n  /*\n  React.useEffect(() => {\n    let id = null;\n    const tick = () => {\n      if (isRunning()) {  // will change; also, check if the video paused or ended\n        const cvs = rCvs.current;\n        const ctx = cvs.getContext('2d');\n        ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n        //ctx.filter = 'brightness(2)';\n        const frame = ctx.getImageData(0, 0, cvs.width, cvs.height);\n        const c = frame.data; // Uint8ClampedArray, color byte\n        for (let i=0; i < c.length; i+=4) {\n          if ( state.cKMode > 0 && isChromaColor(rgb(c[i],c[i+1],c[i+2]), i) )\n            c[i+3] = 0;  // transparency: opacity 0..255\n        }\n        ctx.putImageData(frame, 0, 0);\n        id = setTimeout(tick, 1000/state.fps);  // milliseconds/fps\n      } else {\n        //console.log(\"No video!\");\n        id = setTimeout(tick, 1000/4);  // check period\n      }\n    }\n    tick();  // actually this should be triggered by onPlay from <video>\n    if (id)\n      return () => clearTimeout(id);\n    // react-hooks/exhaustive-deps; to ignore isChromaKey, fps (updates by the timer)\n    // eslint-disable-next-line\n  }, [refVid, state]); // state should be included even though it is a global variable\n\n  */\n  // const rgb2hex = (r, g, b) => ( (r << 16) | (g << 8) | b ).toString(16);  // no range check\n\n  const handleClick = ev => {\n    //console.log(\"handleClick\", ev);\n    ev.preventDefault();\n    ev.stopPropagation();  // not to fire twice\n    //console.log(refVid, refVid.current.paused);\n    if (!isRunning() || state.CKMode === 0)\n      return;\n    const cvs = rCvs.current;\n    const ctx = cvs.getContext('2d');\n    if (state.cKMode === 1) {  // Pick a chorma key color\n      const x = ev.pageX - cvs.offsetLeft;\n      const y = ev.pageY - cvs.offsetTop;\n      const c = ctx.getImageData(x, y, 1, 1).data;\n      console.log(x, y, c);\n      if (!c[3])  // transparent pixel (existing chroma-key)\n        return;\n      dispatch({type: 'addCK', payload: rgb(c[0],c[1],c[2])});\n      //const h = \"#\" + (\"000000\" + rgb2hex(c[0], c[1], c[2])).slice(-6);\n    } else if (state.cKMode === 2) {  // chroma key Frame\n      ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n      console.log(\"Chroma Key Frame captured\");\n      dispatch({type: 'addCK', payload: ctx.getImageData(0, 0, cvs.width, cvs.height)});\n    }\n  }\n\n  const handleTextInput = ev => {\n    const len = ev.target.value.length;\n    const n_lines = Math.trunc(len * 30 / 800);\n    rTxt.current.style.transform = (n_lines >= 3) ? `translateY(${-n_lines*20}px)` : \"\";\n    rTxt.current.textContent = ev.target.value;\n  }\n\n  const switchVideoInput = vEl => {  // video element\n    if (vEl) {  // pause current video (or webcam) and play new video\n      refVid.current.pause();\n      refVid.current = vEl;\n      vEl.play();\n    }\n  }\n\n  const handleDropFileInfo = fInfo => {\n    if (fInfo.type.match('^video/')) {\n      switchVideoInput( document.getElementById(fInfo.id) );\n    } else if (fInfo.type.match('^image/')) {\n      if (state.curUrl !== fInfo.url) {\n        setState({...state, curUrl: fInfo.url});\n      }\n    } else if (fInfo.type.match('^app')) {\n      if (state.curApp !== fInfo.id) {\n        setState({...state, curApp: fInfo.id});\n      }\n    } else if (fInfo.type.match('^youtube')) {\n      if (state.curTube !== fInfo.id) {\n        setState({...state, curTube: fInfo.id});\n      }\n    }\n  }\n\n  const CKPalette = () => {  // Chroma-Keys Palette\n    const RGBstr = c => `rgb(${c.r},${c.g},${c.b})`;\n    const CKColor = ({color}) => <Tooltip title={color}><span style={{color: color}}>█</span></Tooltip>;\n    //console.log(state.cKA);\n    return (\n      <div className=\"ckpalette\">\n        chroma keys:&nbsp;\n        {state.cKA.map((c, i) => <CKColor key={i} color={RGBstr(c)} />)}\n      </div>\n    );\n  }\n\n  React.useEffect(() => {\n    const delay = 200;\n    const msg = \"SpacetimeQ Web Video Editor Prototype ...\";\n    let i = 0;\n    let elapsed = 0;\n\n    function tick() {\n      if (rTxt.current) {\n        elapsed += delay;\n        if(i < msg.length) {\n          rTxt.current.textContent += msg[i++];\n        } else {\n          rTxt.current.style.opacity = 0;  // transition required\n        }\n        if (elapsed > 16*1000) {\n          clearInterval(id);\n          rTxt.current.textContent   = '';\n          rTxt.current.style.opacity = 1;\n        }\n      }\n    }\n    let id = setInterval(tick, delay);\n    return () => clearInterval(id);\n  }, []);\n\n  return (\n    <>\n      <Layers width={VE_SZ.w} height={VE_SZ.h} appId={state.curApp}>\n        <div className=\"ve-l0\"\n          style={state.curUrl ? {backgroundImage: `url(${state.curUrl})`} : null}\n        >\n          {state.curTube &&\n            <EmbedYouTube width={VE_SZ.w} height={VE_SZ.h} vID={state.curTube} />} \n        </div>\n        <DropArea\n          noUi\n          onDropFileInfo={handleDropFileInfo}\n        >\n          <canvas ref={rCvs} id=\"v-ed\"\n            width={VE_SZ.w} height={VE_SZ.h} onClick={handleClick}\n          />\n          <p ref={rTxt} className=\"text-in\"></p>\n        </DropArea>\n      </Layers>\n      <VEControls dispatch={dispatch} onChange={handleTextInput} />\n      <CKPalette />\n    </>\n  );\n});\n","import React from 'react';\nimport { makeStyles }  from '@material-ui/core/styles';\nimport AppBar          from '@material-ui/core/AppBar';\nimport CssBaseline     from '@material-ui/core/CssBaseline';\nimport Toolbar         from '@material-ui/core/Toolbar';\nimport IconButton      from '@material-ui/core/IconButton';\nimport Fab             from '@material-ui/core/Fab';  // Floating Action Buttons\nimport MenuIcon        from '@material-ui/icons/Menu';\nimport VideocamIcon    from '@material-ui/icons/Videocam';  // ./node_modules/@material-ui/icons/\nimport VideocamOffIcon from '@material-ui/icons/VideocamOff';\nimport PlayIcon        from '@material-ui/icons/PlayArrow';\nimport VolumeMuteIcon  from '@material-ui/icons/VolumeMute';\nimport SearchIcon      from '@material-ui/icons/Search';\nimport MoreIcon        from '@material-ui/icons/MoreVert';\n\nconst useStyles = makeStyles(theme => ({\n  text: {\n    padding: theme.spacing(2, 2, 0),\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper,\n  },\n  appBar: {\n    top: 'auto',\n    bottom: 0,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  fabButton: {\n    /*\n    position: 'absolute',\n    zIndex: 1,\n    top: 2,\n    left: 0,\n    right: 0,\n    margin: '0 auto',\n    */\n    margin: theme.spacing(1)\n  },\n}));\n\nconst FabToggleVideocam = props => {  // to localize (not to propagate) rendering\n  const classes = useStyles();\n  const [video, setVideo] = React.useState(false);\n  const handleVideocam = () => {\n    setVideo(!video);\n    props.onVideo(!video);\n    //console.log(\"videocam clicked\");\n  }\n\n  return (\n    <Fab size=\"small\" color={video ? \"default\" : \"secondary\"} aria-label=\"Videocam\" className={classes.fabButton}>\n      {video ?\n      <VideocamOffIcon onClick={()=>handleVideocam()} /> :\n      <VideocamIcon    onClick={()=>handleVideocam()} />}\n    </Fab>\n  );\n}\n\nexport default function BottomAppBar(props) {\n  console.log(\"BottomAppBar::render\");\n  const classes = useStyles();\n\n  return (\n    <>\n      <CssBaseline />\n      <AppBar position=\"fixed\" color=\"primary\" className={classes.appBar}>\n        <Toolbar>\n          <IconButton edge=\"start\" color=\"inherit\" aria-label=\"Open drawer\" onClick={props.onStart}>\n            <MenuIcon />\n          </IconButton>\n          <FabToggleVideocam onVideo={props.onVideo} />\n          <Fab size=\"small\" color=\"default\" aria-label=\"VolumeMute\" className={classes.fabButton}>\n            <VolumeMuteIcon onClick={()=>console.log(\"VolumeMute\")} />\n          </Fab>\n          <Fab size=\"small\" color=\"default\" aria-label=\"Play\" className={classes.fabButton}>\n            <PlayIcon onClick={()=>console.log(\"Play\")} />\n          </Fab>\n          <div className={classes.grow} />\n          <IconButton color=\"inherit\">\n            <SearchIcon />\n          </IconButton>\n          <IconButton edge=\"end\" color=\"inherit\">\n            <MoreIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n    </>\n  );\n}\n","import React from 'react';\nimport { makeStyles }    from '@material-ui/core/styles';\nimport SwipeableDrawer   from '@material-ui/core/SwipeableDrawer';\nimport List              from '@material-ui/core/List';\nimport Divider           from '@material-ui/core/Divider';\nimport ListItem          from '@material-ui/core/ListItem';\nimport ListItemIcon      from '@material-ui/core/ListItemIcon';\nimport ListItemText      from '@material-ui/core/ListItemText';\nimport InboxIcon         from '@material-ui/icons/MoveToInbox';\nimport MailIcon          from '@material-ui/icons/Mail';\n                         \nimport Dialog            from '@material-ui/core/Dialog';\nimport DialogActions     from '@material-ui/core/DialogActions';\nimport DialogContent     from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle       from '@material-ui/core/DialogTitle';\nimport Button            from '@material-ui/core/Button';\n\nconst useStyles = makeStyles({\n  list: {\n    width: 200,\n  },\n  fullList: {\n    width: 'auto',\n  },\n});\n\nexport const LeftDrawer = React.forwardRef((props, ref) => {\n  console.log(\"LeftDrawer::render\");\n  const classes = useStyles();\n  const [state,    setState]    = React.useState(props.show);  // open\n  const [dlgTitle, setDlgTitle] = React.useState(null);\n\n  const toggleDrawer = open => event => {\n    if (event &&\n        event.type === 'keydown' &&\n        (event.key === 'Tab' ||\n         event.key === 'Shift'))\n    {\n      return;\n    }\n    setState(open);\n  };\n\n  const handleClick = ev => { setDlgTitle(ev.target.innerText); }\n\n  return (\n    <div>\n      {dlgTitle && <MsgDialog open={true} onClose={()=>setDlgTitle(null)} title={dlgTitle}>\n        SpacetimeQ Prototype\n      </MsgDialog>}\n      <button ref={ref} onClick={toggleDrawer(true)} style={{display: 'none'}}></button>\n      <SwipeableDrawer\n        open={state}\n        // anchor=\"right\", \"top\", \"bottom\"\n        onClose={toggleDrawer(false)}\n        onOpen={toggleDrawer(true)}\n      >\n        <div\n          className={classes.list}\n          role=\"presentation\"\n          onClick={toggleDrawer(false)}\n          onKeyDown={toggleDrawer(false)}\n        >\n          <List>\n            {['About', 'Recent', 'Movies', 'Images'].map((text, index) => (\n              <ListItem button key={text} onClick={handleClick} disabled={index > 0}>\n                <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n                <ListItemText primary={text} />\n              </ListItem>\n            ))}\n          </List>\n          <Divider />\n          <List>\n            {['demo1', 'demo2', 'demo3'].map((text, index) => (\n              <ListItem button key={text} disabled >\n                <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n                <ListItemText primary={text} />\n              </ListItem>\n            ))}\n          </List>\n        </div>\n      </SwipeableDrawer>\n    </div>\n  );\n});\n\nconst MsgDialog = props => {\n  console.log(\"MsgDialog::\", props.title);\n  return (\n    <Dialog\n      open={props.open}\n      onClose={props.onClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{props.title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          {props.children}\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={props.onClose} color=\"primary\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React from 'react';\nimport './App.scss';\nimport { Webcam }       from './webcam';\nimport { VideoEditor }  from './VideoEditor';\nimport { DropArea }     from './DropArea';\n\n// Material-UI\nimport clsx             from 'clsx';\nimport { makeStyles }   from '@material-ui/core/styles';\nimport BottomAppBar     from './BottomAppBar';\nimport { LeftDrawer }   from './LeftDrawer';\n//import TrailerCard from './CICard';\n\nimport Grid             from '@material-ui/core/Grid';\nimport Paper            from '@material-ui/core/Paper';\nimport Fab              from '@material-ui/core/Fab';\nimport AddIcon          from '@material-ui/icons/Add';\nimport DeleteIcon       from '@material-ui/icons/Delete';\nimport LayersIcon       from '@material-ui/icons/Layers';\nimport GridList         from '@material-ui/core/GridList';\nimport GridListTile     from '@material-ui/core/GridListTile';\nimport GridListTileBar  from '@material-ui/core/GridListTileBar';\n//import ListSubheader    from '@material-ui/core/ListSubheader';\nimport IconButton       from '@material-ui/core/IconButton';\nimport InfoIcon         from '@material-ui/icons/Info';\n//import tileData         from './tileData';\nimport Tooltip          from '@material-ui/core/Tooltip';\nimport Slider           from '@material-ui/core/Slider';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n  },\n  canvas: {\n    width: 840,\n  },\n  layers: {\n    width: 250,\n  },\n  appsList: {\n    width: 250,\n    height: 340,\n  },\n  paper: {\n    padding: theme.spacing(2),\n    color: theme.palette.text.primary,\n    margin: 6,  // marginLeft\n  },\n  fab: {  // floating action button\n    margin: theme.spacing(1),\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(1),\n  },\n  appSlider: {\n    width       : '80%',\n    marginTop   : theme.spacing(5),\n    marginLeft  : theme.spacing(3),\n    paddingBottom: theme.spacing(1),\n    zIndex      : 1000,\n  },\n  /*\n  appTitle: {\n    height: 16,\n    lineHeight: 16,\n    fontSize: 'small',\n    color: 'white',\n    background: 'black',\n    borderRadius: '5px 5px 0 0',\n  },\n  */\n  gridList: {\n    height: 300,\n  },\n  icon: {\n    color: 'rgba(255,255,255,.54)',\n  }\n}));\n\nfunction App() {\n  console.log(\"App::render\");\n  const cls = useStyles();\n  const refCam = React.useRef(null); // <video> camera\n  const refCvs = React.useRef(null); // <canvas> for video editing\n  const refLD  = React.createRef();  // <LeftDrawer> to wire with <BottomAppBar> start button\n\n  const handleVideo = on => {\n    const cam = refCam.current;\n    if (on) { cam.play(); }\n    else    { cam.pause(); }\n  }\n\n  return (  // autoPlay\n    <div className=\"App\">\n      <div className={cls.root}>\n        <Grid container spacing={2}>\n          <Grid item xs={9}>\n            <Paper className={clsx(cls.canvas, cls.paper)}>\n              <VideoEditor ref={refCvs} refVid={refCam} />\n            </Paper>\n          </Grid>\n          <Grid item xs={3}>\n            <LayersHeader>Layers</LayersHeader>\n            <Paper className={clsx(cls.layers, cls.paper)}>\n              <Webcam ref={refCam}\n                onPlay ={()=>{console.log(\"Webcam::onPlay\");}}\n                onPause={()=>{console.log(\"Webcam::onPause\");}}\n              />\n            </Paper>\n            <Paper className={clsx(cls.appsList, cls.paper)}>\n              <AppsList />\n            </Paper>\n          </Grid>\n          <Grid item xs={12}>\n            <DropArea\n              list\n              help=\"~ Drag & drop backdrop image files or source video files here ~\"\n              style={{\n                border: '1px dashed #ccc',\n                minHeight: '200px',\n                margin: '10px'\n              }}\n            />\n          </Grid>\n          <Grid item xs={12}>\n            <p className=\"footer\">Video Editor Prototype (C) SpacetimeQ Inc, 2019</p>\n          </Grid>\n        </Grid>\n      </div>\n      <LeftDrawer ref={refLD} show={false} />\n      <BottomAppBar\n        onVideo={on=>handleVideo(on)}\n        onStart={()=>refLD.current.click()}\n      />\n    </div>\n  );\n}\n\nconst LayersHeader = props => {\n  const cls = useStyles();\n\n  const handleLayersClick = () => { console.log(\"Layers Clicked\"); }\n  const handleAddClick    = () => { console.log(\"Add Clicked\"); }\n  const handleDeleteClick = () => {\n    const el = document.getElementsByClassName('ve-l0')[0];\n    if (el) {\n      el.style.backgroundImage = '';\n      /* React element\n      let child = el.lastElementChild;\n      while (child) {\n        el.removeChild(child);\n        child = el.lastElementChild;\n      }\n      */\n    }\n  }\n\n  return (\n    <div>\n      <Fab variant=\"extended\" size=\"medium\" aria-label=\"Title\" className={cls.fab}\n        onClick={handleLayersClick}>\n        <LayersIcon className={cls.extendedIcon} />\n        {props.children}\n      </Fab>\n      <Fab color=\"primary\" size=\"small\" aria-label=\"Add\" className={cls.fab}\n        disabled\n        onClick={handleAddClick}>\n        <AddIcon />\n      </Fab>\n      <Fab size=\"small\" aria-label=\"Delete\" className={cls.fab}\n        onClick={handleDeleteClick}>\n        <DeleteIcon />\n      </Fab>\n    </div>\n  );\n}\n\nconst AppsList = props => {\n  const cls = useStyles();\n  const TBD = 'TBD';\n  const tileData = [\n    {\n      img   : './img/app01.jpg',  // filename.ext -> filename will be used as the app id\n      title : 'Earth Globe',\n      sub   : 'Geospatial',\n    },\n    {\n      img   : './img/app02.jpg',\n      title : 'Planet Earth',\n      sub   : 'Realistic 3D',\n    },\n    {\n      img   : './img/app03.jpg',\n      title : 'ArtMoon',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app04.jpg',\n      title : 'Solar System',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app05.jpg',\n      title : '3D Demo',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app06.jpg',\n      title : 'SpacetimeQ',\n      sub   : TBD,\n    },\n  ];\n  const handleAppVis = (ev, newVal) => {\n    const el = document.getElementsByClassName('ve-l1')[0];\n    if (el) {\n      el.setAttribute(\"style\", 'z-index: ' + newVal);\n    }\n  }\n  // <ListSubheader component=\"div\" className={cls.appTitle}>Apps for Demo</ListSubheader>\n  return (\n    <GridList cellHeight={140} className={cls.gridList}>\n      <GridListTile key=\"Subheader\" cols={2} style={{ height: '70px' }}>\n        <Tooltip title=\"Apps Visibility\">\n          <Slider\n            className={cls.appSlider}\n            defaultValue={40}\n            valueLabelDisplay=\"auto\"\n            step={10}\n            marks\n            min={0}\n            max={100}\n            onChange={handleAppVis}\n          />\n        </Tooltip>\n      </GridListTile>\n      {tileData.map(tile => (\n        <GridListTile key={tile.img}>\n          <img className=\"al-icon\" src={tile.img} alt={tile.title} />\n          <GridListTileBar\n            title={tile.title}\n            subtitle={<span>{tile.sub}</span>}\n            actionIcon={\n              <IconButton aria-label={`info ${tile.title}`} className={cls.icon}>\n                <InfoIcon />\n              </IconButton>\n            }\n          />\n        </GridListTile>\n      ))}\n    </GridList>\n  );\n};\n\nexport default App;\n\n/*\n\nconst flixURL = i => {\n  const prefix = \"https://www.totaleclips.com/Player/Bounce.aspx?eclipid=\";\n  const suffix = \"&type=.mp4\";\n  const aFlix = [\n    \"e44573&bitrateid=471&vendorid=102\",\n    \"e18472&bitrateid=472&vendorid=102\",\n    \"e19268&bitrateid=472&vendorid=102\",\n    \"e21095&bitrateid=461&vendorid=102\",\n    \"e26097&bitrateid=472&vendorid=102\",\n    \"e19578&bitrateid=455&vendorid=102\",\n    \"e98124&bitrateid=472&vendorid=102\",\n  ];\n  return prefix + aFlix[i % aFlix.length] + suffix;\n}\n              <video ref={refVid} id=\"vid1\" muted loop playsInline controls >\n                <source src={flixURL(5)} type='video/mp4' />\n              </video>\n          <Grid item xs={6}>\n            <TrailerCard src={flixURL(0)} />\n          </Grid>\n          <Grid item xs={6}>\n            <TrailerCard src={flixURL(4)} />\n          </Grid>\n*/\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}