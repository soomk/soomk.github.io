{"version":3,"sources":["webcam.js","VEControls.js","demo/em/EarthMoon3D.js","demo/go/sqMath.js","util-ui.js","demo/go/sqAnimation.js","demo/go/SQGeo.js","demo/go/sqMapProjections.js","Layers.js","DropArea.js","VideoEditor.js","BottomAppBar.js","LeftDrawer.js","App.js","serviceWorker.js","index.js"],"names":["Webcam","React","forwardRef","props","ref","console","log","rTitle","useRef","constraints","audio","echoCancellation","exact","video","width","height","facingMode","useEffect","navigator","mediaDevices","alert","videoStream","Object","asyncToGenerator","regenerator_default","a","mark","_callee","stream","videoTracks","wrap","_context","prev","next","getUserMedia","sent","getVideoTracks","current","textContent","label","onremovetrack","window","srcObject","pause","t0","name","error","stop","getTracks","forEach","tr","react_default","createElement","className","id","autoPlay","muted","playsInline","controls","onPlay","onPause","useStyles","makeStyles","theme","container","display","textField","button","marginTop","spacing","marginBottom","padding","avatar","marginRight","switch","slider","marginLeft","zIndex","close","ChromaKeyToolbox","dispatch","cls","_React$useState","useState","_React$useState2","slicedToArray","on","setOn","_React$useState3","_React$useState4","mode","setMode","_React$useState5","_React$useState6","snack","setSnack","dispatchNewMode","newMode","type","payload","handleSnackbarClose","ev","reason","Fragment","Tooltip","title","Switch","checked","onChange","target","value","inputProps","aria-label","IconButton","disabled","onClick","Colorize_default","Camera_default","Delete_default","InvertColorsOff_default","Slider","defaultValue","valueLabelDisplay","step","marks","min","max","newVal","ZoomIn_default","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","ContentProps","aria-describedby","message","action","key","color","Close_default","RandomAvatar","_React$useState7","_React$useState8","rUser","setRUser","generateRandomUser","Math","random","floor","Avatar","alt","src","VEControls","VEControls_RandomAvatar","TextField","margin","variant","fullWidth","multiline","rowsMax","VEControls_ChromaKeyToolbox","EarthMoon3D","rMount","rControls","rCamDir","_useState","_useState2","isAnimating","setAnimating","img","fn","frameId","mount","clientWidth","clientHeight","earthVec","THREE","scene","camera","position","z","light","add","set","loader","geometry","material","map","load","bumpMap","bumpScale","specularMap","specular","earthMesh","rotation","x","cloudsMesh","side","opacity","transparent","depthWrite","moonMesh","starsMesh","renderer","antialias","setClearColor","setSize","renderScene","render","handleResize","aspect","updateProjectionMatrix","animate","camDir","camPos","y","lookAt","requestAnimationFrame","start","cancelAnimationFrame","appendChild","domElement","addEventListener","removeEventListener","removeChild","remove","dispose","style","τ","PI","π","π_2","degrees","radians","abs","sin","cos","tan","sign","sqrt","pow","zero","v","epsilon","EventMove","others","objectWithoutProperties","_useState7","_useState8","mousedown","setMouseDown","_useState9","_useState10","mouse","setMouse","_moveStart","p","touches","pageX","pageY","clientX","clientY","_move","_moveEnd","assign","onMouseUp","onMouseMove","onMouseDown","onTouchStart","preventDefault","stopPropagation","onTouchMove","nativeEvent","stopImmediatePropagation","onTouchEnd","children","useAnimationFrame","callback","delay","savedCallback","lastTs","tick","ts","ua","userAgent","toLowerCase","indexOf","detectBrowser","useAnimationTimer","duration","arguments","length","undefined","elapsed","setTime","animationFrame","timerStop","onFrame","Date","now","loop","timerDelay","setTimeout","clearTimeout","pjt","sqMapProjections","_this","this","classCallCheck","projection","pt","equirectangular","get_culling","cull","set_culling","get_num_projections","pjt_list","normalize_pt","lg","ctr","lgM","is_orthographic","orthographic","get_orthographic_radius","get_range","get_border","get_projection_object","find","el","set_tween","projection_last","prj","mercator","tween_pjt","end_tween","set_projection","obj","get_projection_name","set_location","lt","pjt1","pjt2","p1","p2","lerp_p","i","frac","interpolate_frac","r2","_this$normalize_pt","_this$normalize_pt2","φ","equal_earth","_this$normalize_pt3","_this$normalize_pt4","θ","asin","θ_2","θ_6","nicolosi_globular","_this$normalize_pt5","_this$normalize_pt6","λ","π_2λ","sinφ","cosφ","b","c","d","sgnλ","b2","d2","b2_d2a1","d2_b2a1","M","N","n","kavrayskiy_VII","_this$normalize_pt7","_this$normalize_pt8","_this$normalize_pt9","_this$normalize_pt10","Δλ","φ0","cosφ0","sinφ0","cosΔλ","bbox2viewBox","bbox","vF","toFixed","concat","svg_line","s","Number","isInteger","parseFloat","dx","dy","Topo2svg","mp","bCountries","other","scale","transform","tranz","translate","keyName","color_num","fColor","lns","k","stitch_arcs","l","bClosed","n_pts","d_p","p_last","ac_id","bRemoveLast","bReverse","pts","arc","pos","slice","decode_arc","arcs","reverse","splice","arc2pts","line_string2path","ls","push","fill","polygon2path","pg","lr","geometry2svg","geometries","gm","hasOwnProperty","objects","MapBorder","cx","cy","r","B","move_pt","sgn","svg_latitude","x1","x2","Graticule","y_offset","Tropics","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","lat","Symbol","iterator","done","err","return","SvgMain","viewBox","world","in","stdDeviation","result","slope","colorInterpolationFilters","filter","SQGeo_MapBorder","SQGeo_Graticule","SQGeo_Topo2svg","strokeWidth","SQGeo_Tropics","GeoAniDemo","aniFrac","easingName","easing","linear","t","quadratic","cubic","elastic","inQuad","outQuad","inOutQuad","inCubic","outCubic","inOutCubic","inExpo","outExpo","useAnimation","SQGeo_SvgMain","GeoTest","count","setCount","_useState3","_useState4","toggleCountries","_useState5","_useState6","bCull","toggleCull","bAni","toggleAni","setHeight","_useState11","_useState12","loc","setLoc","_useState13","_useState14","setTranz","normalize","util_ui_EventMove","onDoubleClick","trunc","handleDoubleClick","SQGeo_GeoAniDemo","EmbedYouTube","vID","frameBorder","allow","allowFullScreen","Layers","appId","SQGeo_GeoTest","EarthMoon3D_EarthMoon3D","lZ","toString","getFilenameFromUrl","url","replace","split","DropArea","state","setState","refDA","rFilelist","evName","document","body","countAdded","urls","RenderUrl","RenderUpdates","redundantFilename","fl","dragDropCommon","entering","classList","toggle","handleDragStart","file","dataTransfer","dropEffect","setData","JSON","stringify","handleDropFileInfo","fInfo","onDropFileInfo","onDrop","toConsumableArray","updateFilelist","size","URL","createObjectURL","RenderImg","fi","draggable","onDragStart","handleLoadedMetadata","tg","ds","parentElement","dataset","sec","hstr","h","m","sec2hms","videoWidth","videoHeight","RenderVideo","data-title","onLoadedMetadata","ext","includes","HandleFile","startsWith","onDragEnter","onDragOver","onDragLeave","dt","_loop","it","items","kind","getData","match","getAsString","parse","html","getAsFile","onDragEnd","form","multiple","accept","files","handleFiles","htmlFor","noUi","help","role","list","DropArea_ListViewFiles","filelist","ListViewFiles","setOpen","f","href","rel","sz","VE_SZ","rgb","g","VideoEditor","rCvs","refVid","cKMode","cKA","cKFrame","cKTol","fps","curImg","curApp","curTube","curVideo","rTxt","newState","hasCK","switchVideoInput","getElementById","isChromaColor","objectSpread","reducer","isRunning","paused","colorDist","cK","rm","clr","data","j","cvs","ctx","getContext","drawImage","frame","getImageData","putImageData","e","vEl","play","msg","setInterval","txt","clearInterval","Layers_Layers","backgroundImage","Layers_EmbedYouTube","DropArea_DropArea","location","hostname","CKMode","offsetLeft","offsetTop","VEControls_VEControls","len","n_lines","RGBstr","CKColor","_ref","text","subheader","backgroundColor","palette","background","paper","appBar","top","bottom","grow","flexGrow","fabButton","FabToggleVideocam","classes","setVideo","handleVideocam","onVideo","Fab","VideocamOff_default","Videocam_default","BottomAppBar","CssBaseline","AppBar","Toolbar","edge","onStart","Menu_default","BottomAppBar_FabToggleVideocam","VolumeMute_default","PlayArrow_default","Search_default","MoreVert_default","fullList","LeftDrawer","show","dlgTitle","setDlgTitle","toggleDrawer","event","handleClick","innerText","LeftDrawer_MsgDialog","SwipeableDrawer","onOpen","onKeyDown","List","index","ListItem","ListItemIcon","MoveToInbox_default","Mail_default","ListItemText","primary","Divider","MsgDialog","Dialog","aria-labelledby","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","autoFocus","root","canvas","layers","appsList","fab","extendedIcon","appSlider","paddingBottom","gridList","icon","detectedMobile","check","vendor","opera","test","substr","detectMobile","LayersHeader","Layers_default","Add_default","getElementsByClassName","AppsList","tileData","sub","GridList","cellHeight","GridListTile","cols","setAttribute","tile","GridListTileBar","subtitle","actionIcon","Info_default","App","refCam","refCvs","refLD","createRef","Grid","item","xs","Paper","clsx","App_LayersHeader","App_AppsList","border","minHeight","cam","handleVideo","click","Boolean","ReactDOM","src_App","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.3e164613.chunk.js","sourcesContent":["import React, { useRef, useEffect } from 'react';\n// https://webrtc.github.io/adapter/adapter-latest.js\nimport 'webrtc-adapter'; // include adapter for srcObject shim\nimport './App.scss';\n\nexport const Webcam = React.forwardRef((props, ref) => {\n  console.log(\"Webcam::render\");\n  const rTitle = useRef(null);\n  const constraints = {\n    audio: { echoCancellation: {exact: false} },\n    video: { width: 1280, height: 720, facingMode: 'user' } // 'user' or 'environment'\n  };\n\n  useEffect(() => {\n    if (!('mediaDevices' in navigator &&\n          'getUserMedia' in navigator.mediaDevices)) {\n      alert(\"mediaDevices not supported!\");\n    }\n    let videoStream = null;\n    (async function() {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        const videoTracks = stream.getVideoTracks();\n        rTitle.current.textContent = videoTracks[0].label;\n        console.log('Using video device: ' + videoTracks[0].label); // FaceTime HD Camera (Built-in)\n        stream.onremovetrack = function() {\n          console.log('Stream ended');\n        }\n        window.stream         = stream;\n        ref.current.srcObject = stream;\n        videoStream           = stream;\n        ref.current.pause();  // pause at the start\n      } catch (e) {\n        console.log(e.name);\n        if (typeof e !== 'undefined')\n          console.error(e);\n      }\n    })();\n\n    return () => {  // unsure this part is needed ... \n      if (videoStream) {\n        const tracks = videoStream.getTracks();\n        tracks.forEach(tr => tr.stop());\n        videoStream = null;\n      }\n    }\n  }, [ref, constraints])  // when constraints change, video should be reset\n  // <video ref={ref} autoPlay muted playsInline controls onPlay={()=>handlePlay()} className=\"vid-fw\" />\n  // <video onPlay> can be used as the trigger of the streaming: How can I pass this event to <VideoEditor>?\n  return (\n    <div className=\"vid-cont\">\n      <video ref={ref} id=\"v-cam\"\n        autoPlay muted playsInline controls\n        onPlay={props.onPlay && props.onPlay}\n        onPause={props.onPause && props.onPause}\n        />\n      <br/>\n      <label ref={rTitle}></label>\n    </div>\n  );\n});\n","import React from 'react';\n\nimport { makeStyles }  from '@material-ui/core/styles';\nimport TextField       from '@material-ui/core/TextField';\nimport IconButton      from '@material-ui/core/IconButton';\nimport CKClearIcon     from '@material-ui/icons/Delete';\nimport ZoomInIcon      from '@material-ui/icons/ZoomIn';\nimport CKPickIcon      from '@material-ui/icons/Colorize';\nimport CKDropIcon      from '@material-ui/icons/InvertColorsOff';\nimport CKShotIcon      from '@material-ui/icons/Camera';\nimport Avatar          from '@material-ui/core/Avatar';\nimport Tooltip         from '@material-ui/core/Tooltip';\nimport Switch          from '@material-ui/core/Switch';\nimport Slider          from '@material-ui/core/Slider';\nimport Snackbar        from '@material-ui/core/Snackbar';\nimport CloseIcon       from '@material-ui/icons/Close';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n  },\n  textField: {\n    //marginTop: theme.spacing(2),\n    //marginLeft : theme.spacing(1),\n    //marginRight: theme.spacing(1),\n  },\n  button: {\n    height: 40,\n    marginTop    : theme.spacing(1),\n    marginBottom : theme.spacing(1),\n    padding      : theme.spacing(1),\n  },\n  avatar: {\n    marginTop   : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n    marginRight : theme.spacing(1),\n  },\n  switch: {\n    marginTop   : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  slider: {\n    width: 200,\n    marginTop   : theme.spacing(2),\n    marginLeft  : theme.spacing(1),\n    marginBottom: theme.spacing(1),\n    zIndex      : 100000,\n  },\n  close: {\n    padding: theme.spacing(.5),\n  },\n}));\n\nconst ChromaKeyToolbox = props => {\n  console.log(\"ChromaKeyToolbox::render\");\n  const { dispatch } = props;\n  const cls = useStyles();\n  const [on,    setOn]    = React.useState(true);  // switch on\n  const [mode,  setMode]  = React.useState(1);     // 1: Pick Color 2: Snapshot\n  const [snack, setSnack] = React.useState(null);  // Snackbar message\n\n  const dispatchNewMode = newMode => {\n    dispatch({type: 'setCKMode', payload: newMode});\n  }\n  const handleSwitch   = ev => {\n    setOn(ev.target.checked);\n    dispatchNewMode(ev.target.checked ? mode : 0);\n  }\n  const handlePickMode = () => {\n    const newMode = mode === 1 ? 2 : 1;\n    if (newMode === 2) {\n      setSnack(\"Click Work Area to capture the frame\");\n    }\n    setMode(newMode);\n    dispatchNewMode(newMode);\n  }\n  const handleCKClear  = () => { setSnack(\"Chroma Keys cleared\");      dispatch({type: 'clearCK'}); }\n  const handleCKDrop   = () => { setSnack(\"Removed last Chroma Key\");  dispatch({type: 'dropCK'}); }\n  const handleCKTol    = (ev, newVal) => { dispatch({type: 'setCKTol', payload: newVal}); }\n  const handleZoomIn   = () => { setSnack(\"Under construction\"); }\n  const handleSnackbarClose = (ev, reason) => setSnack(null);\n\n  return (\n    <>\n    <Tooltip title=\"Chroma Key On/Off\">\n      <Switch\n        checked={on}\n        onChange={handleSwitch}\n        className={cls.switch}\n        value=\"switchCK\"\n        inputProps={{ 'aria-label': 'secondary checkbox' }}\n      />\n    </Tooltip>\n    <Tooltip title=\"Pick Color / Snapshot\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Toggle Pick Mode\"\n        onClick={handlePickMode}\n      >\n        {mode === 1 ?\n          <CKPickIcon /> : \n          <CKShotIcon />}\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Clear Chroma Keys\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Clear\" onClick={handleCKClear}>\n        <CKClearIcon />\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Undo Chroma Key\">\n      <IconButton\n        className={cls.button}\n        disabled={!on}\n        aria-label=\"Color Off\"\n        onClick={handleCKDrop}>\n        <CKDropIcon />\n      </IconButton>\n    </Tooltip>\n    <Tooltip title=\"Color Distance Tolerance\">\n      <Slider\n        className={cls.slider}\n        disabled={!on}\n        defaultValue={70}\n        valueLabelDisplay=\"auto\"\n        step={10}\n        marks\n        min={10}\n        max={440}\n        onChange={handleCKTol}\n      />\n    </Tooltip>\n    <Tooltip title=\"Zoom In\">\n      <IconButton\n        className={cls.button}\n        aria-label=\"ZoomIn\"\n        onClick={handleZoomIn}>\n        <ZoomInIcon />\n      </IconButton>\n    </Tooltip>\n    <Snackbar\n      className={cls.snack}\n      anchorOrigin={{vertical: 'bottom', horizontal: 'right'}}\n      open={snack !== null}\n      autoHideDuration={5000}\n      onClose={handleSnackbarClose}\n      ContentProps={{'aria-describedby': 'msg-id'}}\n      message={<span id=\"msg-id\">{snack}</span>}\n      action={[<IconButton\n        key=\"close\"\n        aria-label=\"Close\"\n        color=\"inherit\"\n        className={cls.close}\n        onClick={handleSnackbarClose}\n        >\n          <CloseIcon />\n        </IconButton>\n      ]}\n    />\n    </>\n  );\n}\n\nconst RandomAvatar = props => {\n  console.log(\"RandomAvatar::render\");\n  const cls = useStyles();\n  const [rUser, setRUser] = React.useState(null);\n  // document.getElementById(\"outlined-text-input\").value = '';  // to clear TextField\n\n  const generateRandomUser = () => \"https://randomuser.me/api/portraits/\" +\n              (Math.random() <= .5 ? 'wo' : '') + 'men/' + \n               Math.floor( Math.random() * Math.floor(99) ) + \".jpg\";\n\n  React.useEffect(() => {  // so that the random user avatar does not change for each render\n    setRUser(generateRandomUser());\n  }, []);\n\n  const handleClick = () => {\n    props.onClick && props.onClick();\n    setRUser(generateRandomUser());\n  }\n\n  return (\n    <Tooltip title=\"Webcam On\">\n      <Avatar\n        alt=\"avatar\"\n        src={rUser}\n        className={cls.avatar}\n        onClick={()=>handleClick()}\n      />\n    </Tooltip>\n  );\n}\n\nexport const VEControls = props => {\n  console.log(\"VEControls::render\");\n  const { dispatch } = props;\n  const cls = useStyles();\n\n  const handleAvatarClick = () => {\n    console.log(\"handleAvatarClick\");\n    dispatch({type: 'setCam'});\n  }\n\n  return (\n    <div className={cls.container}>\n      <RandomAvatar onClick={handleAvatarClick} />\n      <TextField\n        id=\"outlined-text-input\"\n        label=\"Type in Text\"\n        className={cls.textField}\n        margin=\"dense\"\n        variant=\"outlined\"\n        fullWidth\n        multiline\n        rowsMax=\"4\"\n        onChange={props.onChange}\n      />\n      <ChromaKeyToolbox dispatch={dispatch} />\n    </div>\n  );\n}\n","// requirement: yarn add three (^0.101.1)\n// copy resources from ../public/img/\nimport React, {useRef, useEffect, useState} from 'react';\nimport * as THREE from 'three';\n\nexport const EarthMoon3D = props => {\n  const rMount    = useRef(null);  // THREE mount <div>\n  const rControls = useRef(null);  // to save animation start/stop function\n  const rCamDir   = useRef(1);     // to save camera direction\n  const [isAnimating, setAnimating] = useState(true);\n  const img = fn => 'img/demo/em/' + fn;\n\n  const init_camera_z = 1.15;\n\n  useEffect(() => { // componentDidMount()\n    let mount  = rMount.current;\n    let width  = mount.clientWidth;\n    let height = mount.clientHeight;\n    let frameId;\n    const earthVec  = new THREE.Vector3(-.5,.2,0);\n\n    const scene     = new THREE.Scene();\n    const camera    = new THREE.PerspectiveCamera(40, width/height, .01, 1000);\n    camera.position.z = init_camera_z;\n\n    let   light     = new THREE.AmbientLight(0x888888);\n    scene.add(light);\n\n    light = new THREE.DirectionalLight(0xffffff, .4);\n    light.position.set(5,5,5);\n    scene.add(light);\n    /*\n    light.castShadow = true;\n    light.shadowCameraNear = .01;\n    light.shadowCameraFar  = 15;\n    light.shadowCameraFov  = 45;\n    light.shadowMapWidth  = 1024;\n    light.shadowMapHeight = 1024;\n*/\n    const loader    = new THREE.TextureLoader();\n    const geometry  = new THREE.SphereBufferGeometry(.5, 32, 32);\n    const material  = new THREE.MeshPhongMaterial({\n        map         : loader.load(img('earthmap1k.jpg')),\n        bumpMap     : loader.load(img('earthbump1k.jpg')),\n        bumpScale   : .05,\n        specularMap : loader.load(img('earthspec1k.jpg')),\n        specular    : new THREE.Color('grey')\n      });\n    const earthMesh = new THREE.Mesh(geometry, material);\n    earthMesh.rotation.x += .4;\n    scene.add(earthMesh);\n\n    const cloudsMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(.5 + .008, 32, 32),\n      new THREE.MeshPhongMaterial({\n        map         : loader.load(img('fair_clouds_4k.png')),\n        side        : THREE.DoubleSide,\n        opacity     : .8,\n        transparent : true,\n        depthWrite  : false\n      })\n    );\n    scene.add(cloudsMesh);\n    cloudsMesh.rotation.x += .6;\n\n    const moonMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(.08, 16, 16),\n      new THREE.MeshPhongMaterial({\n        map       : loader.load(img('moonmap1k.jpg')),\n        bumpMap   : loader.load(img('moonbump1k.jpg')),\n        bumpScale : .01\n      })\n    );\n    //moonMesh.position.set(.25, .8, 2);\n    moonMesh.position.set(0, .12, 1.1);\n    scene.add(moonMesh);\n    \n    const starsMesh = new THREE.Mesh(\n      new THREE.SphereGeometry(90, 32, 32),\n      new THREE.MeshBasicMaterial({\n        map  : loader.load(img('galaxy_starfield.png')),\n        side : THREE.BackSide\n      })\n    );\n    scene.add(starsMesh);\n\n    const renderer  = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setClearColor('#000000');\n    renderer.setSize(width, height);\n\n    const renderScene = () => {\n      renderer.render(scene, camera);\n    }\n\n    const handleResize = () => {\n      width  = mount.clientWidth;\n      height = mount.clientHeight;\n      renderer.setSize(width, height);\n      camera.aspect = width / height;\n      camera.updateProjectionMatrix();\n      renderScene();\n    }\n\n    const animate = () => {\n      const changeCamDirection = () => rCamDir.current *= -1;\n      const camDir = rCamDir.current;\n      let camPos = camera.position;\n//      earthMesh.rotation.x += .002;\n      earthMesh.rotation.y  += .002;\n      cloudsMesh.rotation.y += .0025;\n      moonMesh.rotation.y   += .001;\n      camPos.x += .0005*camDir;\n      camPos.y += .0001*camDir;\n      camPos.z += .0001*camDir;\n      if (camPos.z > 1.45 ||\n          camPos.z < init_camera_z) {\n        changeCamDirection();\n        //camera.position.set(0,0,init_camera_z);\n      }\n\n      camera.lookAt(earthVec);\n\n      renderScene();\n      frameId = window.requestAnimationFrame(animate);\n    }\n\n    const start = () => {\n      if (!frameId) {\n        frameId = requestAnimationFrame(animate);\n      }\n    }\n\n    const stop = () => {\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    mount.appendChild(renderer.domElement);\n    window.addEventListener('resize', handleResize);\n    start();\n\n    rControls.current = { start, stop };\n\n    return () => { // componetWillUnmount()\n      stop();\n      window.removeEventListener('resize', handleResize);\n      mount.removeChild(renderer.domElement);\n\n      scene.remove(earthMesh);\n      geometry.dispose();\n      material.dispose();\n    }\n  }, []);  // With the second parameter, the useEffect will run only once.\n\n  useEffect(() => {\n    if (isAnimating) { rControls.current.start(); }\n    else             { rControls.current.stop();  }\n  }, [isAnimating]);\n\n  return <div ref={rMount}\n              style={{width: props.width, height: props.height, margin: 'auto'}}\n              onClick={() => setAnimating(!isAnimating)} />\n}\n","// Math definitions: Just for readability\n// https://github.com/d3/d3-geo/blob/master/src/math.js\n\n// consider degeneracy and robustness\n\nexport const τ    = Math.PI*2;\nexport const π    = Math.PI;\nexport const π_2  = Math.PI/2;\nexport const π_4  = Math.PI/4;\nexport const ε    = 1e-6;      // a small threshold value for the floating point computation\nexport const ε2   = 1e-12;\n\nexport const degrees = 180 / π;\nexport const radians = π / 180;\nexport const π_2xdegrees = 90;  // π/2 x degrees\nexport const abs   = Math.abs;\nexport const sin   = Math.sin;\nexport const cos   = Math.cos;\nexport const tan   = Math.tan;\nexport const sign  = Math.sign;\nexport const sqrt  = Math.sqrt;\nexport const pow   = Math.pow;\nexport const log   = Math.log;\n\nexport const min   = Math.min;\nexport const max   = Math.max;\n\nexport const zero    = v => abs(v) < ε;        // is virtually zero?\nexport const epsilon = v => zero(v) ? 0 : v;   // reduce an infinitesimal number to zero\n\n// to avoid NaN for the invalid domain ranges\nexport const asin = x => x > 1 ? π/2 : x < -1  ? -π/2 : Math.asin(x);\nexport const acos = x => x > 1 ? 0   : x < -1  ? π    : Math.acos(x);\n\nexport const haversin = x => (x = sin(x/2))*x;\nexport const range = (x, r1, r2) => min(max(x, r1), r2);  // let r1 ≦ x ≦ r2\n","// util-ui.js\nimport React, { useState, useEffect, useRef } from 'react';\n\nexport const copyright = title => {\n// ASCII ART: http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20\n  console.log(\"╔═╗┌─┐┌─┐┌─┐┌─┐┌┬┐┬┌┬┐┌─┐╔═╗  \" + title + \" - contact: dev.spacetimeq@gmail.com\");\n  console.log(\"╚═╗├─┘├─┤│  ├┤  │ ││││├┤ ║═╬╗\", Date());\n  console.log(\"╚═╝┴  ┴ ┴└─┘└─┘ ┴ ┴┴ ┴└─┘╚═╝╚ (C)2019 SpacetimeQ Inc, CA 94583\");\n};\n\n// reacts only to the width change\nexport const useWindowWidth = () => {\n  const RESIZE = 'resize';\n  const [winWidth, setWinWidth] = useState(window.innerWidth);\n  const handleWindowResize = () => setWinWidth(window.innerWidth);\n\n  useEffect(() => {\n    window.addEventListener(RESIZE, handleWindowResize);\n    return () => window.removeEventListener(RESIZE, handleWindowResize);\n  }, []);\n\n  return winWidth;\n}\n\n// reacts to both width and height changes\n// aspect ration = w / h; Portrait (asp <= 1) Landscape (asp > 1)\nexport const useWindowSize = () => {\n  const RESIZE = 'resize';\n  const getWs = () => ({\n    w: window.innerWidth,\n    h: window.innerHeight\n  });\n  const [winSize, setWinSize] = useState(getWs());\n  const handleWindowResize = () => setWinSize(getWs());\n\n  useEffect(() => {\n    window.addEventListener(RESIZE, handleWindowResize);\n    return () => window.removeEventListener(RESIZE, handleWindowResize);\n    // eslint-disable-next-line\n  }, []);\n\n  return winSize;\n}\n/*\n// Usage\nfunction App() {\n  // Call our hook for each key that we'd like to monitor\n  const happyPress = useKeyPress('h');\n  const sadPress = useKeyPress('s');\n  const robotPress = useKeyPress('r');\n  const foxPress = useKeyPress('f');\n\n  return (\n    <div>\n      <div>h, s, r, f</div>\n      <div>\n        {happyPress && '😊'}\n        {sadPress && '😢'}\n        {robotPress && '🤖'}\n        {foxPress && '🦊'}\n      </div>\n    </div>\n  );\n}\n*/\n\n// Hook\n// left, up, right, down = 37, 38, 39, 40\nexport function useKeyPress(targetKey) {\n  // State for keeping track of whether key is pressed\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  // If pressed key is our target key then set to true\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  // If released key is our target key then set to false\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  // Add event listeners\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // Empty array ensures that effect is only run on mount and unmount\n\n  return keyPressed;\n}\n\n// Mouse / TrackPad Event Handlers Wrapper\n// props.render should be provided, that handles changed x, y position\nexport const EventMove = props => {\n  const { render, ...others }      = props;\n  const [mousedown,  setMouseDown] = useState(false);\n  const [mouse,      setMouse]     = useState({x: 0, y: 0});\n\n  const _moveStart = ev => {\n    const p = (ev.type === 'touchstart') ?\n      {x: ev.touches[0].pageX,\n       y: ev.touches[0].pageY} :\n      {x: ev.clientX,\n       y: ev.clientY};\n    setMouseDown(true);\n    setMouse(p);\n  }\n\n  const _move = ev => {\n    if (mousedown) {\n      const p = (ev.type === 'touchmove') ?\n        {x: ev.touches[0].pageX,\n         y: ev.touches[0].pageY} :\n        {x: ev.clientX,\n         y: ev.clientY};\n      props.render(p.x - mouse.x, p.y - mouse.y);  // Render Props\n      setMouse(p);\n    }\n  }\n\n  const _moveEnd = () => { setMouseDown(false); }\n    \n  const handleMouseDown = ev => { _moveStart(ev); }\n  const handleMouseMove = ev => { _move(ev); }\n  const handleMouseUp   = ev => { _moveEnd(); }\n\n  const handleTouchStart = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    _moveStart(ev);\n  }\n\n  const handleTouchMove = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();  // seems not working\n    ev.nativeEvent.stopImmediatePropagation();\n    _move(ev);\n  }\n  const handleTouchEnd = () => {\n    _moveEnd();\n  }\n\n  return (\n    <div\n      onMouseUp    = {handleMouseUp}\n      onMouseMove  = {handleMouseMove}\n      onMouseDown  = {handleMouseDown}\n      onTouchStart = {handleTouchStart}\n      onTouchMove  = {handleTouchMove}\n      onTouchEnd   = {handleTouchEnd}\n      {...others}\n    >\n      {props.children}\n    </div>\n  );\n}\n\n// https://overreacted.io/making-setinterval-declarative-with-react-hooks/\nexport function useInterval(callback, delay) {\n  const savedCallback = useRef();\n\n  // Remember the latest callback\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      const id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\n// 05/10/2019 by Soomin\n// Idle time CPU usage: 2% WTH?\nexport function useAnimationFrame(callback, delay) {\n  const savedCallback = useRef();\n  // const [lastTs, setLastTs] = useState(0);  // lastTs remained 0 in the tick loop even though setLastTs(ts) called.\n  const lastTs = useRef(0);  // returned object will persist for the full lifetime of the component\n\n  // Remember the latest callback\n  useEffect(() => {\n    //console.log(callback);\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval\n  useEffect(() => {\n    let frameId;\n\n    const tick = ts => {  // loop called repeatedly by rAF\n      if (ts - lastTs.current >= delay) {\n        //console.log(ts, lastTs.current, ts - lastTs.current);\n        lastTs.current = ts;\n        savedCallback.current();\n      }\n      frameId = requestAnimationFrame(tick);\n    }\n    tick(0);  // called once at the start\n    return () => cancelAnimationFrame(frameId);\n  }, [delay]);\n}\n\n// 0: Chrome, 1: Safari, 2: Firefox\nexport const detectBrowser = () => {\n  console.log(\"detectBrowser()\");\n  const ua = navigator.userAgent.toLowerCase();\n  if (ua.indexOf('safari') !== -1)\n    return (ua.indexOf('chrome') > -1) ? 0 : 1;\n  if (ua.indexOf('firefox'))\n    return 2;\n  return -1;\n}\n\nexport const detectMobile = () => {\n  // http://detectmobilebrowsers.com/\n  let check = false;\n// eslint-disable-next-line\n  (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\n  return check;\n}\n\nexport const isSafari = detectBrowser() === 1;\n","import { useState, useEffect } from 'react';\n//\n// https://usehooks.com\nexport const useAnimation = (easingName='linear', duration=500, delay=0) => {\n  // Some easing functions copied from:\n  // https://github.com/streamich/ts-easing/blob/master/src/index.ts\n  // Hardcode here or pull in a dependency\n  const easing = {\n    linear     : t => t,\n    quadratic  : t => t * (((-t + 4) * t - 6) * t + 4),\n    cubic      : t => t * ((4 * t - 9) * t + 6),\n    elastic    : t => t * ((((33 * t - 106) * t + 126) * t - 67) * t + 15),\n    inQuad     : t => t * t,\n    outQuad    : t => t * (2 - t),\n    inOutQuad  : t => t <.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n    inCubic    : t => t * t * t,\n    outCubic   : t => (--t) * t * t + 1,\n    inOutCubic : t => t <.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n    inExpo     : t => 2 ** (10*(t-1)),\n    outExpo    : t => -(2 ** (-10*t)) + 1,\n  };\n  // The useAnimationTimer hook calls useState every animation frame ...\n  // ... giving us elapased time and causing a rerender as frequently ...\n  // ... as possible for a smooth animation.\n  const elapsed = useAnimationTimer(duration, delay);\n  // Amount of specified duration elapsed on a scale from 0~1\n  const n = Math.min(1, elapsed/duration);\n  // Return altered value based on our specified easing function\n  return easing[easingName](n);  // property accessors\n}\n\nconst useAnimationTimer = (duration=1000, delay=0) => {\n  const [elapsed, setTime] = useState(0);\n\n  useEffect(() => {\n    let animationFrame, timerStop, start;\n\n    // Function to be executed on each animation frame\n    const onFrame = () => {\n      setTime(Date.now() - start);\n      loop();\n    }\n\n    // Call onFrame() on next animation frame\n    const loop = () => {\n      animationFrame = requestAnimationFrame(onFrame);\n    }\n\n    const onStart = () => {\n      // Set a timeout to stop things when duration time elapses\n      timerStop = setTimeout(() => {\n        cancelAnimationFrame(animationFrame);\n        setTime(Date.now() - start);\n      }, duration);\n\n      // Start the loop\n      start = Date.now();\n      loop();\n    }\n\n    // Start after specified delay (defaults to 0)\n    const timerDelay = setTimeout(onStart, delay);\n\n    // Clean things up\n    return () => {\n      clearTimeout(timerStop);\n      clearTimeout(timerDelay);\n      cancelAnimationFrame(animationFrame);\n    };\n  }, [duration, delay]);  // Only re-run effect if duration or delay changes\n\n  return elapsed;\n}\n","import React, { useState }   from 'react';\nimport sqMapProjections      from './sqMapProjections';\nimport { zero }              from './sqMath';\nimport { EventMove,\n         useAnimationFrame } from '../../util-ui';\nimport { useAnimation }      from './sqAnimation';\nimport world                 from './map/110mS2.json';  // 110m.json, 50m.json\n//import timez    from './map/tz.topo.json';\nimport './SQGeo.scss';\n\n//const pt2λφ = (pt) => [radians * pt[0], radians * pt[1]];\n\n/*\nconst rotate_π = (p) => {\n  let p2 = p - 160;\n  if (p2 < -180)\n    p2 += 360;\n  return p2;\n}\n*/\n\nconst pjt = new sqMapProjections();\n\nconst map_size = bbox => bbox ?\n  Math.min(bbox[2] - bbox[0],\n           bbox[3] - bbox[1]) : 360;\n//const get_bbox = bbox => bbox ? bbox : [-180, -90, 180, 90];\n\nconst bbox2viewBox = bbox => {\n  if (!bbox)\n    return '-180 -90 360 180';\n  const vF = v => v.toFixed(2);\n  return `${vF(bbox[0])} ${vF(bbox[1])} ${vF(bbox[2] - bbox[0])} ${vF(bbox[3] - bbox[1])}`;\n}\n\n// Compact svg generator that checks if horizontal or vertical lines and uses relative coordinates\n// returns '' when no change in positions\nconst svg_line = (p1, p2) => {\n  const s = v => Number.isInteger(v) ? v : Number.parseFloat(v.toFixed(3));  // short number\n  if (p1 === null)\n    return 'M' + s(p2[0]) + ',' + s(p2[1]);  // starting point\n  const dx = p2[0] - p1[0];\n  const dy = p2[1] - p1[1];\n  if (zero(dx))  return (zero(dy)) ? '' : 'v' + s(dy);\n  if (zero(dy))  return (zero(dx)) ? '' : 'h' + s(dx);\n  return 'l' + s(dx) + ',' + s(dy);  // delta encode\n}\n\nconst Topo2svg = props => {\n  const {mp, bCountries, ...other} = props;  // extract mp (map) only, and pass the other props for SVG\n\n  if (mp.type !== 'Topology') {\n    console.log('Invalid map: should be a topojson file.');\n    return null;\n  }\n  //const t0 = performance.now();\n\n  // initialize per map\n  const scale = mp.transform ? mp.transform.scale     : [1, 1];\n  const tranz = mp.transform ? mp.transform.translate : [0, 0];\n  const keyName = bCountries ? \"countries\" : \"land\";\n  let color_num = 0;\n  let fColor = ['Cornsilk', 'BlanchedAlmond', 'Bisque', 'NavajoWhite', 'Wheat', 'Burlywood', 'Tan', 'RosyBrown',\n                'SandyBrown', 'Goldenrod', 'DarkGoldenrod', 'Peru', 'Chocolate',\n                'SaddleBrown', 'Sienna', 'Brown', 'Maroon'];\n  let lns = [];\n  let k = 0;\n  //let countAll=0;  // debug\n  //let countOpt=0;\n  //let maxΔφ = 0;\n\n  // stitch multiple arcs\n  const stitch_arcs = (l, bClosed=true) => {\n    // arc to an array of points\n    const arc2pts = (ac_id, bRemoveLast=true) => {\n      // https://github.com/topojson/topojson-specification\n      const decode_arc = arc => {\n        let p = [0, 0];\n        return arc.map(pos => {\n          pos = pos.slice();\n          pos[0] = (p[0] += pos[0]) * scale[0] + tranz[0];  // rotate_π( \n          pos[1] = (p[1] += pos[1]) * scale[1] + tranz[1];\n          return pos;\n        });\n      }\n      const bReverse = (ac_id < 0);\n      const pts = decode_arc(mp.arcs[bReverse ? ~ac_id : ac_id]);\n      if (bReverse)\n        pts.reverse();\n     // countAll += pts.length;\n      if (bRemoveLast)  // remove redundancy\n        pts.splice(-1, 1);\n      return pts;\n    }\n\n    let n_pts = 0;\n    let d_p = '';\n    let p_last = null;\n    l.forEach(i =>\n      arc2pts(i).forEach(pt => {\n        const p = pjt.projection(pt);\n        if (!p[2]) {\n          d_p += svg_line(p_last, p);\n          p_last = p;\n          n_pts++;\n        }\n      })\n    );\n    if (n_pts < 2) {\n      return null;  // culled or invalid polygons\n    }\n    //countOpt += n_pts;\n    if (bClosed && (n_pts > 2)) {\n      d_p += 'Z';  // close\n    }\n    return d_p;\n  }\n\n  const line_string2path = ls => {\n    const d_p = stitch_arcs(ls, false);  // open path\n    if (d_p)\n      lns.push(<path key={k++} d={d_p} fill=\"none\" />);\n  }\n\n  // use a closed <path> instead of <polygon>\n  // inner polygons (counter-clockwise winding) follow after the first polygon\n  // Outer & Inner loop drawings: http://bl.ocks.org/mapsam/c76ed3ac3a79d9736dd7\n  // Most of data end with a single polygon.\n  const polygon2path = pg => {\n    let d_p = '';  // empty string\n    pg.forEach(lr => {    // for each LinearRing\n      const d = stitch_arcs(lr);\n      if (d)\n        d_p += d;\n    });\n    if (d_p) {  // need to set fill color only for bCountries\n      if (bCountries)\n        lns.push(<path key={k++} d={d_p} fill={fColor[color_num % fColor.length]} />);\n      else\n        lns.push(<path key={k++} d={d_p} />);  // set fill color in css\n    }\n  }\n\n  const geometry2svg = obj => {\n    if (!obj)\n      return;\n    switch (obj.type) {\n      case 'Point'             :\n      case 'MultiPoint'        :\n      case 'LineString'        : line_string2path(obj.arcs);                      break;\n      case 'MultiLineString'   : obj.arcs.forEach(ls => line_string2path(ls));    break;\n      case 'Polygon'           : polygon2path(obj.arcs);                          break;\n      case 'MultiPolygon'      : obj.arcs.forEach(pg => polygon2path(pg));        break;\n      case 'GeometryCollection': obj.geometries.forEach(gm => geometry2svg(gm));  break;\n      default:\n    }\n  /*\n    if (geom.hasOwnProperty(\"properties\") &&\n        geom.properties.hasOwnProperty(\"SOV_A3\") &&\n        geom.properties.SOV_A3 === 'JPN')\n      console.log(geom.properties);\n  */\n\n    // ISO 3166 country codes (249 countries)\n    if (obj.hasOwnProperty(\"id\")) {\n      color_num = obj.id % fColor.length;\n    }\n  }\n\n  // topo2svg\n  for (let key in mp.objects) {  // to access the unknown key\n    //if (mp.objects.hasOwnProperty(key)) {\n      //console.log(mp.objects[key]);\n      //console.log(mp.objects[key].type);\n    if (key === keyName) {  // 'countries' or 'land'\n      geometry2svg(mp.objects[key]);\n    }\n  }\n\n  //console.log(\"Total points:\", countAll, \"Optimized:\", countOpt,\n  //  \"Reduced:\", `${((countAll-countOpt)/countAll).toFixed(2)}%`);\n  // console.log(\"maxΔφ=\", maxΔφ);\n  //const t1 = performance.now();\n  //console.log('topo2svg:', (t1-t0).toFixed(2), 'ms');\n\n  return <g className={keyName} {...other}>{lns}</g>;\n}\n\nconst MapBorder = props => {\n  if (pjt.is_orthographic()) {\n    return <circle className=\"map_border\" cx={0} cy={0} r={pjt.get_orthographic_radius()} />;\n  }\n  const B = pjt.get_border();\n  let pt = [B[0], B[1]];\n  let p_last = null;\n  let d_p = '';\n\n  const move_pt = (i, sgn) => {\n    let p = pjt.projection(pt);\n    d_p += svg_line(p_last, p);\n    p_last = p;  // use .slice() to clone the array\n    pt[i] += sgn * props.step;      // should be a divisor of 90, otherwise out of range trouble can happen\n  }\n\n  while (pt[0] < B[2]) move_pt(0,  1);\n  while (pt[1] < B[3]) move_pt(1,  1);\n  while (pt[0] > B[0]) move_pt(0, -1);\n  while (pt[1] > B[1]) move_pt(1, -1);\n  d_p += 'Z';\n  //console.log(d_p.length);\n\n  return <path className=\"map_border\" d={d_p} />;\n}\n\n/*\nconst GraticuleRect = (props) => {\n  const B = props.map.bbox;  // [-180, -90, 180, 90];\n  const W = B[2] - B[0];\n  const H = B[3] - B[1];\n  let d_p = ''; //\"M-180,0h360M0,-90v180M-180,-90h360M-180,-75h360\";\n  for (let x = B[0]; x <= B[2]; x += props.step)\n    d_p += `M${x},${B[1]}v${H}`;\n  for (let y = B[1]; y <= B[3]; y += props.step)\n    d_p += `M${B[0]},${y}h${W}`;\n  return <path stroke={props.stroke} strokeWidth={props.strokeWidth} fill='none' opacity=\".5\" d={d_p} />;\n}\n*/\n\nconst svg_latitude = (y, step, x1, x2) => {\n  let p_last = null;\n  let d_p = '';\n  for (let x = x1; x <= x2; x += step) {\n    let p = pjt.projection([x, y]);\n    if (!p[2]) {\n      d_p += svg_line(p_last, p);\n      p_last = p;\n    } else {\n      p_last = null;\n    }\n  }\n  return d_p;\n}\n\nconst Graticule = props => {\n  //const t0 = performance.now();\n  const B = pjt.get_range();\n  let d_p = '';\n  // Optimization needed: Build the mesh first and then convert to the svg data\n  // Longitude\n  for (let x = B[0]; x < B[2]; x += props.step) {\n    const y_offset = (x % 45) ? 15 : 0;  // insert offset except for each 45° of the latitude\n    let p_last = null;\n    for (let y = B[1]+y_offset; y <= B[3]-y_offset; y += props.step) {\n      let p = pjt.projection([x, y]);\n      if (!p[2]) {\n        d_p += svg_line(p_last, p);\n        p_last = p;\n      } else {\n        p_last = null;\n      }\n    }\n  }\n  // Latitude\n  for (let y = B[1] + props.step; y < B[3]; y += props.step)\n    d_p += svg_latitude(y, props.step, B[0], B[2]);\n  //const t1 = performance.now();\n  //console.log('Graticule:', (t1-t0).toFixed(2), 'ms');\n\n  return <path className=\"graticule\" d={d_p} />;\n}\n\n// Tropic of Cancer, Tropic of Capricorn: ±23.4368° of the equator\nconst Tropics = props => {\n  const B = pjt.get_range();\n  let d_p = '';\n  for (let y of props.lat)\n    d_p += svg_latitude(y, props.step, B[0], B[2]);\n  return <path className={props.className} d={d_p} />;\n}\n\nconst SvgMain = props =>\n  <svg width={props.width} height={props.height} viewBox={bbox2viewBox(world.bbox)} >\n    <defs>\n      <filter id='dropshadow' height=\"130%\">\n        <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" />\n        <feOffset dx=\"1\" dy=\"1\" result=\"offsetblur\" />\n        <feComponentTransfer>\n          <feFuncA type=\"linear\" slope=\"0.5\" />\n        </feComponentTransfer>\n        <feMerge>\n          <feMergeNode />\n          <feMergeNode in=\"SourceGraphic\" />\n        </feMerge>\n      </filter>\n      <filter id=\"glow\"\n        x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\"\n        colorInterpolationFilters=\"sRGB\"\n      >\n        <feGaussianBlur result=\"coloredBlur\" stdDeviation=\"4\" />\n        <feMerge>\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"coloredBlur\" />\n          <feMergeNode in=\"SourceGraphic\" />\n        </feMerge>\n      </filter>\n    </defs>\n    <g filter=\"url(#glow)\">\n      <MapBorder step={5} />\n      <Graticule step={15} />\n      <Topo2svg mp={world} bCountries={props.bCountries}\n        strokeWidth={(map_size(world.bbox)/1000)}\n      />\n      <Tropics className=\"tropics\" lat={[-23.4368, 23.4368]} step={5} />\n      <Tropics className=\"tropic0\" lat={[0]} step={5} />\n    </g>\n  </svg>;\n\nconst GeoAniDemo = props => {\n  const aniFrac = useAnimation('inOutCubic', 5000, 0);  // easing: linear, inQuad, inCubic, elastic, inExpo, ...\n\n  pjt.set_tween();\n  //pjt.set_culling(true);\n  pjt.interpolate_frac(aniFrac);\n  if (aniFrac === 1) {\n    pjt.end_tween();\n  }\n\n  return (\n    <div>\n      <SvgMain bCountries={props.bCountries} width={props.width} height={props.height} />\n    </div>\n  );\n}\n\nexport const GeoTest = props => {\n  // Declare a new state variable, which we'll call \"count\"\n  const [count,      setCount]        = useState(1);\n  const [bCountries, toggleCountries] = useState(false);\n  const [bCull,      toggleCull]      = useState(false);  // transparent\n  const [bAni,       toggleAni]       = useState(false);\n  const [height,     setHeight]       = useState(props.height ? props.height : 480);    // height\n  //lg:139.6917+30, lt:35.6895   // Tokyo longitude, latitude of the projection center\n  //lg:-118.4912-40, lt:34.0195  // Santa Monica, CA\n  const [loc,        setLoc]          = useState({lg: 139.6917, lt: 35.6895}); \n  const [tranz,      setTranz]        = useState({dx: 0, dy: 0});\n  const width = height; //Math.trunc(height * 800/480);\n  const normalize = a => {  // let the |degree| be contained within 360°\n    const s = v => Number.isInteger(v) ? v : Number.parseFloat(v.toFixed(3));  // short number\n    const aM = 360;\n    return s( (a < -aM) ? a + aM : ( (a > aM) ? a - aM : a ) );\n  }\n\n  const move_loc = (dx, dy) => {\n    setLoc({\n      lg: normalize(loc.lg - dx*.4),\n      lt: normalize(loc.lt + dy*.4)\n    });\n  };\n\n  pjt.set_location(loc.lg, loc.lt);\n  pjt.set_projection(count);\n  //pjt.set_location(loc.lg, loc.lt);\n  pjt.set_culling(bCull);\n  //pjt.set_location(loc.lg + aniFrac*(139.6917+30), loc.lt + aniFrac*35.6895);\n/*\n  useEffect(() => {  // run after every render!\n    // Update the document title using the browser API\n    document.title = pjt.get_projection_name();\n  }, [count]);  // Only re-run the effect if count changes\n  // <p className=\"report\" >{pjt.get_projection_name()}: {loc.lg}°, {loc.lt}°</p>\n*/\n\n  const aniFrame = () => {\n    if (bAni)\n      return;\n    setLoc({\n      lg: normalize(loc.lg - 1.2),\n      lt: loc.lt\n    });\n  }\n\n  useAnimationFrame(aniFrame, 1000/8);\n\n  const handleDoubleClick = ev => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    const x = Math.trunc(width/2);\n    const y = Math.trunc(height/2);\n    setTranz({dx: ev.clientX - x, dy: ev.clientY - y});\n  }\n\n  return (\n    <EventMove\n      render={move_loc}\n      onDoubleClick={ev => handleDoubleClick(ev)}\n    >\n      <div className=\"geoTop\"\n        style={{transform: `translateX(${tranz.dx}px) translateY(${tranz.dy}px)`}}\n      >\n        {bAni ? <GeoAniDemo bCountries={bCountries} width={width} height={height} /> :\n                <SvgMain    bCountries={bCountries} width={width} height={height} />}\n      </div>\n      <div className=\"btnCont\">\n        {!bAni && <button className=\"btnDemo\" onClick={() => setCount(count + 1)}>switch projection</button>}\n        <button className=\"btnDemo\" onClick={() => toggleCountries(!bCountries)}>{bCountries ? 'Land'        : 'Countries'}</button>\n        <button className=\"btnDemo\" onClick={() => toggleCull(!bCull)}>          {bCull      ? 'Transparent' : 'Opaque'}</button>\n        <button className=\"btnDemo\" onClick={() => toggleAni(!bAni)}>            {bAni       ? 'Map'         : 'Animation'}</button>\n        <button className=\"btnDemo\" onClick={() => setHeight(height > 100 ? height-80 : height)}> {'-'}</button>\n        <button className=\"btnDemo\" onClick={() => setHeight(height+80)}>                {'+'}</button>\n      </div>\n    </EventMove>\n  );\n}\n// https://stackoverflow.com/questions/48248512/svg-transform-rotate180-does-not-work-in-safari-11\n// SVG 1.1 <svg> elements did not support transform attributes. SVG 2 supports it but Safari does not yet do so. \n/*\n  const [bAni,      toggleAni]    = useState(true);\n  const aniFrac = useAnimation('inOutCubic', 3000, 0);  // easing: linear, inQuad, inCubic, elastic, inExpo, ...\n\n  if (bAni) {\n    pjt.interpolate_frac(aniFrac);\n  } else {\n    //pjt.set_location(loc.lg + aniFrac*(139.6917+30), loc.lt + aniFrac*35.6895);\n    pjt.set_location(loc.lg + aniFrac*(360-118.4912), loc.lt + aniFrac*(34.0195-50));\n  }\n\n      <button onClick={() => toggleAni(!bAni)}>{bAni ? 'Stop Animate' : 'Animate'}</button>\n\n  const [bShowTZ,    toggleTZ]        = useState(false);\n      <button onClick={() => toggleTZ(!bShowTZ)}>          {bShowTZ    ? 'Hide Time Zone' : 'Show Time Zone'}</button>\n        {bShowTZ &&\n        <Topo2svg mp={timez}\n          strokeWidth={.3} fill=\"none\" stroke=\"green\" opacity=\".3\"\n        />}\n*/\n","// Map Projections\nimport {\n  π, π_2, τ, π_2xdegrees,\n  degrees, radians,\n  abs, sign, zero, epsilon,\n  sin, cos, tan, asin,\n  log, sqrt,\n  range\n} from './sqMath';\n// https://github.com/d3/d3-geo\n\nexport default class sqMapProjections {\n  constructor() {\n    this.frac = 0;   // fraction 0..1 to interpolate between projections\n    this.pjt_list = [\n      {name: 'Equirectangular',              fn: this.equirectangular},\n      {name: 'Orthographic',                 fn: this.orthographic},\n      {name: 'Nicolosi Globular Projection', fn: this.nicolosi_globular},\n      {name: 'Kavrayskiy VII Projection',    fn: this.kavrayskiy_VII},\n      {name: 'Mercator Projection',          fn: this.mercator},\n      {name: 'Equal Earth Projection',       fn: this.equal_earth},\n    ];\n    this.ctr  = [0, 0];\n    this.cull = true;   // backface culling on by default\n  }\n\n  projection = pt => this.equirectangular(pt);\n\n  get_culling = () => this.cull;\n  set_culling = (cull) => this.cull = cull;\n\n  get_num_projections = () => this.pjt_list.length;\n\n  normalize_pt = pt => {\n    let lg = pt[0] - this.ctr[0];\n    let lt = -pt[1];// + this.ctr[1];\n    const lgM = 180;\n    if      (lg < -lgM) lg += lgM*2;\n    else if (lg >  lgM) lg -= lgM*2;\n    /*\n    if      (lg < -lgM) lg = -lgM;\n    else if (lg >  lgM) lg =  lgM;\n    */\n    return [lg, lt];\n  }\n\n  is_orthographic = () => (this.projection === this.orthographic); \n\n  get_orthographic_radius = () => π_2xdegrees;\n\n  get_range = () => [-180, -90, 180, 90];\n\n  get_border = () => [-180+this.ctr[0], -90, 180+this.ctr[0], 90];\n\n  get_projection_object = (id=null) => {\n    let fn = (id !== null) ? this.pjt_list[id % this.pjt_list.length].fn : this.projection;\n    return this.pjt_list.find(el => el.fn === fn);\n  }\n  \n  set_tween = () => {\n    this.projection_last = this.projection;\n    const prj = (this.projection === this.orthographic) ?  this.mercator : this.projection;\n    this.projection = pt => this.tween_pjt(prj, this.orthographic)(pt);\n    /*\n    this.projection = (this.projection_last === this.orthographic) ?\n       pt => this.tween_pjt(this.orthographic, this.mercator) :\n       pt => this.tween_pjt(this.projection_last, this.orthographic);\n    */\n  }\n\n  end_tween = () => {\n    this.projection = this.projection_last;\n  }\n\n  set_projection = id => {\n    let obj = this.get_projection_object(id);\n    if (obj) {\n      this.projection = obj.fn;         // set a new projection function\n    }\n  }\n\n  get_projection_name = id => {\n    let obj = this.get_projection_object(id);\n    return obj ? obj.name : \"N/A\";\n  }\n\n  set_location = (lg, lt) => { this.ctr = [lg, lt]; }\n  \n  // interpolate between two projections\n  tween_pjt = (pjt1, pjt2) => pt => {\n    const p1 = pjt1(pt);\n    const p2 = pjt2(pt);\n    const lerp_p = i => zero(p1[i]-p2[i]) ? p1[i] : (1 - this.frac) * p1[i] + this.frac * p2[i];\n    const cull = (this.frac >= .99) ? p2[2] : null;\n    return [lerp_p(0), lerp_p(1), cull];\n  }\n\n  interpolate_frac = frac => {\n    this.frac = frac;\n  }\n\n  // ## Equirectangular projection\n  equirectangular = pt => this.normalize_pt(pt);\n\n  // map projection  https://en.wikipedia.org/wiki/List_of_map_projections\n  // ## Mercator cylindrical, conformal projection\n  // x = R(λ - λ0), y = R ln[tan(π/4 + φ/2)]\n  mercator = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const threshold = 85; // 85.051129;\n    const φ = range(lt, -threshold, threshold) * radians;\n    return [ lg, log(tan(π/4 + φ/2)) * degrees ];\n  }\n\n  // ## The Equal Earth pseudocylindrical (equal-area) map projection\n  // ## by Bojan Šavrič, Bernhard Jenny, and Tom Patterson (2018) inspired by Robinson projection.\n  // ## https://www.researchgate.net/publication/326879978_The_Equal_Earth_map_projection\n  equal_earth = pt => {  // longitude(λ), latitude\n    const [lg, lt] = this.normalize_pt(pt); // keep degree unit since the result will be converted back to degree\n    const φ   = lt * radians;\n    const A1  = 1.340264;\n    const A2  = -.081106;\n    const A3  = .000893;\n    const A4  = .003796;\n    const θ   = asin( (sqrt(3) / 2) * sin(φ) );\n    const θ_2 = θ * θ;\n    const θ_6 = θ_2 ** 3;\n\n    return [ 2 * sqrt(3)*lg*cos(θ) / (3*(A1 + 3*A2*θ_2 + θ_6*(7*A3 + 9*A4*θ_2))),\n             θ*( A1 + A2*θ_2 + θ_6*(A3 + A4*θ_2) ) * degrees];\n  }\n\n  // ## Nicolosi globular projection, polyconic\n  nicolosi_globular = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const λ = lg * radians;\n    const φ = lt * radians;\n    const π_2λ  = π/(2*λ);\n    const sinφ = sin(φ);\n    const cosφ = cos(φ);\n\n    // https://beta.observablehq.com/@toja/nicolosi-globular-projection\n    if (λ === 0 || abs(φ) === π_2) return [0, φ * degrees];\n    else if (φ === 0)              return [λ * degrees, 0];\n    else if (abs(λ) === π_2)       return [λ*cosφ * degrees, sinφ * π_2xdegrees];\n\n    const b       = π_2λ - (1/π_2λ);\n    const c       = 2*φ/π;\n    const d       = (1 - c*c) / (sinφ - c);\n    const sgnλ    = sign(λ);\n    const b2      = b*b;\n    const d2      = d*d;\n    const b2_d2   = b2/d2;\n    const d2_b2   = d2/b2;\n    const b2_d2a1 = b2_d2 + 1;\n    const d2_b2a1 = d2_b2 + 1;\n    const M = (b *sinφ/d  - b/2) / b2_d2a1;\n    const N = (d2*sinφ/b2 + d/2) / d2_b2a1;\n    const n = N*N - (d2*sinφ*sinφ/b2 + d*sinφ - 1)/d2_b2a1;\n\n    return [ (M + sqrt( M*M + cosφ*cosφ/b2_d2a1 )  * sgnλ) * π_2xdegrees,\n             (N + sqrt( n < 0 ? 0 : n ) * sign(-φ*b) * sgnλ) * π_2xdegrees ];\n  }\n\n  // Kavrayskiy VII pseudocylindrical, compromise projection\n  kavrayskiy_VII = pt => {\n    const [lg, lt] = this.normalize_pt(pt);\n    const λ = lg * radians;\n    const φ = lt * radians;\n\n    return [ 3*λ/τ * sqrt(π*π/3 - φ*φ) * degrees, lt ];\n  }\n\n  // https://en.wikipedia.org/wiki/Orthographic_projection_in_cartography\n  orthographic = pt => {\n    //const outer = (p >= -180 && p < -90) || (p > 90 && p <= 180);\n    //const outer = (p < -90) || (p > 90);\n    const [lg, lt] = this.normalize_pt(pt);\n    const Δλ = lg * radians;\n    const φ  = lt * radians;\n    const φ0 = -this.ctr[1] * radians;\n    const cosφ  = cos(φ);\n    const cosφ0 = cos(φ0);\n    const sinφ  = sin(φ);\n    const sinφ0 = sin(φ0);\n    const cosΔλ = cos(Δλ);\n    // dot product with the normal (to the screen) =\n    // (cosφ0cosλ0, cosφ0sinλ0, sinφ0)・(cosφcosλ, cosφsinλ, sinφ)\n    // sinφ0 * sinφ + cosφ0 * cosφ * cosΔλ\n    const cull = this.cull ? ( (sinφ0 * sinφ + cosφ0 * cosφ * cosΔλ < 0) ? true : null ) : null;\n    return [ epsilon(  cosφ  * sin(Δλ) * π_2xdegrees ),\n             epsilon( (cosφ0 * sinφ - sinφ0 * cosφ * cosΔλ) * π_2xdegrees ), cull];\n  }\n}  // class sqMapProjections\n\n/*\n// Stab-Werner Pseudoconical, Equal-area, Equidistant\nexport const pjt_stab-werner = (pt) => {\n  \n}\n\n// Mollweide (elliptical, Babinet, homolographic) Pseudocylindrical, Equal-area projection\nexport const pjt_Mollweide = (pt) => {\n  const λ = pt[0] * radians;\n  const φ = pt[1] * radians;\n  const sqrt2 = sqrt(2);\n  const θ = asin()\n\n  return [ (2*sqrt2/π) * λ*Math.cos(θ) * degrees,\n           (sqrt2 * Math.sin(θ)) * degrees];\n}\n*/\n","// used in './VideoEditor'\nimport React            from 'react';\nimport { EarthMoon3D }  from './demo/em/EarthMoon3D';\nimport { GeoTest }      from './demo/go/SQGeo';\nimport './App.scss';\n\nexport const EmbedYouTube = props =>\n  <iframe\n    title       = \"YouTube\"\n    width       = {props.width}\n    height      = {props.height}\n    src         = {`https://www.youtube.com/embed/${props.vID}?autoplay=1&mute=1&enablejsapi=1`}\n    frameBorder = \"0\"\n    allow       = \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n    allowFullScreen\n  />;\n\nexport const Layers = props => {\n  // La Vie en Rose: -NK9zdPj-os\n  // Cafe de Flore: w02agoYJ_H8\n  // New York Bar: lzQ3IS1Xq2s\n  // Fly Me To The Moon w0ZnimhDDhs\n  const { width, height, appId } = props;\n  console.log(\"Layers::\", appId);\n  const AppCompo = () => {\n    switch (appId) {\n      case 'app01': return <GeoTest height={Math.trunc(height * 3/4)} />;\n      case 'app02': return <EarthMoon3D width={width} height={height} />;\n      default     : return null;\n    }\n  }\n\n  return (\n    <div className=\"ve-cont\">\n      {props.children}\n      <div className=\"ve-l1\">\n        <AppCompo />\n      </div>\n    </div>\n  );\n}\n\n// <img src=\"img/missioncontrol.jpg\" alt=\"placeholder\" />\n  /*\n      <div className=\"ve-l2\">\n        <EmbedYouTube width={width} height={height} vID='w02agoYJ_H8'  />\n        <EarthMoon3D width={width} height={height} />\n      </div>\n*/\n","// https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications#Example_Using_\n// https://developers.google.com/web/updates/2012/07/Drag-and-drop-a-folder-onto-Chrome-now-available\nimport React from 'react';\nimport './DropArea.scss';\n\nconst CLASS_DROP       = \"drop-area\";\nconst CLASS_DROP_UNDER = \"drop-gallery\"\n\nconst lZ = n => (n < 10) ? '0' + n : n.toString();\nconst sec2hms = sec => {\n  if (sec < 60) {\n    return sec.toFixed(1) + 's';\n  }\n  let hstr = '';\n  let s = Math.trunc(sec);\n  const h = Math.trunc(s/3600);\n  if (h > 0) {\n    s -= h*3600;\n    hstr = h + ':';\n  }\n  const m = Math.trunc(s/60);\n  s -= m*60;\n  return hstr + lZ(m) + ':' + lZ(s);\n}\n// const callifdef = (f, arg) => if (f && typeof f === \"function\") f(arg);\n//\n// ignore unnecessary escape character: \\/\n// eslint-disable-next-line\nconst getFilenameFromUrl = url => url.replace(/^.*[\\\\\\/]/, '').split('.')[0];  // extract filename only\n\nexport const DropArea = props => {\n  console.log(\"DropArea::render\");\n  const [state, setState] = React.useState([]);  // array of DOM elements <img> or <div>\n  const refDA     = React.useRef(null); // DropArea\n  const rFilelist = React.useRef([]);\n\n  React.useEffect(() => {  // Prevent background <body> reacting to drop actions\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(\n      evName => document.body.addEventListener(evName, ev => ev.preventDefault(), false));\n  }, []);\n\n  React.useEffect(() => {\n    let countAdded = 0;\n    if (props.urls) {\n      props.urls.forEach(url => {\n        countAdded += RenderUrl(url);  // handleDropFileInfo or RenderImage or RenderVideo\n      })\n    }\n    if (countAdded > 0)\n      RenderUpdates();\n// eslint-disable-next-line\n  }, [props.urls]);  // exhaustive-deps warning\n\n  const redundantFilename = fn => {\n    const fl = rFilelist.current;\n    for (let i=0; i < fl.length; i++) {\n      if (fl[i].name === fn)\n        return true;\n    }\n    return false;\n  }\n\n  // This event happens repeatedly!\n  const dragDropCommon = (ev, entering) => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    //setState({ ...state, hilight: entering ? 'hilight' : null});\n    refDA.current.classList.toggle('hilight', entering); // or .className = entering ? 'hilight' : '';\n  }\n\n  const handleDragStart = (ev, file) => {\n    ev.dataTransfer.dropEffect = 'copy';\n    ev.dataTransfer.setData(\"text/json\", JSON.stringify(file));  // cannot pass object directly\n  }\n\n  const handleDragOver  = ev => {\n    dragDropCommon(ev, true);\n    ev.dataTransfer.dropEffect = 'copy';\n  }\n\n  const handleDragEnd   = ev => { dragDropCommon(ev, false); }\n  const handleDragEnter = ev => { dragDropCommon(ev, true); }\n  const handleDragLeave = ev => { dragDropCommon(ev, false); }\n  // https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\n  const handleDrop = ev => {\n    dragDropCommon(ev, false);\n    /*\n    const len = ev.dataTransfer.items.length;\n    for (let i=0; i < len; i++) {\n      let entry = ev.dataTransfer.items[i].webkitGetAsEntry();\n      if (entry.isFile) {\n        console.log(entry, \"file\");\n      } else if (entry.isDirectory) {\n        console.log(entry, \"directory\");\n      }\n    }\n    */\n    const dt = ev.dataTransfer;\n    let countAdded = 0;\n    for (let i=0; i < dt.items.length; i++) {\n      const it = dt.items[i];\n      if (it.kind === 'string') {\n        console.log(\"handleDrop::\", it.type, dt.getData(it.type));\n        if (it.type.match('^text/plain')) {            // it is the target node\n          it.getAsString(s => console.log(it.type, s));\n        } else if (it.type.match('^text/json')) {      // application defined user data\n          const fi = JSON.parse(dt.getData(it.type));\n          handleDropFileInfo(fi);  // get the string set by dt.setData()\n        } else if (it.type.match('^text/html')) {      // it is HTML\n          const html = dt.getData(it.type);\n          console.log(html);\n        } else if (it.type.match('^text/uri-list')) {  // it is URI\n          //it.getAsString(s => console.log(it.type, s));\n          const url = dt.getData(it.type);\n          console.log(\"handleDrop::\", it.type, url);\n          if (url.includes('app')) {\n            let id = getFilenameFromUrl(url);\n            if (id && id.match('^app')) {  // id: app01 ...\n              handleDropFileInfo({type: 'app', url, id});\n            }\n          } else if (url.includes('youtube.com')) {\n            let id = url.split('=')[1];\n            if (id && id.length === 11) {\n              handleDropFileInfo({type: 'youtube', url, id});\n            }\n          } else {\n            countAdded += RenderUrl(url);  // handleDropFileInfo or RenderVideo\n          }\n        }\n      } else if (it.kind === 'file') {\n        //console.log(it);\n        if (it.type.match('^image/')) {\n          countAdded += RenderImg(it.getAsFile());\n        } else if (it.type.match('^video/')) {\n          countAdded += RenderVideo(it.getAsFile());\n        } else if (it.kind === '') {\n        } else {\n          console.log(it.kind, \"not supported yet!\");\n        }\n      }\n    }\n    if (countAdded > 0)\n      RenderUpdates();\n  }\n\n  const handleDropFileInfo = fInfo => props.onDropFileInfo && props.onDropFileInfo(fInfo);\n\n  const RenderUpdates = () => {\n    props.onDrop && props.onDrop(rFilelist.current);\n    setState([...state]);  // state should be an array, not an object; setState(state) will not re-render\n  }\n\n  const handleFiles = files => {  // called by input change event directly\n    if (!files.length) {\n      console.log(\"No files selected!\");\n      return;\n    }\n\n    let countAdded = 0;\n    for (let i = 0; i < files.length; i++) {  // files is an object, cannot apply forEach\n      countAdded += HandleFile(files[i]);\n    }\n    if (countAdded > 0)\n      RenderUpdates();\n  }\n\n  const updateFilelist = file => {\n    if (redundantFilename(file.name)) {\n      console.log(file.name, \"already exists.\");\n      return -1;\n    }\n    const fl = rFilelist.current;\n    fl.push({\n      type : file.type,\n      name : file.name,\n      size : file.size,\n      //date : file.lastModifiedDate,\n      url  : window.URL.createObjectURL(file),  // save to release later\n      id   : file.type.slice(0,2) + fl.length,  // 'vi' or 'im' plus index (starts from 0)\n    });\n    return fl.length - 1;\n  }\n\n  const RenderImg = file => {\n    const id = updateFilelist(file);\n    if (id < 0)\n      return 0;\n    const fi = rFilelist.current[id];  // file info\n    state.push(<img key={id} id={fi.id} src={fi.url} alt={fi.name}\n                 draggable onDragStart={ev => handleDragStart(ev, fi)}/>);\n    return 1;\n  }\n\n  const handleLoadedMetadata = ev => {\n    const tg = ev.target;\n    const ds = tg.parentElement.dataset;  // parent div.dataset\n    ds.duration  = sec2hms(tg.duration);\n    ds.width     = tg.videoWidth;\n    ds.height    = tg.videoHeight;\n  }\n\n  const RenderVideo = file => {\n    const id = updateFilelist(file);\n    if (id < 0)\n      return 0;\n    const fi = rFilelist.current[id];\n    // Media Fragments URI (url + \"#t=10\") or video.currentTime = 10;\n    // example, blob:http://localhost:3000/50c82a58-b01c-4450-b161-da006d44a152#t=10\n    // Videos that are not seekable should not be set currentTime (fast-forwarded)!\n    //video.currentTime = 5;\n    //video.playbackRate = 2;  // autoPlay\n    state.push(<div key={id} data-title={fi.name}\n                    draggable onDragStart={ev => handleDragStart(ev, fi)}>\n        <video id={fi.id}\n          loop controls playsInline\n          onLoadedMetadata={handleLoadedMetadata}\n        >\n          <source src={fi.url} type={fi.type} />\n        </video>\n      </div>);\n    return 1;\n  }\n\n  const RenderUrl = url => {  // file info\n    let img = false;\n    let ext = null;\n    if      (url.includes('.jpg'))  ext = 'jpg';\n    else if (url.includes('.png'))  ext = 'png';\n    else if (url.includes('.gif'))  ext = 'gif';\n    else if (url.includes('.jpeg')) ext = 'jpeg';\n    else if (url.includes('.bmp'))  ext = 'bmp';\n    if (ext)\n      img = true;\n    else {\n      if      (url.includes('.mp4'))  ext = 'mp4';\n      else if (url.includes('.webm')) ext = 'webm';\n    }\n    if (!ext)\n      return 0;\n    const fn = getFilenameFromUrl(url);\n    if (!fn)\n      return 0;\n    const name = fn + '.' + ext;\n    if (redundantFilename(name)) {\n      console.log(name, \"already exists.\");\n      return 0;\n    }\n    const fl = rFilelist.current;\n    const id = fl.length;\n    const type = (img ? 'image' : 'video') + '/' + ext;\n    const fi = {\n      type,\n      name,\n      size: 0,  // unknown\n      url,\n      id: type.slice(0,2) + id,  // 'vi' or 'im' plus index (starts from 0)\n    };\n    if (props.onDropFileInfo)  {\n      props.onDropFileInfo(fi);\n      return 0;  // no render on the DropArea\n    }\n    fl.push(fi);\n    if (img) {\n      state.push(<img key={id} id={fi.id} src={fi.url} alt={fi.name}\n                      draggable onDragStart={ev => handleDragStart(ev, fi)}/>);\n    } else {\n      // Media Fragments URI (url + \"#t=10\") or video.currentTime = 10;\n      // example, blob:http://localhost:3000/50c82a58-b01c-4450-b161-da006d44a152#t=10\n      // Videos that are not seekable should not be set currentTime (fast-forwarded)!\n      //video.currentTime = 5;\n      //video.playbackRate = 2;  // autoPlay\n      state.push(<div key={id} data-title={fi.name}\n                  draggable onDragStart={ev => handleDragStart(ev, fi)}>\n          <video id={fi.id}\n            loop controls playsInline\n            onLoadedMetadata={handleLoadedMetadata}\n          >\n            <source src={fi.url} type={fi.type} />\n          </video>\n        </div>);\n    }\n    return 1;\n  }\n\n  const HandleFile = file => {  // FileList returned by the files property of <input> element\n    // https://cloudinary.com/documentation/upload_images#uploading_with_a_direct_call_to_the_api\n    // PW: 536Forest!@#\n    if (file.type.startsWith('image/')) {\n      return RenderImg(file);\n    } else if (file.type.startsWith('video/')) {\n      return RenderVideo(file);\n    } else {\n      console.log(file.name, file.type, \"not supported yet!\");\n      return 0;\n    }\n    /* Upload files\n    const url = 'https://api.cloudinary.com/v1_1/dicvu5udo/image/upload';\n    const formData = new FormData();\n    formData.append('upload_preset', 'hkbexlp4');\n    formData.append('file', file);\n    fetch(url, { method: 'POST', body: formData })\n      .then(() => console.log(\"Data uploaded\"))\n      .catch(() => console.log(\"Upload error!\"));\n    */\n    /*\n    const xhr = new XMLHttpRequest();\n    xhr.open('POST', url, true);\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n    xhr.addEventListener('readystatechange', function(ev) {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200)\n          updateProgress(i, 100);\n        // Error. inform the user\n      }\n    });\n    xhr.send(formData);\n    */\n  }\n\n  const handleClearClick = () => {\n    console.log(rFilelist.current.length, \"files\");\n    setState([]);\n    rFilelist.current = [];\n    /*\n    const gal = refGl.current;\n    while (gal.firstChild) {  // NEVER use gal.innerHTML = \"\"\n      const node = gal.firstChild;\n      if (node.url) {\n        console.log(\"revokeObjectURL\", node.url);\n        window.URL.revokeObjectURL(node.url);\n      }\n      gal.removeChild(node);\n    }\n    */\n  }\n\n  /* Arguments:\n   * form : <input> file form\n   * noUi : gallery\n   * list : fileslist (undefined: no list button, true: list open, false: list closed)\n  */\n  const DropForm = () =>\n    <form className=\"da-form\">\n      <input\n        id=\"df-file\"\n        type=\"file\"\n        multiple accept=\"image/*,video/*,audio/*,.pdf\"\n        onChange={ev => handleFiles(ev.target.files)}\n        className=\"vis-hid\"\n      />\n      <label className=\"df-label\" htmlFor=\"df-file\">Select or Drop Files</label>\n    </form>;\n\n  // onchange attribute of <input>\n  // ev.target:        <input ...>\n  // ev.target.value : filename\n  // ev.target.files : files\n  // Using a label element to trigger a hidden file input element\n  return (\n    <div\n      className  ={CLASS_DROP}\n      ref        ={refDA}\n      onDragEnter={handleDragEnter}\n      onDragOver ={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onDrop     ={handleDrop}\n      //onDragStart={handleDragStart}\n      onDragEnd  ={handleDragEnd}\n      style      ={props.style}\n    >\n      {props.children}\n      {props.form && <DropForm />}\n      {!props.noUi &&\n        <div className={CLASS_DROP_UNDER}>\n            {(props.help && state.length <= 6) &&\n            <p className=\"drop-help\">{props.help}</p>}\n          <button type=\"button\" className=\"btn-clear\" onClick={handleClearClick}>\n            <span role=\"img\" aria-label=\"clear\">❌</span>\n          </button>\n          {state}\n        </div>}\n      {(props.list !== undefined) && <ListViewFiles list={props.list} filelist={rFilelist.current} />}\n    </div>\n  );\n}\n\nconst ListViewFiles = props => {  // props.list is an array of file info\n  const { filelist } = props;\n  const [open, setOpen] = React.useState(props.list);  // true: fold, false: expanded\n  if (filelist.length === 0)\n    return null;\n  let i=0;\n\n  const fmtFilesize = sz => {\n    if (sz < 1024*1024) {\n      return (sz/1024).toFixed(1) + 'KB';\n    }\n    return (sz/(1024*1024)).toFixed(1) + 'MB';\n  }\n\n  return (\n    <div>\n      <button className=\"drop-list-btn\" type=\"button\"\n        onClick={()=>setOpen(!open)}\n      >Fileslist</button>\n      {open &&\n      <ul className=\"drop-list\">\n        {filelist.map(f =>\n          <li key={i++}>\n            <span>{`[${f.type}] `}</span>\n            <a href={f.url} target=\"_blank\" rel=\"noopener noreferrer\">{f.name}</a>\n            <span>{`(${fmtFilesize(f.size)})`}</span>\n          </li>\n        )}\n      </ul>}\n    </div>\n  );\n}\n/*\n    // Using FileReader -- much slower than ObjectURL\n    const previewFile = (file, i) => {\n      //console.log(file.name, `${(file.size/1024).toFixed(1)}KB`, file.type, file.lastModifiedDate);\n      if (!file.type.startsWith('image/')) {\n        alert(file.name + \" Not an image file!\");\n        return;\n      }\n      const reader = new FileReader();\n      reader.readAsDataURL(file);  // data:~/~;base64\n      //reader.readAsArrayBuffer(blob);\n      reader.onload = function() {  // or onloadend\n        //lns.push(<img key={file.name} src={reader.result} alt=\"dropped\" />);\n        //setData([...data, ...lns]);\n        const gal = refGl.current;\n        const img = document.createElement('img');  // Not allowed to load local resource\n        img.src = reader.result;\n        img.alt = \"dropped\";\n        img.draggable = \"true\";\n        gal.appendChild(img);\n      }\n    }\n    files = [...files];  // spread object elements to get an array\n    files.forEach(uploadFile);\n*/\n","import React            from 'react';\nimport { VEControls }   from './VEControls';\nimport { Layers,\n         EmbedYouTube } from './Layers';\nimport { DropArea }     from './DropArea';\nimport { useAnimationFrame }  from './util-ui';\nimport Tooltip          from '@material-ui/core/Tooltip';\n// https://webrtc.github.io/adapter/adapter-latest.js\nimport 'webrtc-adapter'; // include adapter for srcObject shim\nimport './App.scss';\n\nconst VE_SZ = {w: 800, h: 450};  // Video Editor Size\n\nconst rgb = (r, g, b) => ({r:r, g:g, b:b});\n\nexport const VideoEditor = React.forwardRef((props, rCvs) => {\n  console.log(\"VideoEditor::render\");\n  let { refVid } = props;  // ref to the video input\n  const initState = {\n    cKMode    : 1,       // Chroma Key selection mode 0: no , 1: Color Pick, 2: Back Frame\n    cKA       : [],      // Chroma key color ex, rgb(45,120,100)\n    cKFrame   : null,    // Chroma Key the whole Frame\n    cKTol     : 70*70,   // tolerance\n    fps       : 15,      // Frames Per Second\n    curImg    : null,    // current Backdrop file URL\n    curApp    : null,    // current active app id\n    curTube   : null,    // current YouTube video id\n    curVideo  : null,    // current YouTube video id\n  };\n  const [state, setState] = React.useState(initState);\n  const rTxt = React.useRef(null);  // ref to the text input element\n\n  const dispatch = action => {\n    const reducer = () => {  // return null for no state change\n      const hasCK = state.cKA.length > 0;\n      switch (action.type) {\n        case 'setCam':\n          switchVideoInput( document.getElementById('v-cam') );\n          return null;\n        case 'setCKMode':\n          //console.log('cKMode:', action.payload);\n          //return { ...state, cKMode: action.payload };\n          state.cKMode = action.payload;\n          return state;\n        case 'addCK':  // add a chroma key or a whole frame\n          if (state.cKMode === 1) {\n            if (!isChromaColor(action.payload)) {\n              state.cKA.push(action.payload);\n            }\n          } else if (state.cKMode === 2) {\n            state.cKFrame = action.payload;\n          }\n          return { ...state };\n        case 'clearCK':  // purge chroma keys\n          if (state.cKMode === 1) {\n            if (hasCK) {\n              state.cKA = [];\n              return { ...state };\n            }\n          } else if (state.cKMode === 2) {\n            if (state.cKFrame) {\n              state.cKFrame = null;\n              return { ...state };\n            }\n          }\n          return null;\n        case 'dropCK':  // remove the most recently added chroma key\n          if (hasCK) {\n            state.cKA.splice(-1,1);\n            return { ...state };\n          }\n          return null;\n        case 'setCKTol':  // set chroma key tolerance\n          //return { ...state, cKTol: action.payload**2};\n          state.cKTol = action.payload**2;\n          return null;  // no need to re-render\n        default:  // throw new Error('Unknown action type!');\n          console.error('dispatch error!');\n      }\n    }\n    const newState = reducer(action);\n    if (newState) {  // check if we have to rerender\n      setState(newState);\n    }\n  }\n\n  const isRunning = () => refVid.current &&\n                         !refVid.current.paused;\n  \n  // https://en.wikipedia.org/wiki/Color_difference\n  // Color Metric - low-cost approximation: https://www.compuphase.com/cmetric.htm\n  const isChromaColor = (c, i=0) => {  // c: rgb object\n    //const ck = {r: 60, g: 139, b: 116};\n    const colorDist = cK => {\n      const rm = (c.r + cK.r) / 3;  // red mean\n      return  (2 + rm/256)*(c.r - cK.r)**2 +\n                         4*(c.g - cK.g)**2 +\n        (2 + (255-rm)/256)*(c.b - cK.b)**2;\n    }\n    if (state.cKMode === 2 && state.cKFrame) {\n      const clr = state.cKFrame.data;\n      if (colorDist(rgb(clr[i], clr[i+1], clr[i+2])) < state.cKTol)\n        return true;\n    }\n    // Need to introduce pre-sorted and binary search for performance\n    for(let j=0; j < state.cKA.length; j++) {\n      if (colorDist(state.cKA[j]) < state.cKTol)\n        return true;\n    }\n    return false;\n    //const w  = {r: 2,  g: 4,   b: 3};  // for weighted Euclidean distance in RGB\n    //return ( w.r*(r - cK.r)**2 + w.g*(g - cK.g)**2 + w.b*(b - cK.b)**2 ) < 5000; // tolerance\n    //return (g > 90 && r < 150 && b < 180); //if (g > 120 && r > 120 && b > 120)\n  }\n    /*\n  const drawOnCanvas = ctx => {\n    ctx.beginPath();\n    ctx.strokeStyle = \"Blue\";\n    ctx.arc(80, 80, 50, 0, Math.PI * 2, true);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.strokeStyle = \"Red\";\n    ctx.rect(20, 20, 200, 100);\n    ctx.stroke();\n  }\n  */\n  /*  not working\n  useEffect(() => {\n    const asp = refVid.current.videoWidth / refVid.current.videoHight;\n    if (asp) {\n      const width = 800;\n      rCvs.current.width  = width;\n      rCvs.current.height = Math.trunc(width / asp);\n    }\n  }, [rCvs, refVid]);\n  */\n\n  useAnimationFrame(() => {\n    if (isRunning()) {  // will change; also, check if the video paused or ended\n      const cvs = rCvs.current;\n      const ctx = cvs.getContext('2d');\n      ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n      //ctx.filter = 'hue-rotate(90deg)';\n      //ctx.filter = 'contrast(2)';\n      // SecurityError: Failed to execute 'getImageData' on 'CanvasRenderingContext2D':\n      // The canvas has been tainted by cross-origin data.\n      try {\n        const frame = ctx.getImageData(0, 0, cvs.width, cvs.height);\n        const c = frame.data; // Uint8ClampedArray, color byte\n        for (let i=0; i < c.length; i+=4) {\n          if ( state.cKMode > 0 && isChromaColor(rgb(c[i],c[i+1],c[i+2]), i) )\n            c[i+3] = 0;  // transparency: opacity 0..255\n        }\n        //ctx.filter = 'drop-shadow(0 0 2px darkgray)';\n        //ctx.filter = 'blur(2px)';\n        //ctx.filter = 'brightness(1.5)';\n        ctx.putImageData(frame, 0, 0);\n      }\n      catch (e) {  // tainted\n      }\n    }\n  }, 1000/state.fps);\n\n  /*\n  React.useEffect(() => {\n    let id = null;\n    const tick = () => {\n      if (isRunning()) {  // will change; also, check if the video paused or ended\n        const cvs = rCvs.current;\n        const ctx = cvs.getContext('2d');\n        ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n        //ctx.filter = 'brightness(2)';\n        const frame = ctx.getImageData(0, 0, cvs.width, cvs.height);\n        const c = frame.data; // Uint8ClampedArray, color byte\n        for (let i=0; i < c.length; i+=4) {\n          if ( state.cKMode > 0 && isChromaColor(rgb(c[i],c[i+1],c[i+2]), i) )\n            c[i+3] = 0;  // transparency: opacity 0..255\n        }\n        ctx.putImageData(frame, 0, 0);\n        id = setTimeout(tick, 1000/state.fps);  // milliseconds/fps\n      } else {\n        //console.log(\"No video!\");\n        id = setTimeout(tick, 1000/4);  // check period\n      }\n    }\n    tick();  // actually this should be triggered by onPlay from <video>\n    if (id)\n      return () => clearTimeout(id);\n    // react-hooks/exhaustive-deps; to ignore isChromaKey, fps (updates by the timer)\n    // eslint-disable-next-line\n  }, [refVid, state]); // state should be included even though it is a global variable\n\n  */\n  // const rgb2hex = (r, g, b) => ( (r << 16) | (g << 8) | b ).toString(16);  // no range check\n\n  const handleClick = ev => {\n    //console.log(\"handleClick\", ev);\n    ev.preventDefault();\n    ev.stopPropagation();  // not to fire twice\n    //console.log(refVid, refVid.current.paused);\n    if (!isRunning() || state.CKMode === 0)\n      return;\n    try {\n      const cvs = rCvs.current;\n      const ctx = cvs.getContext('2d');\n      if (state.cKMode === 1) {  // Pick a chorma key color\n        const x = ev.pageX - cvs.offsetLeft;\n        const y = ev.pageY - cvs.offsetTop;\n        const c = ctx.getImageData(x, y, 1, 1).data;\n        console.log(x, y, c);\n        if (!c[3])  // transparent pixel (existing chroma-key)\n          return;\n        dispatch({type: 'addCK', payload: rgb(c[0],c[1],c[2])});\n        //const h = \"#\" + (\"000000\" + rgb2hex(c[0], c[1], c[2])).slice(-6);\n      } else if (state.cKMode === 2) {  // chroma key Frame\n        ctx.drawImage(refVid.current, 0, 0, cvs.width, cvs.height);  // camera source\n        console.log(\"Chroma Key Frame captured\");\n        dispatch({type: 'addCK', payload: ctx.getImageData(0, 0, cvs.width, cvs.height)});\n      }\n    }\n    catch (e) {\n    }\n  }\n\n  const handleTextInput = ev => {\n    const len = ev.target.value.length;\n    const n_lines = Math.trunc(len * 30 / 800);\n    rTxt.current.style.transform = (n_lines >= 3) ? `translateY(${-n_lines*20}px)` : \"\";\n    rTxt.current.textContent = ev.target.value;\n  }\n\n  const switchVideoInput = vEl => {  // video element\n    if (vEl) {  // pause current video (or webcam) and play new video\n      refVid.current.pause();\n      refVid.current = vEl;\n      vEl.play();\n    }\n  }\n\n  const handleDropFileInfo = fInfo => {\n    console.log(\"handleDropFileInfo::\", fInfo);\n    if (fInfo.type.match('^video/')) {\n      if (fInfo.url.match('^http') &&\n        !fInfo.url.includes(window.location.hostname)) {\n        if (state.curVideo !== fInfo.url) {\n          setState({...state, curVideo: fInfo.url});\n        }\n      } else {\n        switchVideoInput( document.getElementById(fInfo.id) );\n      }\n    } else if (fInfo.type.match('^image/')) {\n      if (state.curImg !== fInfo.url) {\n        setState({...state, curImg: fInfo.url});\n      }\n    } else if (fInfo.type.match('^app')) {\n      if (state.curApp !== fInfo.id) {\n        setState({...state, curApp: fInfo.id});\n      }\n    } else if (fInfo.type.match('^youtube')) {\n      if (state.curTube !== fInfo.id) {\n        setState({...state, curTube: fInfo.id});\n      }\n    }\n  }\n\n  const CKPalette = () => {  // Chroma-Keys Palette\n    const RGBstr = c => `rgb(${c.r},${c.g},${c.b})`;\n    const CKColor = ({color}) => <Tooltip title={color}><span style={{color: color}}>█</span></Tooltip>;\n    //console.log(state.cKA);\n    return (\n      <div className=\"ckpalette\">\n        chroma keys:&nbsp;\n        {state.cKA.map((c, i) => <CKColor key={i} color={RGBstr(c)} />)}\n      </div>\n    );\n  }\n\n  React.useEffect(() => {\n    const delay = 200;\n    const msg = \"SpacetimeQ Web Video Editor Prototype ...\";\n    let i = 0;\n    let elapsed = 0;\n\n    function tick() {\n      const txt = rTxt.current;\n      if (!txt)\n        return;\n      elapsed += delay;\n      if(i < msg.length) {\n        txt.textContent += msg[i++];\n      } else {\n        txt.style.opacity = 0;  // transition required\n      }\n      if (elapsed > 16*1000) {\n        clearInterval(id);\n        txt.textContent   = '';\n        txt.style.opacity = 1;\n      }\n    }\n    let id = setInterval(tick, delay);\n    return () => clearInterval(id);\n  }, []);\n\n  return (\n    <>\n      <Layers width={VE_SZ.w} height={VE_SZ.h} appId={state.curApp}>\n        <div className=\"ve-l0\"\n          style={state.curImg ? {backgroundImage: `url(${state.curImg})`} : null}\n        >\n          {state.curTube &&\n            <EmbedYouTube width={VE_SZ.w} height={VE_SZ.h} vID={state.curTube} />} \n          {state.curVideo &&\n            <video width={VE_SZ.w} height={VE_SZ.h}\n                   loop controls playsInline autoPlay src={state.curVideo} />}\n        </div>\n        <DropArea noUi\n          onDropFileInfo={handleDropFileInfo}\n        >\n          <canvas ref={rCvs} id=\"v-ed\"\n            width={VE_SZ.w} height={VE_SZ.h} onClick={handleClick}\n          />\n          <p ref={rTxt} className=\"text-in\"></p>\n        </DropArea>\n      </Layers>\n      <VEControls dispatch={dispatch} onChange={handleTextInput} />\n      <CKPalette />\n    </>\n  );\n});\n","import React from 'react';\nimport { makeStyles }  from '@material-ui/core/styles';\nimport AppBar          from '@material-ui/core/AppBar';\nimport CssBaseline     from '@material-ui/core/CssBaseline';\nimport Toolbar         from '@material-ui/core/Toolbar';\nimport IconButton      from '@material-ui/core/IconButton';\nimport Fab             from '@material-ui/core/Fab';  // Floating Action Buttons\nimport MenuIcon        from '@material-ui/icons/Menu';\nimport VideocamIcon    from '@material-ui/icons/Videocam';  // ./node_modules/@material-ui/icons/\nimport VideocamOffIcon from '@material-ui/icons/VideocamOff';\nimport PlayIcon        from '@material-ui/icons/PlayArrow';\nimport VolumeMuteIcon  from '@material-ui/icons/VolumeMute';\nimport SearchIcon      from '@material-ui/icons/Search';\nimport MoreIcon        from '@material-ui/icons/MoreVert';\n\nconst useStyles = makeStyles(theme => ({\n  text: {\n    padding: theme.spacing(2, 2, 0),\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper,\n  },\n  appBar: {\n    top: 'auto',\n    bottom: 0,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  fabButton: {\n    /*\n    position: 'absolute',\n    zIndex: 1,\n    top: 2,\n    left: 0,\n    right: 0,\n    margin: '0 auto',\n    */\n    margin: theme.spacing(1)\n  },\n}));\n\nconst FabToggleVideocam = props => {  // to localize (not to propagate) rendering\n  const classes = useStyles();\n  const [video, setVideo] = React.useState(false);\n  const handleVideocam = () => {\n    setVideo(!video);\n    props.onVideo(!video);\n    //console.log(\"videocam clicked\");\n  }\n\n  return (\n    <Fab size=\"small\" color={video ? \"default\" : \"secondary\"} aria-label=\"Videocam\" className={classes.fabButton}>\n      {video ?\n      <VideocamOffIcon onClick={()=>handleVideocam()} /> :\n      <VideocamIcon    onClick={()=>handleVideocam()} />}\n    </Fab>\n  );\n}\n\nexport default function BottomAppBar(props) {\n  console.log(\"BottomAppBar::render\");\n  const classes = useStyles();\n\n  return (\n    <>\n      <CssBaseline />\n      <AppBar position=\"fixed\" color=\"primary\" className={classes.appBar}>\n        <Toolbar>\n          <IconButton edge=\"start\" color=\"inherit\" aria-label=\"Open drawer\" onClick={props.onStart}>\n            <MenuIcon />\n          </IconButton>\n          <FabToggleVideocam onVideo={props.onVideo} />\n          <Fab size=\"small\" color=\"default\" aria-label=\"VolumeMute\" className={classes.fabButton}>\n            <VolumeMuteIcon onClick={()=>console.log(\"VolumeMute\")} />\n          </Fab>\n          <Fab size=\"small\" color=\"default\" aria-label=\"Play\" className={classes.fabButton}>\n            <PlayIcon onClick={()=>console.log(\"Play\")} />\n          </Fab>\n          <div className={classes.grow} />\n          <IconButton color=\"inherit\">\n            <SearchIcon />\n          </IconButton>\n          <IconButton edge=\"end\" color=\"inherit\">\n            <MoreIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n    </>\n  );\n}\n","import React from 'react';\nimport { makeStyles }    from '@material-ui/core/styles';\nimport SwipeableDrawer   from '@material-ui/core/SwipeableDrawer';\nimport List              from '@material-ui/core/List';\nimport Divider           from '@material-ui/core/Divider';\nimport ListItem          from '@material-ui/core/ListItem';\nimport ListItemIcon      from '@material-ui/core/ListItemIcon';\nimport ListItemText      from '@material-ui/core/ListItemText';\nimport InboxIcon         from '@material-ui/icons/MoveToInbox';\nimport MailIcon          from '@material-ui/icons/Mail';\n                         \nimport Dialog            from '@material-ui/core/Dialog';\nimport DialogActions     from '@material-ui/core/DialogActions';\nimport DialogContent     from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle       from '@material-ui/core/DialogTitle';\nimport Button            from '@material-ui/core/Button';\n\nconst useStyles = makeStyles({\n  list: {\n    width: 200,\n  },\n  fullList: {\n    width: 'auto',\n  },\n});\n\nexport const LeftDrawer = React.forwardRef((props, ref) => {\n  console.log(\"LeftDrawer::render\");\n  const classes = useStyles();\n  const [state,    setState]    = React.useState(props.show);  // open\n  const [dlgTitle, setDlgTitle] = React.useState(null);\n\n  const toggleDrawer = open => event => {\n    if (event &&\n        event.type === 'keydown' &&\n        (event.key === 'Tab' ||\n         event.key === 'Shift'))\n    {\n      return;\n    }\n    setState(open);\n  };\n\n  const handleClick = ev => { setDlgTitle(ev.target.innerText); }\n\n  return (\n    <div>\n      {dlgTitle && <MsgDialog open={true} onClose={()=>setDlgTitle(null)} title={dlgTitle}>\n        SpacetimeQ Prototype\n      </MsgDialog>}\n      <button ref={ref} onClick={toggleDrawer(true)} style={{display: 'none'}}></button>\n      <SwipeableDrawer\n        open={state}\n        // anchor=\"right\", \"top\", \"bottom\"\n        onClose={toggleDrawer(false)}\n        onOpen={toggleDrawer(true)}\n      >\n        <div\n          className={classes.list}\n          role=\"presentation\"\n          onClick={toggleDrawer(false)}\n          onKeyDown={toggleDrawer(false)}\n        >\n          <List>\n            {['About', 'Recent', 'Movies', 'Images'].map((text, index) => (\n              <ListItem button key={text} onClick={handleClick} disabled={index > 0}>\n                <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n                <ListItemText primary={text} />\n              </ListItem>\n            ))}\n          </List>\n          <Divider />\n          <List>\n            {['demo1', 'demo2', 'demo3'].map((text, index) => (\n              <ListItem button key={text} disabled >\n                <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n                <ListItemText primary={text} />\n              </ListItem>\n            ))}\n          </List>\n        </div>\n      </SwipeableDrawer>\n    </div>\n  );\n});\n\nconst MsgDialog = props => {\n  console.log(\"MsgDialog::\", props.title);\n  return (\n    <Dialog\n      open={props.open}\n      onClose={props.onClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{props.title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          {props.children}\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={props.onClose} color=\"primary\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React from 'react';\nimport './App.scss';\nimport { Webcam }       from './webcam';\nimport { VideoEditor }  from './VideoEditor';\nimport { DropArea }     from './DropArea';\nimport { detectMobile } from './util-ui';\n\n// Material-UI\nimport clsx             from 'clsx';\nimport { makeStyles }   from '@material-ui/core/styles';\nimport BottomAppBar     from './BottomAppBar';\nimport { LeftDrawer }   from './LeftDrawer';\n//import TrailerCard from './CICard';\n\nimport Grid             from '@material-ui/core/Grid';\nimport Paper            from '@material-ui/core/Paper';\nimport Fab              from '@material-ui/core/Fab';\nimport AddIcon          from '@material-ui/icons/Add';\nimport DeleteIcon       from '@material-ui/icons/Delete';\nimport LayersIcon       from '@material-ui/icons/Layers';\nimport GridList         from '@material-ui/core/GridList';\nimport GridListTile     from '@material-ui/core/GridListTile';\nimport GridListTileBar  from '@material-ui/core/GridListTileBar';\n//import ListSubheader    from '@material-ui/core/ListSubheader';\nimport IconButton       from '@material-ui/core/IconButton';\nimport InfoIcon         from '@material-ui/icons/Info';\n//import tileData         from './tileData';\nimport Tooltip          from '@material-ui/core/Tooltip';\nimport Slider           from '@material-ui/core/Slider';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n  },\n  canvas: {\n    width: 840,\n  },\n  layers: {\n    width: 250,\n  },\n  appsList: {\n    width: 250,\n    height: 340,\n  },\n  paper: {\n    padding: theme.spacing(2),\n    color: theme.palette.text.primary,\n    margin: 6,  // marginLeft\n  },\n  fab: {  // floating action button\n    margin: theme.spacing(1),\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(1),\n  },\n  appSlider: {\n    width       : '80%',\n    marginTop   : theme.spacing(5),\n    marginLeft  : theme.spacing(3),\n    paddingBottom: theme.spacing(1),\n    zIndex      : 1000,\n  },\n  /*\n  appTitle: {\n    height: 16,\n    lineHeight: 16,\n    fontSize: 'small',\n    color: 'white',\n    background: 'black',\n    borderRadius: '5px 5px 0 0',\n  },\n  */\n  gridList: {\n    height: 300,\n  },\n  icon: {\n    color: 'rgba(255,255,255,.54)',\n  }\n}));\n\nconst detectedMobile = detectMobile();\n\nfunction App() {\n  console.log(\"App::render\");\n  const cls = useStyles();\n  const refCam = React.useRef(null); // <video> camera\n  const refCvs = React.useRef(null); // <canvas> for video editing\n  const refLD  = React.createRef();  // <LeftDrawer> to wire with <BottomAppBar> start button\n\n  const handleVideo = on => {\n    const cam = refCam.current;\n    if (on) { cam.play(); }\n    else    { cam.pause(); }\n  }\n\n  if (detectedMobile) {\n    return <div className=\"App\">\n        <img src=\"./img/notice-mobile.jpg\" alt=\"Desktop-Only\" />\n        <p className=\"notice-mobile\">SpacetimeQ Web Video Editor is currently for Desktop-Only. Mobile version and related products are under development.</p>\n      </div>;\n  }\n\n  return (  // autoPlay\n    <div className=\"App\">\n      <div className={cls.root}>\n        <Grid container spacing={2}>\n          <Grid item xs={9}>\n            <Paper className={clsx(cls.canvas, cls.paper)}>\n              <VideoEditor ref={refCvs} refVid={refCam} />\n            </Paper>\n          </Grid>\n          <Grid item xs={3}>\n            <LayersHeader>Layers</LayersHeader>\n            <Paper className={clsx(cls.layers, cls.paper)}>\n              <Webcam ref={refCam}\n                onPlay ={()=>{console.log(\"Webcam::onPlay\");}}\n                onPause={()=>{console.log(\"Webcam::onPause\");}}\n              />\n            </Paper>\n            <Paper className={clsx(cls.appsList, cls.paper)}>\n              <AppsList />\n            </Paper>\n          </Grid>\n          <Grid item xs={12}>\n            <DropArea\n              list={false}\n              help=\"~ Drag & drop backdrop image files or source video files here ~\"\n              urls={[\n                \"./img/chroma01.mp4\",\n                \"./img/chroma02.mp4\",\n                \"./img/back01.jpg\",\n                \"./img/ironman.gif\",\n              ]}\n              style={{\n                border: '1px dashed #ccc',\n                minHeight: '200px',\n                margin: '10px'\n              }}\n            />\n          </Grid>\n          <Grid item xs={12}>\n            <p className=\"footer\">Video Editor Prototype (C) SpacetimeQ Inc, 2019</p>\n          </Grid>\n        </Grid>\n      </div>\n      <LeftDrawer ref={refLD} show={false} />\n      <BottomAppBar\n        onVideo={on=>handleVideo(on)}\n        onStart={()=>refLD.current.click()}\n      />\n    </div>\n  );\n}\n\nconst LayersHeader = props => {\n  const cls = useStyles();\n\n  const handleLayersClick = () => { console.log(\"Layers Clicked\"); }\n  const handleAddClick    = () => { console.log(\"Add Clicked\"); }\n  const handleDeleteClick = () => {\n    const el = document.getElementsByClassName('ve-l0')[0];\n    if (el) {\n      el.style.backgroundImage = '';\n      /* React element\n      let child = el.lastElementChild;\n      while (child) {\n        el.removeChild(child);\n        child = el.lastElementChild;\n      }\n      */\n    }\n  }\n\n  return (\n    <div>\n      <Fab variant=\"extended\" size=\"medium\" aria-label=\"Title\" className={cls.fab}\n        onClick={handleLayersClick}>\n        <LayersIcon className={cls.extendedIcon} />\n        {props.children}\n      </Fab>\n      <Fab color=\"primary\" size=\"small\" aria-label=\"Add\" className={cls.fab}\n        disabled\n        onClick={handleAddClick}>\n        <AddIcon />\n      </Fab>\n      <Fab size=\"small\" aria-label=\"Delete\" className={cls.fab}\n        onClick={handleDeleteClick}>\n        <DeleteIcon />\n      </Fab>\n    </div>\n  );\n}\n\nconst AppsList = props => {\n  const cls = useStyles();\n  const TBD = 'TBD';\n  const tileData = [\n    {\n      img   : 'img/app01.jpg',  // filename.ext -> filename will be used as the app id\n      title : 'Earth Globe',\n      sub   : 'Geospatial',\n    },\n    {\n      img   : './img/app02.jpg',\n      title : 'Planet Earth',\n      sub   : 'Realistic 3D',\n    },\n    {\n      img   : './img/app03.jpg',\n      title : 'ArtMoon',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app04.jpg',\n      title : 'Solar System',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app05.jpg',\n      title : '3D Demo',\n      sub   : TBD,\n    },\n    {\n      img   : './img/app06.jpg',\n      title : 'SpacetimeQ',\n      sub   : TBD,\n    },\n  ];\n\n  const handleAppVis = (ev, newVal) => {\n    const el = document.getElementsByClassName('ve-l1')[0];\n    if (el) {\n      el.setAttribute(\"style\", 'z-index: ' + newVal);\n    }\n  }\n  // <ListSubheader component=\"div\" className={cls.appTitle}>Apps for Demo</ListSubheader>\n  \n  return (\n    <GridList cellHeight={140} className={cls.gridList}>\n      <GridListTile key=\"Subheader\" cols={2} style={{ height: '70px' }}>\n        <Tooltip title=\"Apps Visibility\">\n          <Slider\n            className={cls.appSlider}\n            defaultValue={40}\n            valueLabelDisplay=\"auto\"\n            step={10}\n            marks\n            min={0}\n            max={100}\n            onChange={handleAppVis}\n          />\n        </Tooltip>\n      </GridListTile>\n      {tileData.map(tile => (\n        <GridListTile key={tile.img}>\n          <img className=\"al-icon\" src={tile.img} alt={tile.title} />\n          <GridListTileBar\n            title={tile.title}\n            subtitle={<span>{tile.sub}</span>}\n            actionIcon={\n              <IconButton aria-label={`info ${tile.title}`} className={cls.icon}>\n                <InfoIcon />\n              </IconButton>\n            }\n          />\n        </GridListTile>\n      ))}\n    </GridList>\n  );\n};\n\nexport default App;\n\n/*\n\nconst flixURL = i => {\n  const prefix = \"https://www.totaleclips.com/Player/Bounce.aspx?eclipid=\";\n  const suffix = \"&type=.mp4\";\n  const aFlix = [\n    \"e44573&bitrateid=471&vendorid=102\",\n    \"e18472&bitrateid=472&vendorid=102\",\n    \"e19268&bitrateid=472&vendorid=102\",\n    \"e21095&bitrateid=461&vendorid=102\",\n    \"e26097&bitrateid=472&vendorid=102\",\n    \"e19578&bitrateid=455&vendorid=102\",\n    \"e98124&bitrateid=472&vendorid=102\",\n  ];\n  return prefix + aFlix[i % aFlix.length] + suffix;\n}\n              <video ref={refVid} id=\"vid1\" muted loop playsInline controls >\n                <source src={flixURL(5)} type='video/mp4' />\n              </video>\n          <Grid item xs={6}>\n            <TrailerCard src={flixURL(0)} />\n          </Grid>\n          <Grid item xs={6}>\n            <TrailerCard src={flixURL(4)} />\n          </Grid>\n*/\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}